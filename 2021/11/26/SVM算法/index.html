<!--
	作者：Sariay
	时间：2018-08-26
	描述：There may be a bug, but don't worry, Qiling(器灵) says that it can work normally! aha!
-->
<!DOCTYPE html>
<html class="html-loading">
		

<head>
	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <title>
    
      SVM算法 | 独自赏晴雨
    
  </title>
  <meta name="author" content="HFC">
  <meta name="keywords" content="" />
  <meta name="description" content="" />
	<!-- favicon -->
  <link rel="shortcut icon" href="/img/favicon.png">

  <!-- css -->
  
<link rel="stylesheet" href="/css/Annie.css">

  
  <!-- jquery -->
	
<script src="/plugin/jquery/jquery.min.js"></script>


<script>
    const CONFIG_BGIMAGE = {
      mode: 'normal',
      normalSrc: '/img/bg.png',
      randomYouMax: 110,
      randomYouSrc: 'http://hfcouc.work/Random-img/',
	  randomOtherSrc: 'https://api.berryapi.net/?service=App.Bing.Images&day=-0',
	  preloaderEnable: true
    }
	
    const CONFIG_LEACLOUD_COUNT = {
      enable: false,
	  appId: 'AU8...',
	  appKey: '4cU...',
	  serverURLs: 'http' || ' '
    }
  </script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="独自赏晴雨" type="application/atom+xml">
</head>
	<body>
		<!-- Preloader -->

	<div id="preloader">
		<div class="pre-container">
			
				<div class="spinner">
					<div class="double-bounce1"></div>
					<div class="double-bounce2"></div>
				</div>
						
		</div>
	</div>


<!-- header -->
<header class="fixbackground bg-pan-br">
	<div class="mask">
		<!-- motto -->
		<div class="h-body">	
			
				<div class="motto text-shadow-pop-left">
					<p class="content" id="motto-content">获取中...</p>
					<p>-<p>
					<p class="author" id="motto-author">Just a minute...</p>
				</div>
			
		</div>
		
		<!-- others: such as time... -->			
		<div class="h-footer">
			<a href="javascript:;" id="read-more" class="scroll-down">
				<span class="icon-anchor1 animation-scroll-down"></span>
			</a>
		</div>
	</div>
</header>

<div id="navigation-hide">
	<!-- Progress bar -->
	<div id="progress-bar"></div>

	<!-- Progress percent -->
	<div id="progress-percentage"><span>0.0%</span></div>

	<div class="toc-switch"><span class="switch-button">目录</span></div>

	<!-- Page title -->
	<p>
		
			「SVM算法」
		
	</p>

	
	

	<!-- Nav trigger for navigation-H-->
	<a class="nav-trigger"><span></span></a>
</div>

<!-- Navigation in div(id="navigation-H") -->
<nav class="nav-container" id="cd-nav">
	<div class="nav-header">
		<span class="logo"> 
			<img src="/img/HFC.png">
		</span>
		<a href="javascript:;" class="nav-close"></a>
	</div>
	
	<div class="nav-body">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories" target="_blank">分类</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	
		<li class="menu-note">
			<a href="/note" class="menu-item-note" target="_blank">笔记</a>
		</li>
		
	
		<li class="menu-shuoshuo">
			<a href="/ss" class="menu-item-shuoshuo" target="_blank">说说</a>
		</li>
		
	
		<li class="menu-bangumis">
			<a href="/bangumis" class="menu-item-bangumis" target="_blank">追番</a>
		</li>
		
	
		<li class="menu-cinemas">
			<a href="/cinemas" class="menu-item-cinemas" target="_blank">追剧</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
	</div>
	
	<div class="nav-footer">
		<ul id="global-social">
	
		<li>
			<a href="https://www.zhihu.com/people/bu-yu-que-zhi-xin-43-35" target="_blank">
				<span class="icon-zhihu"></span>
			</a>
		</li>
	
		<li>
			<a href="https://github.com/HFC666" target="_blank">
				<span class="icon-github"></span>
			</a>
		</li>
	
		<li>
			<a href="/atom.xml" target="_blank">
				<span class="icon-rss"></span>
			</a>
		</li>
			
</ul>

	</div>
</nav>
			
		<!--main-->
		<main>
			<!--
	时间：2018-11-17
	描述：
		插件名称：katelog.min.js
		插件作者：KELEN
		插件来源: https://github.com/KELEN/katelog
-->

	
		<div class="layout-toc">
			<div id="layout-toc">
				<div class="k-catelog-list" id="catelog-list" data-title="文章目录"></div>
			</div>
		</div>

		
<script src="/plugin/toc/katelog.min.js"></script>


		
	 

<div class="layout-post">
	<div id="layout-post">
		<div class="article-title">
			
	<a href="/2021/11/26/SVM%E7%AE%97%E6%B3%95/" itemprop="url">
		SVM算法
	</a>

		</div>

		<div class="article-meta">
			<span>
				<i class="icon-calendar1"></i>
				
				




	更新于

	<a href="/2021/11/26/SVM%E7%AE%97%E6%B3%95/" itemprop="url">
		<time datetime="2021-11-26T12:48:20.000Z" itemprop="dateUpdated">
	  		2021-11-27
	  </time>
	</a> 



			</span>
			<span>
				
	<i class="icon-price-tags"></i>
	
		<a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" class=" ">
			机器学习
		</a>
	
		
			</span>
			
			



		</div>

		<div class="article-content" id="article-content">
			<h2 id="支持向量机-SVM"><a href="#支持向量机-SVM" class="headerlink" title="支持向量机(SVM)"></a>支持向量机(SVM)</h2><h3 id="线性模型"><a href="#线性模型" class="headerlink" title="线性模型"></a>线性模型</h3><h4 id="线性可分训练集"><a href="#线性可分训练集" class="headerlink" title="线性可分训练集"></a>线性可分训练集</h4><p>一个训练数据集线性可分是指：$\{(x_i,y_i)\}_{i=1\sim N},\exists(w,b)$，使对$\forall i=1\sim N$，有</p>
<ul>
<li>若$y_i=+1$，则$w^Tx_i+b\ge0$</li>
<li>若$y_i=-1$，则$w^Tx_i+b&lt;0$</li>
</ul>
<p>即$y_i[w^Tx_i+b]\ge0$(公式1)</p>
<p>对于线性可分的数据集，我们需要划一条线来分割两类不同的样本。但是分割的线有无数条，我们怎么判断哪一条线更好呢？<br><img src="https://static01.imgkr.com/temp/bf661c3ba75549abacf5b4e9dde0e254.png" alt=""><br>很多人认为第二条线是最好的。但是因为根据免费午餐定理，这三条曲线是一样好的。那么我们为什么会认为第二条曲线是最好的呢？这是因为我们在研究问题之前，对此问题存在先验假设。有很多先验假设认为第二条直线比其余两条要好。我们只考虑其中一种假设，即假设<em>训练样本的位置在特征空间有测量误差</em>。如下图所示：<br><img src="https://static01.imgkr.com/temp/51e3dc9f3d9847298c80f36fc1d22328.png" alt=""><br>假设红色的叉和圆圈的真实位置为红色虚线圆圈，则线3和1都会分类错误，而2不会，这说明2号线更能抵御训练样本位置的误差。</p>
<p>那么2号线是怎么画出来的呢？<br>支持向量机的创造者Vapnik是这样回答的，它首先将直线向一侧平行移动，直到它叉到一个或几个样本为止；之后再向另一侧移动，直到叉到一个或多个样本未知。<br><img src="https://static01.imgkr.com/temp/a184f5d78b3b4cd78df273fbd4f0adfd.png" alt=""><br>我们要找的2号线找的是使得间隔最大的且位于间隔中间的线。<br><strong>在多维的情况下，直线变为超平面</strong>。</p>
<p>之后我们将支持向量机转化为一个优化问题，优化问题为：</p>
<script type="math/tex; mode=display">
\begin{aligned}
    &\min \frac{1}{2}||w||^2\\
    &\operatorname{s.t.} \quad y_i[w^T_i+b]\ge1
\end{aligned}</script><p>那么这是怎么得到的呢？那面我们详细讨论一下：</p>
<p>事实一：$w^Tb+b=0$与$aw^Tx+ab=0$是同一个平面，$a\in R^+$。即若$(w,b)$满足公式1，则$(aw,ab)$也满足公式一。</p>
<blockquote>
<p>公式1：$y_i[w^Tx_i+b]\ge0$</p>
</blockquote>
<p>事实二：点到平面的距离公式。<br>向量$x_0$到超平面$w^Tx+b=0$的距离：</p>
<script type="math/tex; mode=display">
d = \frac{|w^Tx_0+b|}{||w||}</script><p>当$x_0$为支持向量时，我们要做的就是最大化$d$。<br>根据事实1，我们可以用$a$去缩放：</p>
<script type="math/tex; mode=display">
(w,b)\rightarrow (aw,ab)</script><p>最终使在支持向量上$x_0$上，有：</p>
<script type="math/tex; mode=display">
    |w^Tx_0+b|=1</script><p>此时支持向量与平面距离：</p>
<script type="math/tex; mode=display">
 d = \frac{1}{||w||}</script><p>因为最大化$\frac{1}{||w||}$相当于最小化$||w||^2$，所以得到上述的目标函数。</p>
<p>下面看约束条件是如何得到的。<br>因为在上面的描述中我们有，对于所有的支持向量，我们有</p>
<script type="math/tex; mode=display">
|w^Tx_0+b|=1</script><p>所以对于非支持向量，我们有：</p>
<script type="math/tex; mode=display">
|w^Tx_0+b|>1</script><p>又因为：$y_i[w^Tx_i+b]\ge0$，所以综上我们有</p>
<script type="math/tex; mode=display">
y_i[w^Tx_i+b] = |w^Tx_0+b|\ge 1</script><p>这样我们就得到了上面提到的优化问题。</p>
<p>这个优化问题为凸优化问题中的<em>二次优化问题</em>。<br>二次规划问题：</p>
<ol>
<li>目标函数是二次项</li>
<li>限制条件是一次项</li>
</ol>
<p>这样就会导致要么无解，要么只有一个极值。</p>
<h3 id="非线性可分"><a href="#非线性可分" class="headerlink" title="非线性可分"></a>非线性可分</h3><p>我们改写目标函数和约束条件，使其变为：</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\min&\quad\frac{1}{2}||w||^2+C\sum_{i=1}^N\xi_i\\
&\operatorname{s.t.}\quad &y_i[w^Tx_i+b]\ge 1-\xi_i\\
&\quad &\xi_i\ge0
\end{aligned}</script><p>其中$\xi_i$称为松弛变量，$C\sum_{i=1}^N\xi_i$称为正则项。</p>
<h3 id="非线性问题"><a href="#非线性问题" class="headerlink" title="非线性问题"></a>非线性问题</h3><p>对于下图所示的问题，我们不能找到一个很好的直线将两类分开：<br><img src="https://static01.imgkr.com/temp/491f1d06bdce47cf8cff0ed74a575eb3.png" alt=""><br>但是我们可以将其映射到高维空间中的点，然后在高维空间中寻找直线。<br>我们定义一个从低维到高维的映射$\phi(x)$：</p>
<script type="math/tex; mode=display">
x\xrightarrow{\phi}\phi(x)</script><p>其中$x$为低维向量，而$\phi(x)$为一个高维映射。</p>
<p>下面我们举一个例子：如下图所示的异或问题<br><img src="https://static01.imgkr.com/temp/c0bcf66b2ef143ae9b7e93f699654ddb.png" alt=""><br>这个问题我们在二维空间里无法找到一条直线将其分开。<br>在上图中我们令四个点分别为：</p>
<script type="math/tex; mode=display">
x_1 = \begin{bmatrix}0\\0\end{bmatrix},x_2 = \begin{bmatrix}1\\1\end{bmatrix}\in C_1</script><script type="math/tex; mode=display">
x_3 = \begin{bmatrix}1\\0\end{bmatrix},x_4 = \begin{bmatrix}0\\1\end{bmatrix}\in C_2</script><p>我们令</p>
<script type="math/tex; mode=display">
\phi(x): x = \begin{bmatrix}a\\b\end{bmatrix}\xrightarrow{\phi}\phi(x) = \begin{bmatrix}a^2\\b^2\\a\\b\\ab\end{bmatrix}</script><p>则经过映射得到：</p>
<script type="math/tex; mode=display">
\phi(x_1)= \begin{bmatrix}0\\0\\0\\0\\0\end{bmatrix},\phi(x_2)= \begin{bmatrix}1\\1\\1\\1\\1\end{bmatrix}</script><script type="math/tex; mode=display">
\phi(x_3)= \begin{bmatrix}1\\0\\1\\0\\0\end{bmatrix},\phi(x_4)= \begin{bmatrix}0\\1\\0\\1\\0\end{bmatrix}</script><p>我们可以令</p>
<script type="math/tex; mode=display">
w= \begin{bmatrix}-1\\-1\\-1\\-1\\6\end{bmatrix},b=1</script><p>来达到区分的目的。</p>
<p>有证明显示：在越高维度情况下，找打一个线性超平面来将样本分开的概率越大。我们如何选取$\phi$，我们将$\phi(x)$选择为无限维。但是$\phi(x)$为无限维，$w$将为无限维，优化问题将不可做。</p>
<p>我们可以不知道无限维映射$\phi(x)$的显式表达，我们只要知道一个核函数：</p>
<script type="math/tex; mode=display">
K(x_1,x_2) = \phi(x_1)^T\phi(x_2)</script><p>下面的优化问题：</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\min&\quad\frac{1}{2}||w||^2+C\sum_{i=1}^N\xi_i\\
&\operatorname{s.t.}\quad &y_i[w^T\phi(x_i)+b]\ge 1-\xi_i\\
&\quad &\xi_i\ge0
\end{aligned}</script><p>仍然可解。</p>
<p>在SVM中常用的核函数：</p>
<script type="math/tex; mode=display">
K(x_1,x_2) = e^{-\frac{||x_1-x_2||^2}{2\sigma^2}} = \phi(x_1)^T\phi(x_2)</script><p>为高斯核函数</p>
<script type="math/tex; mode=display">
K(x_1,x_2) = (x_1^Tx_2+1)^d = \phi(x_1)^T\phi(x_2)</script><p>为多项式核函数，$d$为阶数。</p>
<p>核函数$K$必须满足某些条件才能被拆成内积的形式：<br>$K(x_1,x_2)$能被写成$\phi(x_1)^T\phi(x_2)$的充要条件为：</p>
<ol>
<li>$K(x_1,x_2)=K(x_2,x_1)$</li>
<li>$\forall c_i\in R,x_i(i=1\sim N)$，有<script type="math/tex">\sum_{i=1}^N\sum_{i=1}^Nc_ic_jK(x_i,x_j)\ge 0</script></li>
</ol>
<h3 id="原问题和对偶问题"><a href="#原问题和对偶问题" class="headerlink" title="原问题和对偶问题"></a>原问题和对偶问题</h3><h4 id="原问题"><a href="#原问题" class="headerlink" title="原问题"></a>原问题</h4><p>最小化：$f(w)$<br>限制条件：</p>
<ul>
<li>$g_i(w)\le0(i=1\sim K)$</li>
<li>$h_i(w)=0(i=1\sim M)$</li>
</ul>
<h4 id="对偶问题"><a href="#对偶问题" class="headerlink" title="对偶问题"></a>对偶问题</h4><p>定义：</p>
<script type="math/tex; mode=display">
\begin{aligned}
L(w,\alpha,\beta) &= f(w) + \sum_{i=1}^K\alpha_ig_i(w)+\sum_{i=1}^M\beta_ih_i(w)\\
&= f(w) + \alpha^Tg(w)+\beta^Th(w)
\end{aligned}</script><p>对偶问题的定义<br>最大化：$\theta(\alpha,\beta)=\inf_w(w,\alpha,\beta)$，$\inf$表示下界<br>限制条件：$\alpha_i\ge 0,\beta_i\ge0$</p>
<h4 id="原问题和对偶问题解的关系"><a href="#原问题和对偶问题解的关系" class="headerlink" title="原问题和对偶问题解的关系"></a>原问题和对偶问题解的关系</h4><p>定理：如果$w^\star$是原问题的解，而$\alpha^\star,\beta^\star$是对偶问题的解，则有：</p>
<script type="math/tex; mode=display">
f(w^\star)\ge \theta(\alpha^\star,\beta^\star)</script><p>证明：</p>
<script type="math/tex; mode=display">
\begin{aligned}
\theta(\alpha^\star,\beta^\star) &= \inf_w L(w,\alpha^\star,\beta^\star)\\
&\le L(w^\star,\alpha^\star,\beta^\star) = f(w^\star) + \sum_{i=1}^K\alpha^\star_ig_i(w^\star)+\sum_{i=1}^M\beta^\star_ih_i(w^\star)\\
&\le f(w^\star)
\end{aligned}</script><p>定义：</p>
<script type="math/tex; mode=display">
G = f(w^\star) - \theta(\alpha^\star,\beta^\star)\ge0</script><p>$G$叫做原问题与对偶问题的间距。对于某些特定优化问题，可以证明：$G=0$。</p>
<p>强对偶定理：若$f(w)$为凸函数，且$g(w)=Aw+b,h(w)=Cw+d$，则此优化问题的原问题与对偶问题的间距为$0$。即</p>
<script type="math/tex; mode=display">
f(w^\star) = \theta(\alpha^\star,\beta^\star)</script><p>此时我们易得对$\forall i=1\sim K$：</p>
<ul>
<li>或者$\alpha^\star_i=0$</li>
<li>或者$g^{\star}_i(w^\star)=0$</li>
</ul>
<p>这被称为<strong>KKT条件</strong>。</p>
<h3 id="利用对偶问题求解SVM"><a href="#利用对偶问题求解SVM" class="headerlink" title="利用对偶问题求解SVM"></a>利用对偶问题求解SVM</h3><p>我们先复习一下原问题：</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\min&\quad\frac{1}{2}||w||^2+C\sum_{i=1}^N\xi_i\\
&\operatorname{s.t.}\quad &y_i[w^T\phi(x_i)+b]\ge 1-\xi_i\\
&\quad &\xi_i\ge0
\end{aligned}</script><p>根据原问题的定义形式，我们将上述问题改写：</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\min&\quad\frac{1}{2}||w||^2-C\sum_{i=1}^N\xi_i\\
&\operatorname{s.t.}&\quad 1+\xi_i-y_i w^T\phi(x_i)-y_ib\le 0\\
&\quad &\xi_i\le0
\end{aligned}</script><p>凸函数定义：</p>
<script type="math/tex; mode=display">
f(\lambda x_1+(1-\lambda)x_2)\le \lambda f(x_1)+(1-\lambda)f(x_2)</script><p>我们SVM的对偶问题为：<br>最大化：</p>
<script type="math/tex; mode=display">
\theta(\alpha,\beta) = \inf_{(w,\xi_i,b)}\{\frac{1}{2}||w||^2-C\sum_{i=1}^N\xi_i+\sum_{i=1}^N\beta_i\xi_i+\sum_{i=1}^N\alpha_i[1+\xi_i-y_i w^T\phi(x_i)-y_ib]\}</script><p>限制条件：</p>
<ul>
<li>$\alpha_i\ge 0$</li>
<li>$\beta_i\ge 0$</li>
</ul>
<p>我们要想求得$\theta(\alpha,\beta)$，首先要最优化$w,\xi_i,b$，对$L$函数求偏导：</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial L}{\partial w} = 0&\Rightarrow w = \sum_{i=1}^N\alpha_iy_i\phi(x_i)\\
\frac{\partial L}{\partial \xi_i} = 0&\Rightarrow \beta_i+\alpha_i=C\\
\frac{\partial L}{\partial b}=0&\Rightarrow \sum_{i=1}^N\alpha_iy_i=0
\end{aligned}</script><p>将其代入，得到：</p>
<script type="math/tex; mode=display">
\theta(\alpha,\beta) = \sum_{i=1}^N\alpha_i-\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_i\alpha_jy_iy_jK(x_i,x_j)</script><p>其中$K(x_i,x_j) = \phi(x_i)^T\phi(x_j)$。</p>
<p>所以对偶优化问题变为：<br>最大化：</p>
<script type="math/tex; mode=display">
\theta(\alpha) = \sum_{i=1}^N\alpha_i-\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_i\alpha_jy_iy_jK(x_i,x_j)</script><p>限制条件：</p>
<ol>
<li>$0\le\alpha_i\le C$</li>
<li>$\sum_{i=1}^N\alpha_iy_i=0$</li>
</ol>
<p>这也是一个凸优化问题，解这个问题有一个标准的算法(SMO)算法。</p>
<p>这样我们就可以求出$\alpha_i,i=1\sim N$，但是我们要求的是$w$和$b$，那么我们应该如何求出$w,b$呢，我们可以用之前得到的$w = \sum_{i=1}^N\alpha_iy_i\phi(x_i)$，但问题是我们并不知道$\phi(x_i)$。</p>
<p>但是在判断样本属于哪一类的时候我们并不需要知道$w$，假设有测试样本$x$，我们知道：</p>
<ul>
<li>若$w^T\phi(x)+b\ge0$，则$y=+1$</li>
<li>若$w^T\phi(x)+b&lt;0$，则$y=-1$</li>
</ul>
<p>而</p>
<script type="math/tex; mode=display">
\begin{aligned}
w^T\phi(x) &= \sum_{i=1}^N\alpha_iy_i\phi(x_i)^T\phi(x)\\
&= \sum_{i=1}^N\alpha_iy_iK(x_i,x)
\end{aligned}</script><p>但是$b$应该怎么算呢？<br>应用KKT条件，我们有</p>
<ul>
<li>要么$\beta_i=0$，要么$\xi_i=0$</li>
<li>要么$\alpha_i=0$，要么$1+\xi_i-y_iw^T\phi(x_i)-y_ib=0$</li>
</ul>
<p>我们取一个$0&lt;\alpha_i<C\Rightarrow \beta_i=C-\alpha_i>0$，</p>
<p>此时$\beta_i\neq0\Rightarrow\xi_i=0$，因为$\alpha_i\neq0\Rightarrow b = y_i - \sum_{j=1}^N\alpha_jy_jK(x_i,x_j)$。也可以找到所有不等于$0$的$\alpha_i$，求得$b$取平均。</p>
<h3 id="SMO算法"><a href="#SMO算法" class="headerlink" title="SMO算法"></a>SMO算法</h3><p>最大化：</p>
<script type="math/tex; mode=display">
\theta(\alpha) = \sum_{i=1}^N\alpha_i-\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_i\alpha_jy_iy_jK(x_i,x_j)</script><p>限制条件：</p>
<ol>
<li>$0\le\alpha_i\le C$</li>
<li>$\sum_{i=1}^N\alpha_iy_i=0$</li>
</ol>
<p>因为我们要优化的变量($\alpha_i$)很多，所以我们每次迭代只选择几个变量进行更新；又因为我们的是有约束的优化问题，所以每次更新可能会破坏我们的约束条件，为了不破坏我们的约束条件，我们每次至少选择两个变量进行优化。因此我们每次选择两个变量来进行优化。</p>
<h4 id="两个变量二次规划的求解过程"><a href="#两个变量二次规划的求解过程" class="headerlink" title="两个变量二次规划的求解过程"></a>两个变量二次规划的求解过程</h4><ul>
<li>选择两个变量，其他变量固定</li>
<li>SMO将对偶问题转化成一系列子问题</li>
</ul>
<script type="math/tex; mode=display">
\begin{aligned}

\min _{\alpha_{1}, \alpha_{2}} & W\left(\alpha_{1}, \alpha_{2}\right)=\frac{1}{2} K_{11} \alpha_{1}^{2}+\frac{1}{2} K_{22} \alpha_{2}^{2}+y_{1} y_{2} K_{12} \alpha_{1} \alpha_{2} \\

& -\left(\alpha_{1}+\alpha_{2}\right)+y_{1} \alpha_{1} \sum_{i=3}^{N} y_{i} \alpha_{i} K_{i 1}+y_{2} \alpha_{2} \sum_{i=3}^{N} y_{i} \alpha_{i} K_{i 2} \\

\text { s.t. } & \alpha_{1} y_{1}+\alpha_{2} y_{2}=-\sum_{i=3}^{N} y_{i} \alpha_{i}=\zeta \\

& 0 \leq \alpha_{i} \leq C, i=1,2
\end{aligned}</script><ul>
<li>根据约束条件，$\alpha_2$可以表示为$\alpha_1$的函数</li>
<li>优化问题有解析解</li>
<li>基于初始可行解$\alpha_1^{old},\alpha_2^{old}$，可以得到$\alpha_1^{new},\alpha_2^{new}$</li>
</ul>
<p>两个变量，约束条件用二维空间中的图形表示：<br><img src="https://static01.imgkr.com/temp/fb18fa3a67f14d0eaecf9214ecf952ec.png" alt=""><br>下面首先考虑第一种情况，根据不等式条件$\alpha_2^{new}$的取值范围：</p>
<script type="math/tex; mode=display">
    L\le \alpha_2^{new} \le H</script><p>其中</p>
<script type="math/tex; mode=display">
L = \max(0,\alpha_2^{old}-\alpha_1^{old})\quad H = \min(C,C+\alpha_2^{old}-\alpha_1^{old})</script><p>同理对于第二种情况，根据不等式条件$\alpha_2^{new}$的取值范围：</p>
<script type="math/tex; mode=display">
    L\le \alpha_2^{new} \le H</script><p>其中</p>
<script type="math/tex; mode=display">
L = \max(0,\alpha_2^{old}+\alpha_1^{old}-C)\quad H = \min(C,\alpha_2^{old}+\alpha_1^{old})</script><p>下面开始求解，求得的过程为：</p>
<ul>
<li>先求沿着约束方向未经剪辑时的$\alpha_2^{new,unc}$</li>
<li>再求剪辑后的$\alpha_2^{new}$</li>
</ul>
<p>我们记<br>$g(x)=\sum_{i=1}^N\alpha_iy_iK(x_i,x)+b$，即我们的判别表达式，令：</p>
<script type="math/tex; mode=display">
E_i = g(x_i)-y_i = \left(\sum_{j=1}^N\alpha_jy_jK(x_j,x_i)+b\right)-y_i</script><p>为输入$x$的预测值和真实输出$y$的差。<br>为了简便，引进记号：</p>
<script type="math/tex; mode=display">
v_i = \sum_{j=3}^N\alpha_jy_jK(x_i,x_j) = g(x_i) - \sum_{j=1}^2\alpha_jy_jK(x_i,x_j)-b</script><p>目标函数写成：</p>
<script type="math/tex; mode=display">
\begin{aligned}

W\left(\alpha_{1}, \alpha_{2}\right)=& \frac{1}{2} K_{11} \alpha_{1}^{2}+\frac{1}{2} K_{22} \alpha_{2}^{2}+y_{1} y_{2} K_{12} \alpha_{1} \alpha_{2} \\

&-\left(\alpha_{1}+\alpha_{2}\right)+y_{1} v_{1} \alpha_{1}+y_{2} v_{2} \alpha_{2}

\end{aligned}</script><p>由$\alpha_1y_1 = \zeta-\alpha_2y_2$及$y_i^2=1$，我们得$\alpha_1 = (\zeta-y_2\alpha_2)y_1$，代入上式得到只是$\alpha_2$的函数的目标函数：</p>
<script type="math/tex; mode=display">
\begin{aligned}
W(\alpha_2) &= \frac{1}{2}K_{11}(\zeta-\alpha_2y_2)^2 + \frac{1}{2}K_{22}\alpha_2^2+y_2K_{12}(\zeta-\alpha_2y_2)\alpha_2\\
&-(\zeta-\alpha_2y_2)y_1-\alpha_2+v_1(\zeta-\alpha_2y_2)+y_2v_2\alpha_2
\end{aligned}</script><p>对$\alpha_2$求导并令其等于$0$，得：</p>
<script type="math/tex; mode=display">
\begin{aligned}

&\left(K_{11}+K_{22}-2 K_{12}\right) \alpha_{2}=y_{2}\left(y_{2}-y_{1}+\zeta K_{11}-\zeta K_{12}+v_{1}-v_{2}\right) \\

&=y_{2}\left[y_{2}-y_{1}+\zeta K_{11}-\zeta K_{12}+\left(g\left(x_{1}\right)-\sum_{j=1}^{2} y_{j} \alpha_{j} K_{1 j}-b\right)-\left(g\left(x_{2}\right)-\sum_{j=1}^{2} y_{j} \alpha_{j} K_{2 j}-b\right)\right]

\end{aligned}</script><p>将$\zeta=\alpha_1^{old}y_1+\alpha_2^{old}y_2$代入：</p>
<script type="math/tex; mode=display">
\begin{aligned}

\left(K_{11}+K_{22}-2 K 12\right) \alpha_{2}^{n e w, u n c} &\left.=y_{2}\left(\left(K_{11}+K_{22}-2 K_{12}\right) \alpha_{2}^{\text {old }} y_{2}+y_{2}-y_{1}+g\left(x_{1}\right)-g\left(x_{2}\right)\right)\right) \\

&=\left(K_{11}+K_{22}-2 K_{12}\right) \alpha_{2}^{\text {old }}+y_{2}\left(E_{1}-E_{2}\right)

\end{aligned}</script><p>将$\eta = K_{11}+K_{22}-2K_{12}$代入：</p>
<script type="math/tex; mode=display">
    \alpha_2^{new,unc} = \alpha_2^{old}+\frac{y_2(E_1-E_2)}{\eta}</script><p>我们之后对解进行剪辑：</p>
<script type="math/tex; mode=display">
\begin{cases}
H,\quad &\alpha_2^{new,unc}>H\\
\alpha_2^{new,unc},\quad&L\le \alpha_2^{new,unc}\le H\\
L,\quad& \alpha_2^{new,unc}<L
\end{cases}</script><p>得到$\alpha_1$的解：</p>
<script type="math/tex; mode=display">
\alpha_1^{new} = \alpha_1^{old}+y_1y_2(\alpha_2^{old}-\alpha_2^{new})</script><p>关于KKT条件，我们有：</p>
<script type="math/tex; mode=display">
\begin{array}{r}

\alpha_{i}=0 \Leftrightarrow y_{i} g\left(x_{i}\right) \geqslant 1 \\

0<\alpha_{i}<C \Leftrightarrow y_{i} g\left(x_{i}\right)=1 \\

\alpha_{i}=C \Leftrightarrow y_{i} g\left(x_{i}\right) \leqslant 1

\end{array}</script><p>下面我们计算阈值$b$和$E_i$<br>由KKT条件，如果$0&lt;\alpha_1^{new}&lt;C$，则</p>
<script type="math/tex; mode=display">
\sum_{i=1}^N\alpha_iy_iK_{i1}+b=y_1</script><script type="math/tex; mode=display">
b_1^{new} = y_1-\sum_{i=3}^N\alpha_iy_iK_{i1}-\alpha_1^{new}y_1K_{11}-\alpha_2^{new}y_2K_{21}</script><script type="math/tex; mode=display">
E_i = g(x_i)-y_i = \left(\sum_{j=1}^N\alpha_jy_jK(x_j,x_i)+b\right)-y_i</script><script type="math/tex; mode=display">
E_1 = \sum_{i=3}^N\alpha_iy_iK_{i1}+\alpha_1^{old}y_1K_{11}+\alpha_2^{old}y_2K_{21}+b^{old}-y_1</script><p>$E_1$的表达式与$b_1^{new}$相结合，得：</p>
<script type="math/tex; mode=display">
b_1^{new} = -E_1-y_1K_{11}(\alpha_1^{new}-\alpha_1^{old})-y_2K_{21}(\alpha_2^{new}-\alpha_2^{old})+b^{old}</script><p>同理，如果$0&lt;\alpha_2^{new}&lt;C$，则</p>
<script type="math/tex; mode=display">


\begin{aligned}

&0<\alpha_{2}^{\text {new }}<C \\

&b_{2}^{\text {new }}=-E_{2}-y_{1} K_{12}\left(\alpha_{1}^{\text {new }}-\alpha_{1}^{\text {old }}\right)-y_{2} K_{22}\left(\alpha_{2}^{\text {new }}-\alpha_{2}^{\text {old }}\right)+b^{\text {old }} \\

&E_{i}^{\text {new }}=\sum_{S} y_{j} \alpha_{j} K\left(x_{i}, x_{j}\right)+b^{\text {new }}-y_{i}

\end{aligned}</script><p>如果$\alpha_1^{new},\alpha_2^{new}$同时满足条件$0&lt;\alpha_i^{new}&lt;C$，那么$b_1^{new}=b_2^{new}$。如果$\alpha_1^{new},\alpha_2^{new}$是$0$或者$C$，那么$b_1^{new},b_2^{new}$以及它们之间的数都是符合KKT条件的阈值，这时选择它们的中点作为$b^{new}$。<br>在每次完成两个变量的优化之后，还必须更新对应的$E_i$值，并将它们保存在列表中。$E_i$值的更新要用到$b^{new}$值，以及所有支持向量对应的$\alpha_j$：</p>
<script type="math/tex; mode=display">
E_i^{new} = \sum_{S}y_ja_jK(x_i,x_j)+b^{new}-y_i</script><p>其中，$S$是所有支持向量的集合。<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/62367247">关于此方面的解释</a></p>
<h4 id="变量的启发式选择"><a href="#变量的启发式选择" class="headerlink" title="变量的启发式选择"></a>变量的启发式选择</h4><p>SMO算法在每个子问题中选择两个变量优化，其中至少一个变量是违反KKT条件的。</p>
<ol>
<li>第一个变量的选择：外循环<ol>
<li>违反KKT条件最严重的样本点</li>
<li>检验样本点是否满足KKT条件：</li>
<li><script type="math/tex; mode=display">\begin{array}{r}
\alpha_{i}=0 \Leftrightarrow y_{i} g\left(x_{i}\right) \geqslant 1 \\ 0<\alpha_{i}<C \Leftrightarrow y_{i} g\left(x_{i}\right)=1 \\ \alpha_{i}=C \Leftrightarrow y_{i} g\left(x_{i}\right) \leqslant 1
\end{array}</script></li>
</ol>
</li>
</ol>
<p>该检验是在$\epsilon$范围内进行的。在检验过程中，外层循环首先遍历满足条件$0&lt;\alpha_i&lt;C$的样本点，即在间隔边界上的支持向量点，检验它们是否满足KKT条件，如果这些样本点都满足KKT条件，那么遍历整个训练集，检验他们是否满足KKT条件。</p>
<ol>
<li>第二个变量的检查：内循环<ol>
<li>选择的标准是希望能使目标函数有足够大的变化<ol>
<li>即对应$|E_1-E_2|$最大</li>
</ol>
</li>
<li>如果内循环通过上述方法找到的点不能使目标函数有足够大的下降，则：遍历间隔边界上的样本点，测试目标函数下降<ol>
<li>如果下降不大，则遍历所有样本点</li>
<li>如果依然下降不大，则丢弃外循环点，重新选择</li>
</ol>
</li>
</ol>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/138556326">算法实现</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kernal</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="comment"># 高斯核, s为方差</span></span><br><span class="line">    <span class="keyword">return</span> a.dot(b)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SVM</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,data,label</span>):</span></span><br><span class="line">        self.data = data</span><br><span class="line">        self.label = label</span><br><span class="line">        self.<span class="built_in">len</span> = data.shape[<span class="number">0</span>]</span><br><span class="line">        self.E = np.zeros((self.<span class="built_in">len</span>,<span class="number">1</span>))</span><br><span class="line">        self.alpha = np.random.random((self.<span class="built_in">len</span>,<span class="number">1</span>))</span><br><span class="line">        self.b = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">self,i</span>):</span></span><br><span class="line">        <span class="comment"># 传入索引</span></span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(self.<span class="built_in">len</span>):</span><br><span class="line">            s += self.alpha[k]*self.label[k]*kernal(self.data[i,:],self.data[k,:])</span><br><span class="line">        <span class="keyword">return</span> s + self.b</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 计算E</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(self.<span class="built_in">len</span>):</span><br><span class="line">            E = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.<span class="built_in">len</span>):</span><br><span class="line">                E += self.alpha[i]*self.label[i]*kernal(self.data[i,:],self.data[j,:])</span><br><span class="line">            self.E[j] = E + self.b - self.label[j]</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bound</span>(<span class="params">self, i,j,alpha_i, alpha_j, C</span>):</span></span><br><span class="line">        <span class="comment"># 传入两个索引，为需要优化的alpha的索引</span></span><br><span class="line">        <span class="comment"># 求解alpha_j的范围</span></span><br><span class="line">        <span class="comment"># C为正则化项系数</span></span><br><span class="line">        <span class="keyword">if</span> self.label[i] != self.label[j]:</span><br><span class="line">            L, H = np.<span class="built_in">max</span>([<span class="number">0</span>, alpha_j-alpha_i]), np.<span class="built_in">min</span>([C, C+alpha_j-alpha_i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            L, H = np.<span class="built_in">max</span>([<span class="number">0</span>, alpha_j+alpha_i-C]), np.<span class="built_in">min</span>([C, alpha_j+alpha_i])</span><br><span class="line">        <span class="keyword">return</span> (L,H)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, i,j, C</span>):</span></span><br><span class="line">        <span class="comment"># 更新alpha和b</span></span><br><span class="line">        <span class="comment"># 传入索引</span></span><br><span class="line">        eta = kernal(self.data[i,:],self.data[i,:]) + kernal(self.data[j,:],self.data[j,:]) - <span class="number">2</span>*kernal(self.data[i,:],self.data[j,:])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 下面需要补充逻辑关系</span></span><br><span class="line">        alpha_old_i = self.alpha[i]</span><br><span class="line">        alpha_old_j = self.alpha[j]</span><br><span class="line">        self.alpha[j] = self.alpha[j] + self.label[j]*(self.E[i]-self.E[j])/eta</span><br><span class="line">        L, H = self.bound(i,j,alpha_old_i,alpha_old_j,C)</span><br><span class="line">        <span class="keyword">if</span> self.alpha[j] &gt;= H:</span><br><span class="line">            self.alpha[j] = H</span><br><span class="line">        <span class="keyword">elif</span> self.alpha[j] &lt;= L:</span><br><span class="line">            self.alpha[j] = L</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.alpha[j] = self.alpha[j]</span><br><span class="line">        self.alpha[i] = self.alpha[i] + self.label[i]*self.label[j]*(alpha_old_j-self.alpha[j])</span><br><span class="line">        </span><br><span class="line">        b1 = self.b - self.E[i] - self.label[i]*(self.alpha[i]-alpha_old_i)*kernal(self.data[i,:],self.data[i,:])-self.label[j]*(self.alpha[j]-alpha_old_j)*kernal(self.data[j,:],self.data[i,:])</span><br><span class="line">        b2 = self.b - self.E[j] - self.label[i]*(self.alpha[i]-alpha_old_i)*kernal(self.data[i,:],self.data[j,:])-self.label[j]*(self.alpha[j]-alpha_old_j)*kernal(self.data[j,:],self.data[j,:])</span><br><span class="line">        </span><br><span class="line">        self.b = (b1+b2)/<span class="number">2</span></span><br><span class="line">        self.error()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">smo</span>(<span class="params">self, epsilon, max_iter, C</span>):</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(max_iter):</span><br><span class="line">            I = np.intersect1d(np.argwhere(self.alpha&gt;<span class="number">0</span>),np.argwhere(self.alpha&lt;C))</span><br><span class="line">            d = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> I:</span><br><span class="line">                d.append(np.<span class="built_in">abs</span>(self.label[i]*self.f(i)-<span class="number">1</span>))</span><br><span class="line">            i = np.argmax(np.array(d))</span><br><span class="line">            j = np.argmax(self.E-self.E[i])</span><br><span class="line">            self.update(i,j,C)</span><br><span class="line">        </span><br><span class="line">            ge = np.array([i  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.<span class="built_in">len</span>) <span class="keyword">if</span> self.alpha[i]&gt;=<span class="number">1</span>])</span><br><span class="line">            eq = np.array([i  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.<span class="built_in">len</span>) <span class="keyword">if</span> self.alpha[i]==<span class="number">1</span>])</span><br><span class="line">            le = np.array([i  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.<span class="built_in">len</span>) <span class="keyword">if</span> self.alpha[i]&lt;=<span class="number">1</span>])</span><br><span class="line">            Ge = []</span><br><span class="line">            Eq = []</span><br><span class="line">            Le = []</span><br><span class="line">            <span class="keyword">for</span> ig <span class="keyword">in</span> ge:</span><br><span class="line">                Ge.appned(self.label[ig]*self.f(ig))</span><br><span class="line">            <span class="keyword">for</span> ie <span class="keyword">in</span> eq:</span><br><span class="line">                Eq.append(self.label[ie]*self.f(ie))</span><br><span class="line">            <span class="keyword">for</span> il <span class="keyword">in</span> le:</span><br><span class="line">                Le.append(self.label[il]*self.f(il))</span><br><span class="line">            </span><br><span class="line">            Ge = np.array(Ge)</span><br><span class="line">            Eq = np.array(Eq)</span><br><span class="line">            Le = np.array(Le)</span><br><span class="line">            </span><br><span class="line">            ne = np.<span class="built_in">sum</span>(np.<span class="built_in">abs</span>(Eq-<span class="number">1</span>)&gt;epsilon)</span><br><span class="line">            ng1 = np.<span class="built_in">sum</span>(np.<span class="built_in">abs</span>(Ge-<span class="number">1</span>)&lt;<span class="number">0</span>)</span><br><span class="line">            ng2 = np.<span class="built_in">sum</span>(np.<span class="built_in">abs</span>(Ge-<span class="number">1</span>)&gt;epsilon)</span><br><span class="line">            nl1 = np.<span class="built_in">sum</span>(np.<span class="built_in">abs</span>(Le-<span class="number">1</span>)&gt;<span class="number">0</span>)</span><br><span class="line">            nl2 = np.<span class="built_in">sum</span>(np.<span class="built_in">abs</span>(Le-<span class="number">1</span>)&gt;epsilon)</span><br><span class="line">            <span class="keyword">if</span> (ne+ng1+ng2+nl1+nl2)==<span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(self.<span class="built_in">len</span>):</span><br><span class="line">            s += self.alpha[k]*self.label[k]*kernal(self.data[k,:],x)</span><br><span class="line">        s = s + self.b</span><br><span class="line">        <span class="keyword">if</span> s &gt;=<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
	
		</div>
		
		<div id="current-post-cover" data-scr="/img/post_cover/18.jpg"></div>

		<!-- relate post, comment...-->
		<div class="investment-container">
			<div class="investment-header">
				<div class="investment-title-1">
					<div class="on">相关文章</div>
					<div>评论</div>
					<div>分享</div>
				</div>
				<div class="investment-title-2">	            
					
	<span>
		<a id="totop-post-page">返回顶部</a>
		
			<a href="/2021/12/04/MCMC/" title="马尔科夫链蒙特卡洛方法" rel="prev">
				&laquo;上一篇
			</a>
		
		
			<a href="/2021/10/31/Linear-algebra-in-cv/" title="计算机视觉中的线性代数第一章" rel="next">
				下一篇&raquo;
			</a>
			
	</span>


      		
				</div>	
			</div>
			
			<div class="investment-content">
				<div class="investment-content-list">
					

<div class="relate-post">
	
		<ul>
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/16/%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%BB%A4%E6%B3%A2%E4%B8%8E%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2/" title="贝叶斯滤波与卡尔曼滤波">
								贝叶斯滤波与卡尔曼滤波			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十二月 16日, 2021				
							</p>
							<p class="relate-post-content">
								随机过程与卡尔曼滤波随机过程：$x_1,x_2,\cdots,x_n$是随机变量，但是不相互独立（无法做随机试验）。
随机实验：

在相同条件下，试验可以重复进行（独立性）
一次试验，结果不确定，所有可能的结果已知
试验之前，试验结果...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/16/%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%BB%A4%E6%B3%A2%E4%B8%8E%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2/" title="贝叶斯滤波与卡尔曼滤波">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/14.jpg" alt="贝叶斯滤波与卡尔曼滤波"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/04/MCMC/" title="马尔科夫链蒙特卡洛方法">
								马尔科夫链蒙特卡洛方法			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十二月 4日, 2021				
							</p>
							<p class="relate-post-content">
								蒙特卡洛方法MC实质：随机抽样为什么要抽样？
假设我们有关于$x$的一个正态分布的概率密度：

f(x) = \frac{1}{\sqrt{2\pi}\sigma}\exp\left(-\frac{(x-\mu)^2}{2\sigma...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/04/MCMC/" title="马尔科夫链蒙特卡洛方法">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/14.jpg" alt="马尔科夫链蒙特卡洛方法"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/10/31/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="算法学习笔记第一节">
								算法学习笔记第一节			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十月 31日, 2021				
							</p>
							<p class="relate-post-content">
								

 


认识时间复杂度常数时间的操作：一个操作如果跟数据量没有关系，每次都是固定时间内完成的操作，叫做常数操作。时间复杂度为一个算法流程中，常数操作数量的质量，常用$O$来表示。具体来说，只要高阶项，不要低阶项，也不要高阶项的系数...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/10/31/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="算法学习笔记第一节">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/14.jpg" alt="算法学习笔记第一节"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/08/31/%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B%E5%92%8CEM%E7%AE%97%E6%B3%95/" title="高斯混合模型和EM算法">
								高斯混合模型和EM算法			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								八月 31日, 2021				
							</p>
							<p class="relate-post-content">
								Gaussian mixture models and the EM algorithm我们使用简写符号$X_1^n$来表示$X_1,X_2,\cdots,X_n$，相似地，$x_1^n$表示$x_1,x_2,\cdots,x_n$。...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/08/31/%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B%E5%92%8CEM%E7%AE%97%E6%B3%95/" title="高斯混合模型和EM算法">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/5.jpg" alt="高斯混合模型和EM算法"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/07/28/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%B2%BE%E8%A6%81%E7%AC%94%E8%AE%B0/" title="统计学习基础">
								统计学习基础			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								七月 28日, 2021				
							</p>
							<p class="relate-post-content">
								自己学习统计学习基础的笔记。


	
    
	




							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/07/28/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%B2%BE%E8%A6%81%E7%AC%94%E8%AE%B0/" title="统计学习基础">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/1.jpg" alt="统计学习基础"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/11/%E6%95%B0%E8%AE%BA/" title="数论">
								数论			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十二月 11日, 2021				
							</p>
							<p class="relate-post-content">
								开个新坑


	
    
	




							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/11/%E6%95%B0%E8%AE%BA/" title="数论">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/12.jpg" alt="数论"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/10/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B/" title="随机过程第一章：基本概念">
								随机过程第一章：基本概念			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十二月 10日, 2021				
							</p>
							<p class="relate-post-content">
								

	
    
	



							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/10/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B/" title="随机过程第一章：基本概念">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/7.jpg" alt="随机过程第一章：基本概念"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/05/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/" title="贝叶斯统计分析">
								贝叶斯统计分析			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十二月 5日, 2021				
							</p>
							<p class="relate-post-content">
								最近一次更新：根据梅老师的课更新了一下无信息先验。


	
    
	




							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/05/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/" title="贝叶斯统计分析">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/17.jpg" alt="贝叶斯统计分析"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/10/31/Linear-algebra-in-cv/" title="计算机视觉中的线性代数第一章">
								计算机视觉中的线性代数第一章			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十月 31日, 2021				
							</p>
							<p class="relate-post-content">
								向量空间、基、线性映射线性组合、线性独立和秩在线性优化问题中，我们经常会遇到线性方程组。例如，考虑求解下列具有三个变量$x_1,x_2,x_2\mathbb{R}$的三个线性方程组：

\begin{aligned}
x_1 + 2x...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/10/31/Linear-algebra-in-cv/" title="计算机视觉中的线性代数第一章">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/10.jpg" alt="计算机视觉中的线性代数第一章"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/09/12/%E7%BA%BF%E6%80%A7%E7%A9%BA%E9%97%B4/" title="线性代数应该这样学：线性空间">
								线性代数应该这样学：线性空间			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								九月 12日, 2021				
							</p>
							<p class="relate-post-content">
								向量空间线性代数是研究有限维向量空间上的线性映射的学科。在线性代数中，如果研究复数和实数，会出现更好的定理和更多的洞察力。因此我们将从介绍复数和它们的基本概念开始。
我们将平面和平凡空间(ordinary space)的例子推广到$\...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/09/12/%E7%BA%BF%E6%80%A7%E7%A9%BA%E9%97%B4/" title="线性代数应该这样学：线性空间">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post_cover/6.jpg" alt="线性代数应该这样学：线性空间"/>
							</a>
						</div>
					</li>												
			
		</ul>
	
</div>	
				</div>
				<div class="investment-content-list">
					<div class="layout-comment">

	

		
			
			<!-- livere comment -->
			<!-- show livere comment -->
<div id="lv-container" data-id="city" data-uid='MTAyMC81MzYxNS8zMDA4OA=='>
	<script type="text/javascript">
	   (function(d, s) {
	       var j, e = d.getElementsByTagName(s)[0];
 	       if (typeof LivereTower === 'function') { return; }
 	       j = d.createElement(s);
	       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
	       j.async = true;
 	       e.parentNode.insertBefore(j, e);
	   })(document, 'script');
	</script>
	<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
			
		
		
	

</div>
				</div>
				<div class="investment-content-list">
					<div class="layout-share">
	
	

		
			
			<!-- socialShare share -->
			<div class="social-share"></div>

<!--  css & js -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
			
		
		
	
</div>


				</div>
			</div>	
		</div>
	</div>
</div>

<!-- show math formula -->

	<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	<script type="text/x-mathjax-config">
		MathJax.Hub.Config(
			{ 
				tex2jax: {
					inlineMath: [['$','$'], ['\\(','\\)']]
				} 
			}
		);
	</script>



	 
	
<script src="/plugin/clipboard/clipboard.js"></script>

	<script>
		// Copy code !
	    function preprocessing() {
	        $("#article-content .highlight").each(function() {
	            $(this).wrap('<div id="post-code"></div>');
	        })

	        $("#article-content #post-code").each(function() {
	            $(this).prepend('<nav class="copy-nav"><span><i class="code-language"></i></span></nav>');
	        })

	        $("#article-content .copy-nav").each(function() {
	            let languageClass = $(this).next().attr('class'),
	                language = ((languageClass.length > 9) && (languageClass != null)) ? languageClass.substr(10) : "none"; //why 9? Need to check language?

	            $(this).find('.code-language').text(language);
	            $(this).append('<span class="copy-btn icon-paste"></span>');
	        });
	    }

		function copy() {
		    $('#article-content #post-code').each(function(i) {
		        let codeCopyId = 'codeCopy-' + i;

		        let codeNode = $(this).find('.code'),
		            copyButton = $(this).find('.copy-btn');

		        codeNode.attr('id', codeCopyId);
		        copyButton.attr('data-clipboard-target-id', codeCopyId);
		    })
   
			let clipboard = new ClipboardJS('.copy-btn', {
					target: function(trigger) {
						return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
					}
		      	});

			//pure js
			function showTooltip(elem, msg) {		   
				elem.setAttribute('aria-label', msg);
				elem.setAttribute('class', 'copy-btn icon-clipboard1');
				setTimeout(function() {
					elem.setAttribute('class', 'copy-btn icon-paste');
				}, 2000);
			}

			clipboard.on('success', function(e) {
			    e.clearSelection();
			    console.info('Action:', e.action);		   
			    console.info('Trigger:', e.trigger);
			    showTooltip(e.trigger, 'Copied!');   
			});
			
			clipboard.on('error', function(e) {
			    console.error('Action:', e.action);
			    console.error('Trigger:', e.trigger);
			});
		}
		
		(function copyCode(){
			if ($('.layout-post').length) {
			    preprocessing();
			    copy();
			} 
		})();
	</script>






<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">


<script src="/plugin/fancybox/jquery.fancybox.js"></script>


<script type="text/javascript">
	(function gallerySet(){
		let titleID = $('.article-title a'),
			imageID = $('.article-content img'),
			videoID = $('.article-content video');
		
		let postTitle = titleID.text() ? titleID.text() : "No post title!";
		
		imageID.each(function() {
			let imgPath = $(this).attr('src'),
				imgTitle = $(this).attr('alt') ? $(this).attr('alt') : "No image description!";
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox="gallery" data-caption="《 ' + postTitle + ' 》' + imgTitle + '"href="' + imgPath + '"> </a>');
		});
		
		videoID.each(function() {
			let videoPath = $(this).attr('src');
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox href=" ' + videoPath + ' "> </a>');
		});
		
		//TODO：支持html5 video

		if($('#layout-post').length) {
			$('[data-fancybox="gallery"]').fancybox({
				loop: true,
				buttons: [
					"zoom",
					"share",
					"slideShow",
					"fullScreen",
					//"download",
					"thumbs",
					"close"
				],
				protect: true
			});
		}
	})();
</script>
		</main>

		<!--footer-->
		<footer>
	<div id="navigation-show">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories" target="_blank">分类</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	
		<li class="menu-note">
			<a href="/note" class="menu-item-note" target="_blank">笔记</a>
		</li>
		
	
		<li class="menu-shuoshuo">
			<a href="/ss" class="menu-item-shuoshuo" target="_blank">说说</a>
		</li>
		
	
		<li class="menu-bangumis">
			<a href="/bangumis" class="menu-item-bangumis" target="_blank">追番</a>
		</li>
		
	
		<li class="menu-cinemas">
			<a href="/cinemas" class="menu-item-cinemas" target="_blank">追剧</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
	</div>

	<div class="copyright">
		<p>
			 
				&copy;2021, content by HFC. All Rights Reserved.
			
			
				<a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="https://github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay.
			
		</p>
		<p>
			

	<!-- busuanzi -->
	<!-- busuanzi -->

		
	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	

		<span id="busuanzi_container_page_pv">
	  		本文总阅读量<span id="busuanzi_value_page_pv"></span>次
		</span>

	




			<a href="javascript:zh_tran('s');" class="zh_click" id="zh_click_s">简体</a> 
			<a href="javascript:zh_tran('t');" class="zh_click" id="zh_click_t">繁體</a>				
		</p>
	</div>		
</footer>
		
	<!-- Local or hitokoto! -->

	
<script src="/plugin/motto/motto.js"></script>

	
	<script type="text/javascript">
		(function motto(){
			let mottoText = getMingYanContent().split('</br> - </br>'),
			
			mottoTextContent = mottoText[0]?mottoText[0]:'请刷新...',
			
			mottoTextFrom = mottoText[1]?mottoText[1]:'one/一个';
			
			mottoTextContent = mottoTextContent.trim().substring(0, 100);
		
			$("#motto-content").html( mottoTextContent);
			$("#motto-author").html( mottoTextFrom  );
		})();	
	</script>	



<!-- love effect -->

	
<script src="/plugin/love/love.js"></script>



<!-- back to top -->

	<div id="totop">
	<span class="icon-circle-up"></span>
</div>



<!-- site analysis -->


	<!-- site-analysis -->
	
	
	
	
	
 

<!-- leancloud -->


	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

  

	<!--
	时间：2018-10-3
	描述：
		插件名称：hexo-generator-search-zip
		插件来源: https://github.com/SuperKieran/hexo-generator-search-zip
		代码参考：https://github.com/SuperKieran/TKL/blob/master/layout/_partial/search.ejs(Include: js & css)	
-->
<div class="popup search-popup local-search-popup scrollbar" >
	<div class="local-search-container">
		<span class="popup-btn-close">
      		ESC
   		</span>
		<div class="local-search-header">
			<div class="input-prompt">				
			</div>
			<input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
		</div>
		<div class="local-search-body">
			<div id="local-search-output"></div>
		</div>
		<div class="local-search-footer">
			<div class="topN-post">				
				
								
			</div>
		</div>
	</div>
</div>


<script src="/plugin/search/ziploader.js"></script>
<script src="/js/search.js"></script>


<script type="text/javascript">
	var search_path = 'search.json',
		zip_Path = '/search.zip',
		version_Path = '/searchVersion.txt',
		input_Trigger = 'auto',
		top_N = '2';

	themeLocalSearch({
		search_path, 
		zip_Path, 
		version_Path, 
		input_Trigger, 
		top_N
	});
</script>



<script src="/plugin/chinese/chinese.js"></script>
<script src="/plugin/imagelazyloader/yall.min.js"></script>
<script src="/plugin/imageloaded/imagesloaded.pkgd.min.js"></script>
<script src="/plugin/nicescroll/jquery.nicescroll.js"></script>
<script src="/plugin/resizediv/resizediv.js"></script>
<script src="/js/main.js"></script>

	<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>	
</html>