[{"title":"ç‹„åˆ©å…‹é›·è¿‡ç¨‹","url":"/2022/07/06/BNP/","content":"\n<p align=\"center\">\n    <img src=\"https://img2.baidu.com/it/u=2682475456,642314187&fm=253&fmt=auto&app=138&f=JPEG?w=799&h=500\" style=\"zoom: 100%;\" />\n</p>\n\n> è¯¾ç¨‹é“¾æ¥ï¼šhttps://www.bilibili.com/video/BV1Tp411R7Sf?spm_id_from=333.337.search-card.all.click&vd_source=6177c61c946280bb88c727585de76bc8\n\n<!--more-->\n\n## ç‹„åˆ©å…‹é›·è¿‡ç¨‹\n\n### Introduction\n\nè€ƒè™‘ä¸‹åˆ—é—®é¢˜ï¼Œå‡è®¾æˆ‘ä»¬ç”¨é«˜æ–¯æ··åˆæ¨¡å‹æ¥åšèšç±»ã€‚å‡è®¾æˆ‘ä»¬çš„æ•°æ®ä¸º$x_1,x_2,\\cdots,x_N$ï¼Œé‚£æˆ‘ä»¬çš„ä¼¼ç„¶å‡½æ•°çš„å¯¹æ•°ä¸ºï¼š\n$$\n\\sum_{i=1}^N\\log\\sum_{l=1}^K\\alpha_i\\mathcal{N}(\\mu_i,\\sigma_i^2)\n$$\nä½†æ˜¯æˆ‘ä»¬éœ€è¦äº‹å…ˆç¡®å®šèšç±»çš„ä¸ªæ•°ï¼Œä½†æ˜¯åœ¨å¾ˆå¤šæƒ…å†µä¸‹èšç±»çš„ä¸ªæ•°å¹¶ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ç¡®å®šï¼Œæˆ‘ä»¬éœ€è¦ä»æ•°æ®ä¸­å­¦ä¹ åˆ°èšç±»çš„ä¸ªæ•°ã€‚ä¸€ä¸ªæ–¹æ³•æ˜¯æˆ‘ä»¬å°†èšç±»çš„æ•°ç›®$K$ä¹Ÿä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å‚æ•°$\\theta = (K,\\theta_1,\\sigma_1,\\cdots,\\theta_K,\\sigma_K)$ã€‚æˆ‘ä»¬çš„ä¼˜åŒ–é—®é¢˜å˜ä¸ºï¼š\n$$\n\\hat{\\theta} = \\arg\\max_{\\theta}\\sum_{i=1}^N\\log\\sum_{l=1}^K\\alpha_i\\mathcal{N}(\\mu_i,\\sigma_i^2)\n$$\nä½†æ˜¯æˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç°å½“$K=N$ï¼Œ$\\mu_i$ä¸ºæ•°æ®çš„å€¼ï¼Œ$\\sigma_i=0$çš„æ—¶å€™ä¼¼ç„¶å‡½æ•°è¾¾åˆ°æœ€å¤§ï¼Œå³æ¯ä¸€ä¸ªæ•°æ®éƒ½æ˜¯ä¸€ä¸ªç±»ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚\næˆ‘ä»¬çš„ä¸€ä¸ªæ–¹æ³•æ˜¯å‡è®¾æ¯ä¸ªæ•°æ®$x_i$éƒ½æ¥è‡ªäºå‚æ•°ä¸º$\\theta_i$çš„ä¸€ä¸ªåˆ†å¸ƒï¼Œè€Œ$\\theta_i\\sim H(\\theta)$ï¼Œå…¶ä¸­åˆ†å¸ƒ$H(\\theta)$ä¸ºè¿ç»­åˆ†å¸ƒï¼Œä½†æ˜¯è¿™æ ·ä¼šå‚åœ¨æ–°çš„é—®é¢˜ï¼šå› ä¸º$H(\\theta)$ä¸ºè¿ç»­åˆ†å¸ƒï¼Œæ‰€ä»¥$P(\\theta_i=\\theta_j)=0,i\\neq j$ã€‚æ‰€ä»¥è¿™æ ·æ¯ä¸ªæ•°æ®æ¥è‡ªçš„åˆ†å¸ƒéƒ½ä¸ä¸€æ ·ï¼Œåˆå›åˆ°äº†ä¹‹å‰æåˆ°çš„$K=N$çš„é—®é¢˜äº†ã€‚æ‰€ä»¥æˆ‘ä»¬ä»¤$\\theta$æ¥è‡ªä¸€ä¸ªç¦»æ•£åˆ†å¸ƒ$G(\\theta)$ï¼Œè€Œ$G\\sim \\text{DP}(\\alpha,H)$ï¼Œå…¶ä¸­DPè¡¨ç¤ºç‹„åˆ©å…‹é›·è¿‡ç¨‹ï¼Œè€Œ$H$ä¸ºä¹‹å‰çš„è¿ç»­åˆ†å¸ƒï¼Œ$\\alpha>0$ä¸ºå¸¸æ•°ï¼Œå…¶åæ˜ $G$çš„ç¦»æ•£ç¨‹åº¦ï¼Œè¶Šå¤§è¡¨ç¤ºç¦»æ•£ç¨‹åº¦è¶Šå°ï¼Œå½“$\\alpha\\rightarrow0$æ—¶ï¼Œ$G$ç¦»æ•£ç¨‹åº¦æœ€å¤§ï¼Œä¸ºä¸€ä¸ªç‚¹ï¼›å½“$\\alpha\\rightarrow \\infty$æ—¶ï¼Œ$G\\approx H$ã€‚\n\n> $H$ä¹Ÿä¸ä¸€å®šæ˜¯è¿ç»­çš„ï¼Œå…¶è¢«ç§°ä¸ºbase measureã€‚\n\næ³¨æ„è¿™é‡Œçš„$G$ä¸ºä¸€ä¸ªrandom measureï¼Œæˆ‘ä»¬æ¯æ¬¡ä»$\\text{DP}(\\alpha,H)$ä¸­é‡‡æ ·å¾—åˆ°çš„ä¸æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œè€Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒã€‚å‡è®¾æˆ‘ä»¬é‡‡é›†åˆ°çš„åˆ†å¸ƒä¸ºï¼š\n\n![](D:\\joplin\\2022\\2022\\paper\\BNP\\DP.png)\n\n> å…¶ä¸­$G_1,G_2$ä¸ºä¸¤æ¬¡é‡‡æ ·äº§ç”Ÿçš„åˆ†å¸ƒï¼Œä¸Šé¢çš„æ£å­è¡¨ç¤ºæ¦‚ç‡å¯†åº¦ï¼Œå…¶å’Œä¸º$1$ã€‚æˆ‘ä»¬å°†å…¶åˆ†ä¸º$a_1,a_2,\\cdots,a_d$ç­‰$d$ä¸ªåŒºåŸŸï¼Œå…¶ä¸­æ¯ä¸ªåŒºåŸŸçš„æ€»æ¦‚ç‡å¯†åº¦ç¬¦åˆç‹„åˆ©å…‹é›·åˆ†å¸ƒï¼Œå³\n> $$\n> (G(a_1),G(a_2),\\cdots,G(a_d))\\sim \\text{Dir}(\\alpha H(a_1),\\alpha H(a_2),\\cdots,\\alpha H(a_d))\n> $$\n> è¿™å°±æ˜¯ç‹„åˆ©å…‹é›·è¿‡ç¨‹çš„å®šä¹‰ã€‚\n\nå…³äºç‹„åˆ©å…‹é›·åˆ†å¸ƒï¼š\n$$\nP(x_1,\\cdots,x_i,\\cdots,x_K)\\sim \\text{Dir}(\\alpha_1,\\cdots,\\alpha_i,\\cdots,\\alpha_K)\n$$\nåˆ™\n$$\n\\begin{aligned}\n\\mathbb{E}[x_i]  &= \\frac{\\alpha_i}{\\sum_k \\alpha_k}\\\\\n\\text{Var}[x_i]&=\\frac{\\alpha_i(\\sum_k\\alpha_k-\\alpha_i)}{(\\sum_k\\alpha_k)^2(\\sum_{k}\\alpha_k+1)}\n\\end{aligned}\n$$\nå°†å…¶å¸¦å…¥åˆ°ç‹„åˆ©å…‹é›·è¿‡ç¨‹ä¸­ï¼Œå¾—ï¼š\n$$\n\\mathbb{E}[G[a_i]] = \\frac{\\alpha H(a_i)}{\\sum_k\\alpha H(a_k)} = H(a_i)\n$$\n\n$$\n\\text{var}[G[a_i]] = \\frac{\\alpha H(a_i)(\\alpha-\\alpha H(a_i))}{\\alpha^2(\\alpha+1)} = \\frac{H(a_i)(1-H(a_i))}{\\alpha+1}\n$$\n\næˆ‘ä»¬ä¹‹å‰è¯´è¿‡å…³äº$\\alpha$çš„æ€§è´¨ã€‚ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œå‡å€¼(æœŸæœ›)ä¸$\\alpha$æ— å…³ï¼Œå½“$\\alpha\\rightarrow \\infty$æ˜¯ï¼Œæ–¹å·®è¶‹è¿‘äº$0$ï¼Œè¿™è¯´æ˜ä¸ç®¡æˆ‘ä»¬æ€ä¹ˆåˆ’åˆ†ï¼Œåœ¨æ¯ä¸ª$a_i$å¤„ï¼Œ$G(a_i)=H(a_i)$ï¼Œè¯´æ˜$G(x)=H(x)$ï¼Œå³$G(x)$æ˜¯è¿ç»­çš„æ˜¯æœ€ä¸ç¦»æ•£çš„ç‰ˆæœ¬ï¼›å¦‚æœ$\\alpha=0$ï¼Œåˆ™$\\text{Var}=H(a_i)(1-H(a_i))$ï¼Œè¿™æ­£æ˜¯ä¼¯åŠªåˆ©åˆ†å¸ƒçš„æ–¹å·®ï¼Œå› æ­¤åœ¨æ¯ä¸ªåˆ’åˆ†ä¸Šæˆ‘ä»¬éƒ½å¯ä»¥ç”¨ä¸€æ ¹æ£æ¥è¡¨ç¤ºå®ƒä»¬(åŒ…æ‹¬ä¸åˆ’åˆ†)ï¼Œè¿™æ˜¯æœ€ç¦»æ•£çš„ç‰ˆæœ¬ã€‚\n\n### Construction\n\né‚£æˆ‘ä»¬å¦‚ä½•æ„å»º$G$å‘¢ï¼Ÿå³å¦‚ä½•ä»$H$ä¸­é‡‡æ ·å¾—åˆ°$G$å‘¢ï¼Ÿæˆ‘ä»¬é‡‡ç”¨`stick-breaking construction`çš„æ–¹æ³•æ¥äº§ç”Ÿ$G$ã€‚å…¶æ„å»ºæ–¹å¼ä¸ºï¼š\n\n1. ä»$H$ä¸­é‡‡æ ·å¾—åˆ°$\\theta_1$ï¼Œå³$\\theta_1\\sim H$\n2. é‡‡æ ·$\\beta_1\\sim\\text{Beta}(1,\\alpha)$\n3. æƒé‡$\\pi_1=\\beta_1$\n4. é‡‡æ ·$\\theta_2\\sim H$\n5. é‡‡æ ·$\\beta_2\\sim \\text{Beta}(1,\\alpha)$\n6. æƒé‡$\\pi_2 = (1-\\pi)\\beta_2$\n   ä»¥æ­¤ç±»æ¨ï¼Œè¿™æ ·æƒé‡$\\pi_2$ç›¸å½“äºæ˜¯ä»å–å®Œ$\\pi_1$å‰©ä¸‹çš„æƒé‡ä¸­å–å¾—ã€‚\n\næˆ‘ä»¬åœ¨çœ‹ä¸€ä¸‹å…³äº$\\alpha$å¾—ä¸€äº›å†…å®¹ï¼Œå½“$\\alpha=0$æ—¶ï¼Œ$\\mathbb{E}(\\beta_i)=1,\\text{Var}(\\beta_i)=0$ï¼Œæ‰€ä»¥ä¸€æ¬¡å°±æŠŠæƒé‡å…¨éƒ¨é‡‡å®Œï¼Œå³åªäº§ç”Ÿä¸€ä¸ªæ ·æœ¬ï¼Œå¯¹åº”äºæœ€ç¦»æ•£çš„æƒ…å†µï¼Œè€Œå½“$\\alpha=\\infty$æ—¶ï¼Œ$\\mathbb{E}(\\beta_i)=0$ï¼Œç›¸å½“äºè¿ç»­åˆ†å¸ƒçš„æƒ…å†µã€‚\n\n### Property\n\nä¸‹é¢æˆ‘ä»¬å†å›é¡¾ä¸€ä¸‹ã€‚å¯¹äºç‹„åˆ©å…‹é›·è¿‡ç¨‹ï¼Œæœ‰å¦‚ä¸‹æ€§è´¨ï¼š\n$$\nG\\sim \\text{DP}(\\alpha,H)\\Leftrightarrow (G(a_1),\\cdots,G(a_n))\\sim \\text{DIR}(\\alpha H(a_1),\\cdots,\\alpha H(a_n)),\\quad \\text{for any partitions }a_1,\\cdots,a_n\n$$\næ€»ç»“ä¹‹å‰è®²è¿‡çš„ï¼Œæˆ‘ä»¬æœ‰ï¼š\n$$\nG\\sim \\text{DP}(\\alpha,H)\n$$\n\n$$\n\\theta_1,\\cdots,\\theta_N\\sim G\n$$\n\n$$\nX_i\\sim F(\\theta_i)\n$$\n\nå…¶å›¾æ¨¡å‹ä¸ºï¼š\n\n![](D:\\joplin\\2022\\2022\\paper\\BNP\\1.png)\n\nä¸‹é¢æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹$G$çš„åéªŒåˆ†å¸ƒ$P(G\\mid \\theta_1,\\cdots,\\theta_N)$ï¼š\n$$\nP(G\\mid \\theta_1,\\cdots,\\theta_N)\\propto P(\\theta_1,\\cdots,\\theta_N\\mid G)P(G)\n$$\nåœ¨ç ”ç©¶ä¹‹å‰æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªå…³äºç‹„åˆ©å…‹é›·åˆ†å¸ƒå’Œå¤šé¡¹å¼åˆ†å¸ƒçš„ä¾‹å­ï¼š\nå‡è®¾\n$$\n\\begin{aligned}\np_1,\\cdots,p_N&\\sim\\text{DIR}(\\alpha_1,\\cdots,\\alpha_N)\\\\\nn_1,\\cdots,n_N&\\sim\\text{Mult}(p_1,\\cdots,p_N)\n\\end{aligned}\n$$\né‚£ä¹ˆ\n$$\n\\begin{aligned}\nP(p_1,\\cdots,p_N\\mid n_1,\\cdots,n_N)&\\propto\\left(\\frac{\\Gamma(\\sum_{i=1}^N\\alpha_i)}{\\prod_{i=1}^N\\Gamma(\\alpha_i)}\\prod P_i^{\\alpha_i-1}\\right)\\left(\\frac{(\\sum_{i=1}^Nn_i)!}{n_1!\\cdots n_N!}\\prod_{i=1}^NP_i^{n_i}\\right)\\\\&\\propto \\prod_{i=1}^NP_i^{\\alpha_i+n_i-1}\\\\ &= \\text{DIR}(\\alpha_1+n_1,\\cdots,\\alpha_N+n_N)\n\\end{aligned}\n$$\n\n### Posterior\n\næœ‰äº†å‰é¢çš„æŒ‡ç¤ºï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åéªŒåˆ†å¸ƒï¼š\nå¯¹äºä»»ä½•åˆ’åˆ†\n$$\n\\begin{aligned}\nP(G(a_1),\\cdots,G(a_K)\\mid \\theta_1,\\cdots,\\theta_K)&\\propto P(\\theta_1,\\cdots,\\theta_K\\mid G(a_1),\\cdots,G(a_K))P(G)\\\\\n&=\\text{Mult}(n_1,\\cdots,n_K)\\text{DIR}(\\alpha H(a_1),\\cdots,\\alpha H(a_K))\\\\\n&= \\text{Dir}(n_1+\\alpha H(a_1),\\cdots,n_K+\\alpha H(a_K))\\\\\n&= \\text{DP}\\left(\\alpha+n,\\frac{\\alpha H+\\sum_{i=1}^K\\delta_{\\theta_i}}{\\alpha+n}\\right)\n\\end{aligned}\n$$\nå…¶ä¸­$n=\\sum_{i=1}^K n_iï¼ŒG=\\sum_{i=1}^\\infty\\pi_i\\delta_{\\theta_i}$ã€‚æœ€åä¸€æ­¥æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ\næ‰€ä»¥æˆ‘ä»¬å¾—åˆ°çš„åéªŒåˆ†å¸ƒä¸ºï¼š\n$$\nP(G(a_1),\\cdots,G(a_K))\\sim \\text{Dir}(n_1+\\alpha H(a_1),\\cdots,n_K+\\alpha H(a_K))\n$$\næ ¹æ®ä¹‹å‰è®²è¿‡çš„ç‹„åˆ©å…‹é›·è¿‡ç¨‹çš„æ€§è´¨ï¼Œç‹„åˆ©å…‹é›·è¿‡ç¨‹çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯¹åº”çš„ç‹„åˆ©å…‹é›·åˆ†å¸ƒçš„æµ‹åº¦å’Œï¼Œè€Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå½’ä¸€åŒ–åçš„ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œç†è§£ä¸ºç‹„åˆ©å…‹é›·åˆ†å¸ƒçš„å‚æ•°é™¤ä»¥å½’ä¸€åŒ–ç³»æ•°ã€‚æ‰€ä»¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š$\\sum_{i=1}^K n_i+\\alpha H(a_i) = \\alpha+n$ï¼Œè€Œç¬¬äºŒä¸ªå‚æ•°ä¸º$\\frac{\\alpha H+\\sum_{i=1}^K\\delta_{\\theta_i}}{\\alpha+n}$ï¼Œå…¶ä¸­$\\alpha+n$ä¸ºå½’ä¸€åŒ–å‚æ•°ï¼Œè€Œåˆ†å­$\\sum_{i=1}^K\\delta_{\\theta_i}$å®é™…ä¸Šå°±æ˜¯è¡¨ç¤º$n_i$ã€‚\næˆ‘ä»¬å†çœ‹ä¸€ä¸‹å¾—åˆ°çš„åˆ†å¸ƒï¼š\n$$\n\\frac{\\alpha H+\\sum_{i=1}^K\\delta_{\\theta_i}}{\\alpha+n} = \\frac{\\alpha}{\\alpha+n}H+\\frac{\\sum_{i=1}^K\\delta_{\\theta_i}}{\\alpha+n}\n$$\nä¸ºä¸€ä¸ªè¿ç»­çš„åˆ†å¸ƒåŠ ä¸Šä¸€ä¸ªç¦»æ•£çš„åˆ†å¸ƒï¼Œè¿™è¢«ç§°ä¸º`spike and slab`ã€‚\n\n### Predictive distribution\n\nä»€ä¹ˆæ˜¯é¢„æµ‹åˆ†å¸ƒå‘¢ï¼Ÿé¢„æµ‹åˆ†å¸ƒä¸ºï¼š\n$$\n\\begin{aligned}\nP(X_i\\mid X_{-i}) &= \\int_w P(X_i,w\\mid X_{-i})dw\\\\\n&= \\int_w P(X_i\\mid w,X_{-i})P(w\\mid X_{-i})dw\\\\\n&= \\int_wP(X_i\\mid w)P(w\\mid X_{-i})dw\n\\end{aligned}\n$$\nå…¶ä¸­$X_{-i}$è¡¨ç¤ºå»é™¤ç¬¬$i$é¡¹åçš„$X$ã€‚\nå¯¹äºç‹„åˆ©å…‹é›·è¿‡ç¨‹ï¼Œæˆ‘ä»¬æƒ³è¦æ±‚å¾—çš„ä¸ºï¼š\n$$\nP(\\theta_i\\mid \\theta_{-i}) = \\int_G P(\\theta_i\\mid G)P(G\\mid \\theta_{-i})dG\n$$\nå…¶ä¸­$\\theta$ä¸ºç¦»æ•£å€¼ï¼Œå…·æœ‰ç›¸åŒ$\\theta$å€¼å¾—æ•°æ®è¡¨ç¤ºå±äºåŒä¸€ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨$Z$æ¥è¡¨ç¤ºå±äºå“ªä¸€ç±»ã€‚å³è®¡ç®—$P(Z_i\\mid Z_{-i})$ã€‚æœ‰å¤šå°‘ç±»åªä¸å‚æ•°$\\alpha$æœ‰å…³ï¼Œè€Œ$\\theta$çš„ä½ç½®(å€¼)åˆ™ä¸$H$æœ‰å…³ã€‚\n\n\n\næˆ‘ä»¬ä¸‹é¢è®¡ç®—ï¼š\n$$\nP(Z_i=m\\mid Z_{-i}) = \\frac{P(Z_i=m,Z_{-i})}{P(Z_{-i})}\n$$\næˆ‘ä»¬å¦‚ä½•å°†å…¶ä¸ç‹„åˆ©å…‹é›·è¿‡ç¨‹ç»“åˆèµ·æ¥å‘¢ï¼Ÿå°†å…¶ä¸ç‹„åˆ©å…‹é›·è¿‡ç¨‹ç»“åˆèµ·æ¥å¾ˆéš¾ï¼Œå› ä¸ºç‹„åˆ©å…‹é›·è¿‡ç¨‹æœ‰æ— é™å¤šçš„é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾å…¶å¤–$K$é¡¹ï¼Œç„¶åå†å°†$K$å–æ— ç©·ã€‚æˆ‘ä»¬ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š\n$$\n\\begin{aligned}\nP(Z_i=m\\mid Z_{-i}) &= \\frac{P(Z_i=m,Z_{-i})}{P(Z_{-i})}\\\\\n&=\\frac{\\int_{P_1,\\cdots,P_K}P(Z_i=m,Z_{-i}\\mid P_1,\\cdots,P_K)\\text{DIR}(\\alpha/K,\\cdots,\\alpha/K)dP}{\\int_{P_1,\\cdots,P_K}P(Z_{-i}\\mid P_1,\\cdots,P_K)\\text{DIR}(\\alpha/K,\\cdots,\\alpha/K)dP}\n\\end{aligned}\n$$\nå…³äºç§¯åˆ†çš„è®¡ç®—å°±ç”¨åˆ°æˆ‘ä»¬ä¹‹å‰çš„å¤šé¡¹å¼åˆ†å¸ƒå’Œç‹„åˆ©å…‹é›·åˆ†å¸ƒå…±è½­çš„çŸ¥è¯†äº†ï¼š\n$$\n\\begin{aligned}\n&\\int_{p_1,\\cdots,p_K}P(n_1,\\cdots,n_K\\mid p_1,\\cdots,p_K)P(p_1,\\cdots,p_K\\mid \\alpha_1,\\cdots,\\alpha_K)dP\\\\\n&=\\frac{n!}{n_1!\\cdots n_K!}\\frac{\\Gamma(\\sum\\alpha_i)}{\\prod\\Gamma(\\alpha_i)}\\int_{p_1,\\cdots,p_K}\\prod_{i=1}^K p_i^{n_i+\\alpha_i-1}dp\\\\\n&=\\frac{n!}{n_1!\\cdots n_K!}\\frac{\\Gamma(\\sum\\alpha_i)}{\\prod\\Gamma(\\alpha_i)}\\frac{\\prod\\Gamma(\\alpha_i+n_i)}{\\Gamma(\\sum\\alpha_i+n)}\n\\end{aligned}\n$$\næˆ‘ä»¬å°†å…¶åº”ç”¨åˆ°åˆ†å­å’Œåˆ†æ¯ä¸Šï¼Œé¦–å…ˆå®šä¹‰ç¬¦å·ï¼š$n_{l,-i}$è¡¨ç¤ºå»é™¤ç¬¬$i$ä¸ªæ•°æ®åå±äºç¬¬$l$ç±»çš„ä¸ªæ•°ã€‚æˆ‘ä»¬çŸ¥é“ç¬¬äºŒé¡¹ï¼š\n$$\n\\frac{\\Gamma(\\sum\\alpha_i)}{\\prod\\Gamma(\\alpha_i)}\n$$\nåªä¸å…ˆéªŒæœ‰å…³ï¼Œæ‰€ä»¥åˆ†å­åˆ†æ¯éƒ½ä¸€æ ·ã€‚\n\næˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€é¡¹ï¼Œå› ä¸ºåœ¨æˆ‘ä»¬çš„æƒ…æ™¯ä¸‹ï¼Œå³ä¾¿ç±»æ•°ç›¸ç­‰ï¼Œæ¯ä¸ªç±»çš„ä¸ªæ•°ç›¸ç­‰ï¼Œä½†æ˜¯ç›¸åŒä¸ªä½“ä¸å±äºåŒä¸€ä¸ªç±»ï¼Œè¿™ä¸¤ç§åˆ’åˆ†æ–¹æ³•å¾—åˆ°çš„ç¬¬ä¸€é¡¹çš„å€¼æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬çš„æƒ…å¢ƒä¸‹æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥ç¬¬ä¸€é¡¹ä¸åº”è¯¥å­˜åœ¨ã€‚\n\nç¬¬ä¸‰é¡¹ä»£å…¥ä¸ºï¼š\n$$\n\\frac{\\Gamma(\\alpha/K+n_{m,-i}+1)\\prod_{l\\neq i} \\Gamma(\\alpha/K+n_{l,-i})}{\\Gamma(\\alpha+n)}\\cdot \\frac{\\Gamma(\\alpha+n-1)}{\\prod\\Gamma(\\sum_l \\alpha/K+n_{l,-i})}\n$$\nä¼½é©¬å‡½æ•°å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š\n$$\n\\Gamma(x) = (x-1)\\Gamma(x-1)\n$$\nä¸Šå¼åŒ–ç®€å¾—åˆ°ï¼š\n$$\n\\frac{n_{m,-i}+\\frac{\\alpha}{K}}{n+\\alpha-1}\n$$\n\n\nå½“$K\\rightarrow \\infty$ä¸º\n$$\n\\frac{n_{m,-i}}{n+\\alpha-1}\n$$\nå¯¹$m$è¿›è¡Œæ±‚å’Œå¾—åˆ°ï¼š\n$$\n\\sum_m\\frac{n_{m,-i}}{n+\\alpha-1} = \\frac{n-1}{n+\\alpha-1}\\neq1\n$$\nè¿™ä¸æ¦‚ç‡å¯†åº¦çš„å®šä¹‰ä¸åŒï¼Œæ‰€ä»¥æœ‰$\\frac{\\alpha}{n+\\alpha-1}$çš„æ¦‚ç‡å±äºæ–°çš„ä¸€ä¸ªç±»ï¼Œè¿™å°±æ˜¯**ä¸­å›½é¤é¦†è¿‡ç¨‹**ã€‚","tags":["è´å¶æ–¯","ç®—æ³•"],"categories":["è¯¾ç¨‹ç¬”è®°"]},{"title":"ä¹¦ç±Thinking Juliaåå‡ ç« é˜…è¯»ç¬”è®°","url":"/2022/07/03/thinkjulia2/","content":"\n<p align=\"center\">\n    <img src=\"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fi0.hdslb.com%2Fbfs%2Farticle%2F0641bd5a05ae260e3167b7a6b6f389143abb0416.jpg&refer=http%3A%2F%2Fi0.hdslb.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1659401858&t=1004217d7de1a7d354b99be904052734\" style=\"zoom: 100%;\" />\n</p>\n\n> ä¹¦ç±ç½‘å€ï¼šhttps://benlauwens.github.io/ThinkJulia.jl/latest/book.html\n\n<!--more-->\n\n## Dictionaries\n\n### A Dictionary Is a Mapping\n\n~~~julia\njulia> eng2sp = Dict()\nDict{Any, Any}()\n~~~\n\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·ä¸ºå­—å…¸æ·»åŠ æ•°æ®ï¼š\n\n~~~julia\njulia> eng2sp[\"one\"] = \"uno\"\n\"uno\"\njulia> eng2sp\nDict{Any, Any} with 1 entry:\n  \"one\" => \"uno\"\n~~~\n\nä¸Šè¿°è¾“å‡ºçš„æ ¼å¼ä¹Ÿå¯ä»¥ä½œä¸ºè¾“å…¥çš„æ ¼å¼ï¼š\n\n~~~julia\njulia> eng2sp = Dict(\"one\"=>\"uno\", \"two\"=>\"dos\",\"three\"=>\"tres\")\nDict{String, String} with 3 entries: â€¦\njulia> eng2sp\nDict{String, String} with 3 entries:\n  \"two\"   => \"dos\"\n  \"one\"   => \"uno\"\n  \"three\" => \"tres\"\n~~~\n\nå¯ä»¥çœ‹å‡ºå­—å…¸è¾“å‡ºçš„é¡ºåºä¸æˆ‘ä»¬è¾“å…¥çš„é¡ºåºä¸åŒï¼Œåœ¨`Julia`ä¸­ï¼Œå­—å…¸çš„è¾“å‡ºé¡ºåºæ˜¯ä¸å¯é¢„æµ‹çš„ã€‚\n\næŸ¥çœ‹é•¿åº¦ï¼š\n\n~~~julia\njulia> length(eng2sp)\n3\n~~~\n\n`keys`å‡½æ•°è¿”å›å­—å…¸çš„é”®ï¼š\n\n~~~julia\njulia> ks = keys(eng2sp);\njulia> print(ks)\n[\"two\", \"one\", \"three\"]\n~~~\n\nä¹Ÿå¯ä»¥ç”¨ `âˆˆ` ç¬¦å·æŸ¥çœ‹æŸä¸ªå­—ç¬¦ä¸²æ˜¯å¦åœ¨keysé‡Œï¼š\n\n~~~julia\njulia> \"one\" âˆˆ ks\ntrue\n~~~\n\nä½¿ç”¨`values`å‡½æ•°è·å–å­—å…¸çš„å€¼ï¼š\n\n~~~julia\njulia> vs = values(eng2sp);\n\njulia> \"uno\" âˆˆ vs\ntrue\n~~~\n\nå­—å…¸æœ‰`get`å‡½æ•°ï¼Œç»™å®škeyè·å–å…¶å€¼ï¼Œå¦‚æœkeyä¸å­˜åœ¨ï¼Œåˆ™è¿”å›é»˜è®¤å€¼ï¼š\n\n~~~julia\njulia> get(eng2sp, \"one\",1)    \n\"uno\"                          \n                               \njulia> get(eng2sp, \"four\",1)   \n1                              \n~~~\n\n### Reverse Lookup\n\næˆ‘ä»¬å¯ä»¥æ ¹æ®å€¼æ‰¾é”®ï¼š\n\n~~~julia\njulia> findall(isequal(\"uno\"), eng2sp) \n1-element Vector{String}:              \n \"one\"                                 \n~~~\n\n### Global Variables\n\nå…¨å±€å˜é‡æ˜¯ä½äº`Main`ä¸­çš„å˜é‡ï¼Œæˆ‘ä»¬ä¸€èˆ¬å°†å…¶ç”¨ä¸º`flag`æ¥è¡¨ç¤ºçœŸå‡ï¼Œå¦‚ï¼š\n\n~~~julia\nverbose = true\n\nfunction example1()\n    if verbose\n        println(\"Running example1\")\n    end\nend\n~~~\n\nä½†æ˜¯å¦‚æœä½ \n\n~~~julia\nbeen_called = false\n\nfunction example2()\n    been_called = true         # WRONG\nend\n~~~\n\nä½ ä¼šå‘ç°`been_called`çš„å€¼æ²¡æœ‰æ”¹å˜ï¼Œè¿™æ˜¯å› ä¸ºå‡½æ•°ä¸­çš„`been_called`æ˜¯å±€éƒ¨å˜é‡ï¼Œä¸å‡½æ•°å¤–çš„å˜é‡æ— å…³ç³»ã€‚\n\nè¦åœ¨å‡½æ•°å†…éƒ¨é‡æ–°åˆ†é…å…¨å±€å˜é‡ï¼Œå¿…é¡»åœ¨ä½¿ç”¨å®ƒä¹‹å‰å£°æ˜è¯¥å˜é‡ä¸ºå…¨å±€å˜é‡ï¼š\n\n~~~julia\nbeen_called = false\n\nfunction example2()\n    global been_called\n    been_called = true\nend\n~~~\n\nå¦‚æœä¸€ä¸ªå…¨å±€å˜é‡å¼•ç”¨äº†ä¸€ä¸ªå¯å˜å€¼ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹è¯¥å€¼ï¼Œè€Œä¸éœ€è¦å£°æ˜å˜é‡ä¸ºå…¨å±€å˜é‡ï¼š\n\n~~~julia\nknown = Dict(0=>0, 1=>1)\n\nfunction example4()\n    known[2] = 1\nend\n~~~\n\nå› æ­¤ï¼Œæ‚¨å¯ä»¥æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢å…¨å±€æ•°ç»„æˆ–å­—å…¸çš„å…ƒç´ ï¼Œä½†å¦‚æœæ‚¨æƒ³é‡æ–°åˆ†é…å˜é‡ï¼Œæ‚¨å¿…é¡»å£°æ˜å®ƒæ˜¯å…¨å±€çš„ï¼š\n\n~~~julia\nknown = Dict(0=>0, 1=>1)\n\nfunction example5()\n    global known\n    known = Dict()\nend\n~~~\n\n## Tuples\n\n### Tuples Are Immutable\n\nå…ƒç»„æ˜¯ä¸å¯å˜çš„ï¼Œå…¶å…ƒç´ å¯ä»¥æ˜¯ä¸åŒçš„ç±»å‹ï¼š\n\n~~~julia\njulia> t = 'a', 'b', 'c', 'd', 'e'\n('a', 'b', 'c', 'd', 'e')\n~~~\n\nåˆ›å»ºåªæœ‰ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œåé¢å¿…é¡»åŠ `,`ï¼š\n\n~~~julia\njulia> t1 = ('a',)\n('a',)\njulia> typeof(t1)\nTuple{Char}\n~~~\n\nå¦‚æœæä¾›äº†å¤šä¸ªå‚æ•°ï¼Œåˆ™ç»“æœæ˜¯ä¸€ä¸ªå…·æœ‰ç»™å®šå‚æ•°çš„å…ƒç»„\n\n~~~julia\njulia> t3 = tuple(1, 'a', pi)\n(1, 'a', Ï€ = 3.1415926535897...)\n~~~\n\nå¯ä»¥ä½¿ç”¨æ•°å­—å¯¹å…ƒç»„è¿›è¡Œç´¢å¼•ï¼š\n\n~~~julia\njulia> t = ('a', 'b', 'c', 'd', 'e');\n\njulia> t[1]\n'a': ASCII/Unicode U+0061 (category Ll: Letter, lowercase)\njulia> t[2:4]\n('b', 'c', 'd')\n~~~\n\nä½†æ˜¯å¦‚æœä½ å°è¯•æ”¹å˜å…ƒç»„çš„å€¼åˆ™ä¼šæŠ¥é”™ï¼š\n\n~~~julia\njulia> t[1] = 'A'\nERROR: MethodError: no method matching setindex!(::NTuple{5,Char}, ::Char, ::Int64)\n~~~\n\nå…ƒç»„é€å…ƒç´ æ¯”è¾ƒå¤§å°ï¼š\n\n~~~julia\njulia> (0, 1, 2) < (0, 3, 4)\ntrue\njulia> (0, 1, 2000000) < (0, 3, 4)\ntrue\n~~~\n\n### Tuple Assignment\n\näº¤æ¢`a,b`çš„å€¼æˆ‘ä»¬å¯ä»¥ï¼š\n\n~~~julia\na, b = b, a\n~~~\n\nå·¦ä¾§çš„å€¼çš„æ•°é‡è¦å°‘äºå³è¾¹å€¼çš„æ•°é‡ï¼š\n\n~~~julia\njulia> (a, b) = (1, 2, 3)\n(1, 2, 3)\njulia> a  \n1         \n          \njulia> b  \n2         \njulia> a, b, c = 1, 2\nERROR: BoundsError: attempt to access (1, 2)\n  at index [3]\n~~~\n\n### Tuples as Return Values\n\nå…ƒç»„ä¹Ÿå¯ä»¥ä½œä¸ºè¿”å›å€¼ï¼Œå¦‚å†…ç½®å‡½æ•°`diverm`è¿”å›æ•´é™¤å’Œä½™æ•°ï¼š\n\n~~~julia\njulia> q, r = divrem(7, 3);\n\njulia> @show q r;\nq = 2\nr = 1\n~~~\n\n### Variable-length Argument Tuples\n\nå‡½æ•°å¯ä»¥æ¥å—å¯å˜æ•°é‡çš„å‚æ•°ã€‚æœ«å°¾å¸¦æœ‰`...`çš„å‚æ•°å°†å‚æ•°èšé›†æˆå…ƒç»„ï¼š\n\n~~~julia\nfunction printall(args...)\n    println(args)\nend\n\njulia> printall(1, 2.0, '3')\n(1, 2.0, '3')\n~~~\n\nåŒæ ·çš„å…ƒç»„ååŠ `...`å¯ä»¥å°†å…ƒç»„åˆ†è§£ä½œä¸ºå¤šä¸ªå‚æ•°ä¼ å…¥ï¼š\n\n~~~julia\njulia> t = (7, 3);\n\njulia> divrem(t)\nERROR: MethodError: no method matching divrem(::Tuple{Int64,Int64})\njulia> divrem(t...)\n(2, 1)\n~~~\n\n### Arrays and Tuples\n\nå†…å»ºå‡½æ•°`zip`å¯ä»¥å°†ä¸¤ä¸ªæˆ–å¤šä¸ªåºåˆ—è½¬æ¢ä¸ºå…ƒç»„çš„é›†åˆï¼Œæ¯ä¸ªå…ƒç»„åŒ…å«æ¯ä¸ªåºåˆ—çš„ä¸€ä¸ªå…ƒç´ ã€‚\n\n~~~julia\njulia> s = \"abc\";\n\njulia> t = [1,2,3];\n\njulia> zip(s,t)\nzip(\"abc\", [1, 2, 3])\n~~~\n\nè¿”å›ä¸€ä¸ª`zip`å¯¹è±¡ï¼Œ`zip`å¯¹è±¡æ˜¯ä¸€ç§è¿­ä»£å™¨ï¼Œå®ƒæ˜¯å¯¹åºåˆ—è¿›è¡Œè¿­ä»£çš„ä»»ä½•å¯¹è±¡ã€‚è¿­ä»£å™¨åœ¨æŸäº›æ–¹é¢ç±»ä¼¼äºæ•°ç»„ï¼Œä½†ä¸æ•°ç»„ä¸åŒçš„æ˜¯ï¼Œä¸èƒ½ä½¿ç”¨ç´¢å¼•ä»è¿­ä»£å™¨ä¸­é€‰æ‹©å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`for`å¾ªç¯å¯¹å…¶è¿›è¡Œéå†ï¼š\n\n~~~julia\njulia> for pair in zip(s,t)\n       println(pair)\n       end\n('a', 1)\n('b', 2)\n('c', 3)\n~~~\n\nå¦‚æœä½ æƒ³ç”¨æ•°ç»„çš„æ–¹æ³•æ¥æ“çºµ`zip`å¯¹è±¡ï¼Œå¯ä»¥å°†å…¶è½¬æ¢ä¸ºæ•°ç»„ï¼š\n\n~~~julia\njulia> collect(zip(s,t))\n3-element Vector{Tuple{Char, Int64}}:\n ('a', 1)\n ('b', 2)\n ('c', 3)\n~~~\n\nå¦‚æœåºåˆ—é•¿åº¦ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆç”¨é•¿åº¦è¾ƒå°çš„åºåˆ—ï¼š\n\n~~~julia\njulia> collect(zip(\"Anne\", \"Elk\"))\n3-element Array{Tuple{Char,Char},1}:\n ('A', 'E')\n ('n', 'l')\n ('n', 'k')\n~~~\n\nä½ å¯ä»¥åœ¨`for`å¾ªç¯ä¸­ä½¿ç”¨å…ƒç»„èµ‹å€¼æ¥éå†å…ƒç»„æ•°ç»„ï¼š\n\n~~~julia\njulia> t = [('a', 1), ('b', 2), ('c', 3)];\n\njulia> for (letter, number) in t\n           println(number, \" \", letter)\n       end\n1 a\n2 b\n3 c\n~~~\n\nä½¿ç”¨`enumerate`æ¥è·å¾—ç´¢å¼•å’Œå…ƒç´ ï¼š\n\n~~~julia\njulia> for (index, element) in enumerate(\"abc\")\n           println(index, \" \", element)\n       end\n1 a\n2 b\n3 c\n~~~\n\n### Dictionaries and Tuples\n\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…ƒç»„æ¥åˆå§‹åŒ–å­—å…¸ï¼š\n\n~~~julia\njulia> t = [('a', 1), ('c', 3), ('b', 2)];\n\njulia> d = Dict(t)\nDict{Char,Int64} with 3 entries:\n  'a' => 1\n  'c' => 3\n  'b' => 2\n~~~\n\nå°†`zip`å’Œ`Dict`ç»“åˆèµ·æ¥åˆ›å»ºå­—å…¸å¾ˆç®€æ´ï¼š\n\n~~~julia\njulia> d = Dict(zip(\"abc\", 1:3))\nDict{Char,Int64} with 3 entries:\n  'a' => 1\n  'c' => 3\n  'b' => 2\n~~~\n\n## Files\n\n### Reading and Writing\n\nä½¿ç”¨`w`æ¨¡å¼å¯¹æ–‡ä»¶è¿›è¡Œå†™ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨åˆ™æ¸…ç©ºä»¥å‰çš„å†…å®¹ï¼Œä¸å­˜åœ¨åˆ™é‡æ–°åˆ›å»ºä¸€ä¸ªã€‚\n\n~~~julia\njulia> fout = open(\"output.txt\", \"w\")\nIOStream(<file output.txt>)\n~~~\n\nå†™å…¥\n\n~~~julia\njulia> line1 = \"This here's the wattle,\\n\"\n\"This here's the wattle,\\n\"\n\njulia> write(fout, line1)\n24\n~~~\n\nè¿”å›çš„ä¸ºå†™å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ã€‚\n\nå½“å†™å…¥å®Œæ¯•åï¼Œè¦å…³é—­æ–‡ä»¶ï¼š\n\n~~~julia\njulia> close(fout)\n~~~\n\n### Filenames and Paths\n\n`pwd`è·å–å½“å‰è·¯å¾„ï¼Œ`abspath`è·å–æ–‡ä»¶æ‰€å¤„ç»å¯¹è·¯å¾„ï¼Œ`ispath`åˆ¤æ–­æ˜¯å¦ä¸ºè·¯å¾„ï¼Œ`isdir`åˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶å¤¹ï¼Œ`readdir`è¯»å–è·¯å¾„ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œè·¯å¾„ã€‚\n\n### Catching Exceptions\n\n~~~julia\ntry\n    fin = open(\"bad_file.txt\")\ncatch exc\n    println(\"Something went wrong: $exc\")\nfinally\n    println(\"finally\")\nend\n~~~\n\n### Serialization\n\nå‡½æ•°`serialize`å’Œ`deserialize`å¯ä»¥å°†ä»»ä½•ç±»å‹çš„å¯¹è±¡è½¬ä¸ºå­—èŠ‚æ•°ç»„ã€‚\n\n~~~julia\njulia> using Serialization\n\njulia> io = IOBuffer()\nIOBuffer(data=UInt8[...], readable=true, writable=true, seekable=true, append=false, size=0, maxsize=Inf, ptr=1, mark=-1)\n\njulia> t = [1,2,3];\n\njulia> serialize(io, t)\n24\n\njulia> print(take!(io))\nUInt8[0x37, 0x4a, 0x4c, 0x0f, 0x04, 0x00, 0x00, 0x00, 0x15, 0x00, 0x08, 0xe2, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]\n~~~\n\nè¾“å‡ºçš„ç±»å‹ä¸åˆ©äºæˆ‘ä»¬é˜…è¯»ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è½¬æ¢ä¸ºåŸæ¥çš„æ ¼å¼ï¼š\n\n~~~julia\njulia> io = IOBuffer();\n\njulia> t1 = [1, 2, 3];\n\njulia> serialize(io, t1)\n24\n\njulia> s = take!(io)\n36-element Vector{UInt8}: â€¦\n\njulia> t2 = deserialize(IOBuffer(s));\n\njulia> print(t2)\n[1, 2, 3]\n~~~\n\nå°½ç®¡æ–°çš„å¯¹è±¡å’ŒåŸå¯¹è±¡çš„å€¼ç›¸åŒï¼Œä½†æ˜¯å®ƒä»¬ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼š\n\n~~~julia\njulia> t1 == t2          \ntrue                     \n                         \njulia> t1 === t2         \nfalse                    \n~~~\n\n### Modules\n\nå¦‚æœä½ æœ‰ä¸€ä¸ªæ–‡ä»¶`wc.jl`ï¼Œå†…å®¹ä¸ºï¼š\n\n~~~julia\nfunction linecount(filename)\n    count = 0\n    for line in eachline(filename)\n        count += 1\n    end\n    count\nend\n\nprint(linecount(\"wc.jl\"))\n~~~\n\nå¦‚æœä½ è¿è¡Œæ­¤æ®µä»£ç ï¼Œå®ƒè¯»å–è‡ªå·±å¹¶è¾“å‡º$9$ã€‚\n\n~~~julia\njulia> include(\"wc.jl\")\n9\n~~~\n\n`Julia`å¼•å…¥äº†ä¸€äº›æ¨¡å—(module)æ¥åˆ›å»ºå•ç‹¬çš„å˜é‡å·¥ä½œåŒºï¼Œå³æ–°çš„å…¨å±€ä½œç”¨åŸŸã€‚`import`å…è®¸æ§åˆ¶æ¥è‡ªå…¶ä»–æ¨¡å—çš„å“ªäº›åç§°æ˜¯å¯è§çš„ï¼Œ`export`ç¡®å®šå“ªäº›åç§°æ˜¯å…¬å…±çš„ï¼Œå³å¯ä»¥åœ¨æ¨¡å—å¤–ä¸åŠ æ¨¡å—åç§°å‰ç¼€æ¥ä½¿ç”¨ã€‚\n\n~~~julia\nmodule LineCount\n    export linecount\n\n    function linecount(filename)\n        count = 0\n        for line in eachline(filename)\n            count += 1\n        end\n        count\n    end\nend\n~~~\n\nå°†ä¸Šè¿°æ–‡ä»¶ä¿å­˜ä¸º`LineCount.jl`ï¼Œä¹‹åè¿è¡Œ`push!(LOAD_PATH, \".\")`ï¼Œå°†å½“å‰ç›®å½•æ·»åŠ åˆ°å·¥ä½œè·¯å¾„ï¼Œ`.`è¡¨ç¤ºå½“å‰è·¯å¾„ã€‚ä¹‹å\n\n~~~julia\njulia> using LineCount\n\njulia> linecount(\"wc.jl\")\n11\n~~~\n\n## Structs and Objects\n\n### Composite Types\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡`struct`æ¥å®šä¹‰å¤åˆç±»å‹ï¼Œå¦‚å®šä¹‰`Point`ç±»å‹ï¼š\n\n~~~julia\nstruct Point\n    x\n    y\nend\njulia> p = Point(3.0, 4.0)\nPoint(3.0, 4.0)\n~~~\n\nè¿”å›å€¼æ˜¯å¯¹`Point`å¯¹è±¡çš„å¼•ç”¨ï¼Œæˆ‘ä»¬å°†å…¶èµ‹å€¼ç»™`p`ã€‚\n\n### Structs are Immutable\n\nä½ å¯ä»¥ä½¿ç”¨`.`ç¬¦å·æ¥è·å–å­—æ®µçš„å€¼ï¼š\n\n~~~julia\njulia> x = p.x\n3.0\njulia> p.y\n4.0\n~~~\n\n`struct`åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸å¯å˜çš„ï¼Œæ„é€ ä¹‹åå­—æ®µçš„å€¼ä¸å¯æ”¹å˜ï¼š\n\n~~~julia\njulia> p.y = 1.0\nERROR: setfield! immutable struct of type Point cannot be changed\n~~~\n\n### Mutable Structs\n\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨`mutate`å…³é”®å­—ä½¿`struct`å¯å˜ï¼š\n\n~~~julia\nmutable struct MPoint\n    x\n    y\nend\n\njulia> blank = MPoint(0.0, 0.0)\nMPoint(0.0, 0.0)\njulia> blank.x = 3.0\n3.0\njulia> blank.y = 4.0\n4.0\n~~~\n\n### Rectangles\n\næˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªçŸ©å½¢å¯¹è±¡ï¼Œå­—æ®µä¸ºä¸€ä¸ªç«¯ç‚¹çš„åæ ‡å’Œå®½åº¦å’Œé•¿åº¦ï¼š\n\n~~~julia\n\"\"\"\nRepresents a rectangle.\n\nfields: width, height, corner.\n\"\"\"\nstruct Rectangle\n    width\n    height\n    corner\nend\n\njulia> origin = MPoint(0.0, 0.0)\nMPoint(0.0, 0.0)\njulia> box = Rectangle(100.0, 200.0, origin)\nRectangle(100.0, 200.0, MPoint(0.0, 0.0))\n~~~\n\n\n\n### Instances as Arguments\n\nå®ä¾‹å¯ä»¥ä½œä¸ºå‚æ•°ï¼š\n\n~~~julia\nfunction printpoint(p)\n    println(\"($(p.x), $(p.y))\")\nend\n~~~\n\nå½“æŠŠä¸€ä¸ªå®ä¾‹ä¼ å…¥åˆ°å‡½æ•°ä¸­å»ï¼Œå‡½æ•°ä¼šæ”¹å˜å®ä¾‹çš„å­—æ®µå€¼ï¼š\n\n~~~julia\nfunction movepoint!(p, dx, dy)\n    p.x += dx\n    p.y += dy\n    nothing\nend\n\njulia> origin = MPoint(0.0, 0.0)\nMPoint(0.0, 0.0)\njulia> movepoint!(origin, 1.0, 2.0)\n\njulia> origin\nMPoint(1.0, 2.0)\n~~~\n\nä½†æ˜¯ï¼Œä½ å¯ä»¥ä¿®æ”¹ä¸å¯å˜å¯¹è±¡çš„å¯å˜å±æ€§çš„å€¼ï¼Œå¦‚ï¼š\n\n~~~julia\nfunction moverectangle!(rect, dx, dy)\n  movepoint!(rect.corner, dx, dy)\nend\n\njulia> box\nRectangle(100.0, 200.0, MPoint(0.0, 0.0))\njulia> moverectangle!(box, 1.0, 2.0)\n\njulia> box\nRectangle(100.0, 200.0, MPoint(1.0, 2.0))\n~~~\n\n### Instances as Return Values\n\n~~~julia\nfunction findcenter(rect)\n    Point(rect.corner.x + rect.width / 2, rect.corner.y + rect.height / 2)\nend\n~~~\n\n### Copying\n\n`Julia`å†…å»ºå‡½æ•°`deepcopy`å¯ä»¥å¤åˆ¶ä»»ä½•å¯¹è±¡ï¼š\n\n~~~julia\njulia> p1 = MPoint(3.0, 4.0)\nMPoint(3.0, 4.0)\njulia> p2 = deepcopy(p1)\nMPoint(3.0, 4.0)\njulia> p1 â‰¡ p2\nfalse\njulia> p1 == p2\nfalse\n~~~\n\n`â‰¡`çš„ç»“æœæˆ‘ä»¬åº”è¯¥èƒ½æ¥å—ï¼Œå› ä¸ºæ˜¯ä¸åŒçš„å¯¹è±¡ï¼Œä½†æ˜¯`==`çš„ç»“æœæˆ‘ä»¬å¯èƒ½æ— æ³•æ¥å—ï¼Œå› ä¸ºä¸¤ä¸ªå¯¹è±¡çš„å€¼æ˜¯ç›¸åŒçš„ï¼Œè¿™æ˜¯å› ä¸ºåœ¨`Julia`ä¸­å¯å˜å¤åˆç±»å‹`mutate`ï¼Œ`Julia`ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ç­‰ä»·çš„ã€‚\n\nè€Œåœ¨ä¸å¯å˜å¤åˆç±»å‹ä¸­ç›¸åï¼š\n\n~~~julia\njulia> p1 = Point(1,2)\nPoint(1, 2)\n\njulia> p2 = deepcopy(p1)\nPoint(1, 2)\n\njulia> p1==p2\ntrue\n\njulia> p1===p2\ntrue\n~~~\n\nå› ä¸ºæˆ‘ä»¬ä¸ä¼šæ”¹å˜`p1`ï¼Œæ‰€ä»¥å¤åˆ¶ä¹Ÿå°±æ²¡æ„ä¹‰ã€‚\n\n### Debugging\n\nåˆ¤æ–­`p`æ˜¯å¦ä¸º`Point`ç±»å‹ï¼š\n\n~~~julia\njulia> p isa Point\ntrue\n~~~\n\næŸ¥çœ‹`Point`ç±»å‹çš„å­—æ®µï¼š\n\n~~~julia\njulia> fieldnames(Point)\n(:x, :y)\n~~~\n\næˆ–è€…ä½¿ç”¨ï¼š\n\n~~~julia\njulia> isdefined(p, :x)\ntrue\njulia> isdefined(p, :z)\nfalse\n~~~\n\n## Structs and Functions\n\n### Time\n\næˆ‘ä»¬æ„å»ºæ—¶é—´ç±»ï¼š\n\n~~~julia\n\"\"\"\nRepresents the time of day.\n\nfields: hour, minute, second\n\"\"\"\nstruct MyTime\n    hour\n    minute\n    second\nend\n~~~\n\n~~~julia\njulia> time = MyTime(11, 59, 30)\nMyTime(11, 59, 30)\n~~~\n\n### Pure Functions\n\nä¸‹é¢æ˜¯ä¸¤ä¸ªæ—¶é—´ç›¸åŠ çš„ç®€å•åŸå‹ï¼š\n\n~~~julia\nfunction addtime(t1, t2)\n    MyTime(t1.hour + t2.hour, t1.minute + t2.minute, t1.second + t2.second)\nend\n~~~\n\nä¸Šé¢å‡½æ•°è¢«ç§°ä¸ºçº¯å‡½æ•°ï¼Œå› ä¸ºå®ƒå¹¶æ²¡æœ‰æ”¹å˜ä¼ å…¥çš„ä¸¤ä¸ªå¯¹è±¡çš„å€¼ã€‚\n\n~~~julia\njulia> start = MyTime(9, 45, 0);\n\njulia> duration = MyTime(1, 35, 0);\n\njulia> done = addtime(start, duration);\n\njulia> printtime(done)\n10:80:00\n~~~\n\nå‡ºç°äº†$80$åˆ†é’Ÿï¼Œè¿™ä¸æˆ‘ä»¬çš„å¸¸è¯†ä¸åŒï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ æ–°çš„è§„åˆ™\n\n~~~julia\nfunction addtime(t1, t2)\n    second = t1.second + t2.second\n    minute = t1.minute + t2.minute\n    hour = t1.hour + t2.hour\n    if second >= 60\n        second -= 60\n        minute += 1\n    end\n    if minute >= 60\n        minute -= 60\n        hour += 1\n    end\n    MyTime(hour, minute, second)\nend\n~~~\n\n### Modifiers\n\n~~~julia\nfunction increment!(time, seconds)\n    time.second += seconds\n    if time.second >= 60\n        time.second -= 60\n        time.minute += 1\n    end\n    if time.minute >= 60\n        time.minute -= 60\n        time.hour += 1\n    end\nend\n~~~\n\nä¸Šé¢å®šä¹‰çš„å‡½æ•°ä¼šæ”¹å˜ä¼ å…¥çš„å‚æ•°å€¼ï¼Œæˆ‘ä»¬ç§°å…¶ä¸º`Modifiers`ã€‚\n\n##  Multiple Dispatch\n\nåœ¨`Julia`ä¸­ï¼Œä½ å¯ä»¥å†™åœ¨ä¸åŒç±»å‹ä¸Šè¿è¡Œçš„ä»£ç ï¼Œè¿™è¢«ç§°ä¸ºæ³›å‹ç¼–ç¨‹ã€‚\n\n### Type Declarations\n\nè¿ç®—ç¬¦`::`å°†ç±»å‹æ³¨é‡Šé™„åŠ åˆ°è¡¨è¾¾å¼å’Œå˜é‡ï¼š\n\n~~~julia\njulia> (1 + 2) :: Float64\nERROR: TypeError: in typeassert, expected Float64, got Int64\njulia> (1 + 2) :: Int64\n3\n~~~\n\nè¿™å¸®åŠ©ç¡®è®¤ä½ çš„ç¨‹åºæŒ‰ç…§ä½ æœŸæœ›çš„æ–¹å¼è¿›è¡Œã€‚\n\n`::`è¿ç®—ç¬¦ä¹Ÿå¯ä»¥æ·»åŠ åˆ°èµ‹å€¼è¯­å¥çš„å·¦è¾¹ï¼Œä½œä¸ºå£°æ˜çš„ä¸€éƒ¨åˆ†ï¼š\n\n~~~julia\njulia> function returnfloat()\n           x::Float64 = 100\n           x\n       end\nreturnfloat (generic function with 1 method)\njulia> x = returnfloat()\n100.0\njulia> typeof(x)\nFloat64\n~~~\n\nä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°å®šä¹‰çš„ä¸€éƒ¨åˆ†ï¼š\n\n~~~julia\nfunction sinc(x)::Float64\n    if x == 0\n        return 1\n    end\n    sin(x)/(x)\nend\n~~~\n\n### Methods\n\næ–¹æ³•æ˜¯å…·æœ‰ç‰¹å®šç‰¹å¾çš„å‡½æ•°ï¼š\n\n~~~julia\nusing Printf\n\nstruct MyTime\n    hour :: Int64\n    minute :: Int64\n    second :: Int64\nend\n\nfunction printtime(time::MyTime)\n    @printf(\"%02d:%02d:%02d\", time.hour, time.minute, time.second)\nend\n~~~\n\nä¸Šé¢çš„å‡½æ•°å®šä¹‰äº†è¾“å…¥çš„æ•°æ®ç±»å‹ï¼Œä¸ºæ–¹æ³•ã€‚\n\n### Constructors\n\næ„é€ æ˜¯ç”¨æ¥åˆ›å»ºå¯¹è±¡çš„ä¸€ç±»ç‰¹æ®Šçš„å‡½æ•°ã€‚`MyTime`çš„é»˜è®¤æ„é€ å‡½æ•°æ–¹æ³•æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š\n\n~~~julia\nMyTime(hour, minute, second) # é»˜è®¤æ„é€ å‡½æ•°\nMyTime(hour::Int64, minute::Int64, second::Int64)\n~~~\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ è‡ªå·±çš„å¤–éƒ¨æ„å»ºæ–¹æ³•ï¼š\n\n~~~julia\nfunction MyTime(time::MyTime)\n    MyTime(time.hour, time.minute, time.second)\nend\n~~~\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥æ„å»ºå†…éƒ¨æ„é€ å‡½æ•°ï¼š\n\n~~~julia\nstruct MyTime\n    hour :: Int64\n    minute :: Int64\n    second :: Int64\n    function MyTime(hour::Int64=0, minute::Int64=0, second::Int64=0)\n        @assert(0 â‰¤ minute < 60, \"Minute is not between 0 and 60.\")\n        @assert(0 â‰¤ second < 60, \"Second is not between 0 and 60.\")\n        new(hour, minute, second)\n    end\nend\n~~~\n\nç°åœ¨ç»“æ„`MyTime`æœ‰$4$ä¸ªå†…éƒ¨æ„é€ æ–¹æ³•ï¼š\n\n~~~julia\nMyTime()\nMyTime(hour::Int64)\nMyTime(hour::Int64, minute::Int64)\nMyTime(hour::Int64, minute::Int64, second::Int64)\n~~~\n\n> å†…éƒ¨æ„é€ å‡½æ•°ä¼šè¦†ç›–é»˜è®¤æ„é€ å‡½æ•°ã€‚\n\nå†…éƒ¨æ„é€ å‡½æ•°æ€»æ˜¯å®šä¹‰åœ¨ç»“æ„çš„å†…éƒ¨ï¼Œä¸”èƒ½ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šå‡½æ•°`new`æ¥åˆ›å»ºæœ€æ–°å®šä¹‰çš„ç±»å‹çš„å¯¹è±¡ã€‚\n\nå¦ä¸€ç§ä¸ä½¿ç”¨`new`å‡½æ•°çš„å‚æ•°çš„æ–¹æ³•ä¸ºï¼š\n\n~~~julia\nmutable struct MyTime\n    hour :: Int\n    minute :: Int\n    second :: Int\n    function MyTime(hour::Int64=0, minute::Int64=0, second::Int64=0)\n        @assert(0 â‰¤ minute < 60, \"Minute is between 0 and 60.\")\n        @assert(0 â‰¤ second < 60, \"Second is between 0 and 60.\")\n        time = new()\n        time.hour = hour\n        time.minute = minute\n        time.second = second\n        time\n    end\nend\n~~~\n\nä½†æ˜¯è¿™æ ·æ•°æ®ç»“æ„å¿…é¡»æ˜¯å¯å˜çš„ã€‚\n\n### `show`\n\n`show`å‡½æ•°æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œè¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚\n\n~~~julia\nusing Printf\n\nfunction Base.show(io::IO, time::MyTime)\n    @printf(io, \"%02d:%02d:%02d\", time.hour, time.minute, time.second)\nend\n~~~\n\nåœ¨è¿™é‡Œå‰ç¼€`Base`æ˜¯éœ€è¦çš„å› ä¸ºæˆ‘ä»¬åˆ›å»ºäº†`Base.show`å‡½æ•°çš„æ–°æ–¹æ³•ã€‚\n\n~~~julia\njulia> time = MyTime(9, 45)\n09:45:00\n~~~\n\n### Operator Overloading\n\né€šè¿‡å®šä¹‰ç¬¦å·æ–¹æ³•ï¼Œä½ å¯ä»¥å®šä¹‰åœ¨å®šä¹‰çš„ç±»å‹ä¸Šçš„ç¬¦å·çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼š\n\n~~~julia\nimport Base.+\n\nfunction +(t1::MyTime, t2::MyTime)\n    seconds = timetoint(t1) + timetoint(t2)\n    inttotime(seconds)\nend\n\njulia> start = MyTime(9, 45)\n09:45:00\njulia> duration = MyTime(1, 35, 0)\n01:35:00\njulia> start + duration\n11:20:00\n~~~\n\n### Multiple Dispatch\n\nåœ¨ä¸Šé¢æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ª`MyTime`ç±»å‹ç›¸åŠ ï¼Œä½†æ˜¯ä½ å¯èƒ½ä¹Ÿæƒ³æ•´æ•°å’Œ`Mytime`ç±»å‹ç›¸åŠ ï¼š\n\n~~~julia\nfunction +(time::MyTime, seconds::Int64)\n    increment(time, seconds)\nend\n\njulia> start = MyTime(9, 45)\n09:45:00\njulia> start + 1337\n10:07:17\n~~~\n\nç›¸åŠ æ˜¯å¯äº¤æ¢çš„ï¼Œå› æ­¤æˆ‘ä»¬å®šä¹‰\n\n~~~julia\nfunction +(seconds::Int64, time::MyTime)\n  time + seconds\nend\n\njulia> 1337 + start\n10:07:17\n~~~\n\nå½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶å†³å®šä½¿ç”¨å“ªä¸ªæ–¹æ³•çš„å†³å®šè¢«ç§°ä¸ºåˆ†æ´¾ã€‚\n\n### Generic Programming\n\nå¤šåˆ†æ´¾åœ¨å¿…è¦æ—¶å¾ˆæœ‰ç”¨ï¼Œä½†(å¹¸è¿çš„æ˜¯)å¹¶ä¸æ€»æ˜¯å¿…è¦çš„ã€‚é€šå¸¸ï¼Œæ‚¨å¯ä»¥é€šè¿‡ç¼–å†™å¯¹ä¸åŒç±»å‹çš„å‚æ•°æ­£ç¡®å·¥ä½œçš„å‡½æ•°æ¥é¿å…è¿™ç§æƒ…å†µã€‚\n\nå¦‚ä¸‹é¢çš„å‡½æ•°ä¸ä»…å¯ä»¥å¯¹å­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å¯¹å…¶ä»–åºåˆ—ç±»å‹çš„æ•°æ®ä½¿ç”¨ï¼š\n\n~~~julia\nfunction histogram(s)\n    d = Dict()\n    for c in s\n        if c âˆ‰ keys(d)\n            d[c] = 1\n        else\n            d[c] += 1\n        end\n    end\n    d\nend\n\njulia> t = (\"spam\", \"egg\", \"spam\", \"spam\", \"bacon\", \"spam\")\n(\"spam\", \"egg\", \"spam\", \"spam\", \"bacon\", \"spam\")\njulia> histogram(t)\nDict{Any,Any} with 3 entries:\n  \"bacon\" => 1\n  \"spam\"  => 4\n  \"egg\"   => 1\n~~~\n\nä½¿ç”¨å¤šç§ç±»å‹çš„å‡½æ•°ç§°ä¸ºå¤šæ€å‡½æ•°ã€‚å¤šæ€å¯ä»¥ä¿ƒè¿›ä»£ç é‡ç”¨ã€‚\n\n## Subtyping\n\n### Cards\n\nå‡è®¾æˆ‘ä»¬æœ‰ä¸€å‰¯æ‰‘å…‹ç‰Œï¼Œæˆ‘ä»¬æƒ³æ¯”è¾ƒå…¶å¤§å°ï¼Œæ ¹æ®èŠ±è‰²å’Œæ•°å­—ï¼Œå…ˆå®šä¹‰å¡ç‰Œç±»ï¼š\n\n~~~julia\nstruct Card\n    suit :: Int64\n    rank :: Int64\n    function Card(suit::Int64, rank::Int64)\n        @assert(1 â‰¤ suit â‰¤ 4, \"suit is not between 1 and 4\")\n        @assert(1 â‰¤ rank â‰¤ 13, \"rank is not between 1 and 13\")\n        new(suit, rank)\n    end\nend\n~~~\n\n### Global Variables\n\nå®šä¹‰å¯¹åº”çš„å…¨å±€å˜é‡æ¥ä¸€ä¸€å¯¹åº”èŠ±è‰²å’Œæ•°ç»„ï¼š\n\n~~~julia\nconst suit_names = [\"â™£\", \"â™¦\", \"â™¥\", \"â™ \"]\nconst rank_names = [\"A\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"J\", \"Q\", \"K\"]\n\n\nfunction Base.show(io::IO, card::Card)\n    print(io, rank_names[card.rank], suit_names[card.suit])\nend\n\njulia> Card(3, 11)\nJâ™¥\n~~~\n\n### Comparing Cards\n\n~~~julia\nimport Base.<\n\nfunction <(c1::Card, c2::Card)\n    (c1.suit, c1.rank) < (c2.suit, c2.rank)\nend\n~~~\n\n### Decks\n\n~~~julia\nstruct Deck\n    cards :: Array{Card, 1}\nend\n\nfunction Deck()\n    deck = Deck(Card[])\n    for suit in 1:4\n        for rank in 1:13\n            push!(deck.cards, Card(suit, rank))\n        end\n    end\n    deck\nend\n\nfunction Base.show(io::IO, deck::Deck)\n    for card in deck.cards\n        print(io, card, \" \")\n    end\n    println()\nend\n\njulia> Deck()\nAâ™£ 2â™£ 3â™£ 4â™£ 5â™£ 6â™£ 7â™£ 8â™£ 9â™£ 10â™£ Jâ™£ Qâ™£ Kâ™£ Aâ™¦ 2â™¦ 3â™¦ 4â™¦ 5â™¦ 6â™¦ 7â™¦ 8â™¦ 9â™¦ 10â™¦ Jâ™¦ Qâ™¦ Kâ™¦ Aâ™¥ 2â™¥ 3â™¥ 4â™¥ 5â™¥ 6â™¥ 7â™¥ 8â™¥ 9â™¥ 10â™¥ Jâ™¥ Qâ™¥ Kâ™¥ Aâ™  2â™  3â™  4â™  5â™  6â™  7â™  8â™  9â™  10â™  Jâ™  Qâ™  Kâ™ \n~~~\n\n### Add, Remove, Shuffle and Sort\n\n~~~julia\nfunction Base.pop!(deck::Deck)\n    pop!(deck.cards)\nend\n\nfunction Base.push!(deck::Deck, card::Card)\n    push!(deck.cards, card)\n    deck\nend\n\nusing Random\n\nfunction Random.shuffle!(deck::Deck)\n    shuffle!(deck.cards)\n    deck\nend\n~~~\n\n\n\n### Abstract Types and Subtyping\n\nç°åœ¨æˆ‘ä»¬æƒ³è¦å®šä¹‰æ‰‹(hand)çš„ç±»å‹ï¼Œå…¶ä¸Decksç±»å‹å¤§è‡´ç›¸åŒï¼Œå› æ­¤æˆ‘ä»¬å…ˆå®šä¹‰æŠ½è±¡ç±»å‹ï¼š\n\n~~~julia\nabstract type CardSet end\n~~~\n\nåœ¨ç±»å‹åå¯ä»¥ä½¿ç”¨`<:`æ¥æŒ‡å®šå…¶ä¸ºè°çš„å­ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸º`Any`çš„å­ç±»å‹ã€‚\n\næˆ‘ä»¬å¯ä»¥æŒ‡å®š`Deck`ä¸º`CardSet`çš„å­ç±»\n\n~~~julia\nstruct Deck <: CardSet\n    cards :: Array{Card, 1}\nend\n\nfunction Deck()\n    deck = Deck(Card[])\n    for suit in 1:4\n        for rank in 1:13\n            push!(deck.cards, Card(suit, rank))\n        end\n    end\n    deck\nend\n~~~\n\n~~~julia\nstruct Hand <: CardSet\n    cards :: Array{Card, 1}\n    label :: String\nend\n\nfunction Hand(label::String=\"\")\n    Hand(Card[], label)\nend\n~~~\n\n\n\n~~~julia\njulia> deck = Deck();\n\njulia> deck isa CardSet\ntrue\n~~~\n\n### Abstract Types and Functions\n\næˆ‘ä»¬ç°åœ¨å¯ä»¥ç»™æŠ½è±¡ç±»å‹å®šä¹‰å‡½æ•°ï¼š\n\n~~~julia\nfunction Base.show(io::IO, cs::CardSet)\n    for card in cs.cards\n        print(io, card, \" \")\n    end\nend\n\nfunction Base.pop!(cs::CardSet)\n    pop!(cs.cards)\nend\n\nfunction Base.push!(cs::CardSet, card::Card)\n    push!(cs.cards, card)\n    nothing\nend\n~~~\n\n\n\n~~~julia\njulia> deck = Deck()\nAâ™£ 2â™£ 3â™£ 4â™£ 5â™£ 6â™£ 7â™£ 8â™£ 9â™£ 10â™£ Jâ™£ Qâ™£ Kâ™£ Aâ™¦ 2â™¦ 3â™¦ 4â™¦ 5â™¦ 6â™¦ 7â™¦ 8â™¦ 9â™¦ 10â™¦ Jâ™¦ Qâ™¦ Kâ™¦ Aâ™¥ 2â™¥ 3â™¥ 4â™¥ 5â™¥ 6â™¥ 7â™¥ 8â™¥ 9â™¥ 10â™¥ Jâ™¥ Qâ™¥ Kâ™¥ Aâ™  2â™  3â™  4â™  5â™  6â™  7â™  8â™  9â™  10â™  Jâ™  Qâ™  Kâ™ \njulia> shuffle!(deck)\nJâ™¦ 10â™£ 8â™  9â™¥ 5â™  7â™£ 6â™¦ Aâ™  Jâ™£ 7â™  5â™¦ 10â™¥ 3â™¦ 9â™¦ 9â™£ 4â™£ 8â™¦ 8â™¥ 5â™£ Aâ™¥ Kâ™¥ Kâ™¦ Kâ™  4â™¦ Aâ™¦ Qâ™¥ 6â™  2â™¦ 6â™¥ 2â™£ 10â™  3â™¥ 2â™¥ Jâ™¥ Qâ™£ 5â™¥ 2â™  9â™  10â™¦ Qâ™  3â™  8â™£ Kâ™£ 7â™¥ 3â™£ Jâ™  4â™¥ 6â™£ 7â™¦ 4â™  Aâ™£ Qâ™¦\njulia> card = pop!(deck)\nQâ™¦\njulia> push!(hand, card)\n~~~\n\n## The Goodies: Syntax\n\n### Named Tuples\n\n~~~julia\njulia> x = (a=1, b=1+1)\n(a = 1, b = 2)\njulia> x.a\n1\n~~~\n\n### Functions\n\nå¯ä»¥ä»¥ç´§å‡‘å½¢å¼å®šä¹‰å‡½æ•°ï¼š\n\n~~~julia\njulia> f(x,y) = x + y\nf (generic function with 1 method)\n~~~\n\n#### Anonymous Functions\n\næˆ‘ä»¬å¯ä»¥å®šä¹‰æ²¡æœ‰åå­—çš„å‡½æ•°ï¼š\n\n~~~julia\njulia> x -> x^2 + 2x - 1\n#1 (generic function with 1 method)\njulia> function (x)\n           x^2 + 2x - 1\n       end\n#3 (generic function with 1 method)\n~~~\n\nåŒ¿åå‡½æ•°é€šå¸¸æ˜¯å…¶ä»–å‡½æ•°çš„å‚æ•°ï¼š\n\n~~~julia\njulia> using Plots\n\njulia> plot(x -> x^2 + 2x - 1, 0, 10, xlabel=\"x\", ylabel=\"y\")\n~~~\n\n#### Keyword Arguments\n\nå‡½æ•°å‚æ•°å¯ä»¥å‘½åï¼š\n\n~~~julia\njulia> function myplot(x, y; style=\"solid\", width=1, color=\"black\")\n           ###\n       end\nmyplot (generic function with 1 method)\njulia> myplot(0:10, 0:10, style=\"dotted\", color=\"blue\")\n~~~\n\nå…³é”®å­—å‚æ•°ç”¨`;`éš”å¼€ï¼Œä½†è°ƒç”¨çš„æ—¶å€™å¯ä»¥ä½¿ç”¨`,`ã€‚\n\n#### Closures\n\n`closure`æ˜¯å…è®¸å‡½æ•°è·å–åœ¨å‡½æ•°èŒƒå›´ä¹‹å¤–çš„å˜é‡çš„æ–¹æ³•ï¼š\n\n~~~julia\njulia> foo(x) = ()->x\nfoo (generic function with 1 method)\n\njulia> bar = foo(1)\n#1 (generic function with 1 method)\n\njulia> bar()\n1\n~~~\n\n### Blocks\n\nå—æ˜¯ä¸€ç§å°†è®¸å¤šè¯­å¥åˆ†ç»„çš„æ–¹æ³•ã€‚\n\n~~~julia\nğŸ¢ = Turtle()\n@svg begin\n    forward(ğŸ¢, 100)\n    turn(ğŸ¢, -90)\n    forward(ğŸ¢, 100)\nend\n~~~\n\n#### `let` Blocks\n\n~~~julia\njulia> x, y, z = -1, -1, -1;\n\njulia> let x = 1, z\n           @show x y z;\n       end\nx = 1\ny = -1\nERROR: UndefVarError: z not defined\njulia> @show x y z;\nx = -1\ny = -1\nz = -1\n~~~\n\nåœ¨ç¬¬ä¸€ä¸ª`let`ä¸­ï¼Œ`@show`æ‰“å°å±€éƒ¨å˜é‡`x,z`ï¼Œæ‰“å°å…¨å±€å˜é‡`y`ï¼Œå…¨å±€å˜é‡`x,y,z`å¹¶æœªå—å½±å“ã€‚\n\n#### `do` Blocks\n\n~~~julia\njulia> data = \"This here's the wattle,\\nthe emblem of our land.\\n\"\n\"This here's the wattle,\\nthe emblem of our land.\\n\"\njulia> open(\"output.txt\", \"w\") do fout\n           write(fout, data)\n       end\n48\n~~~\n\nè¿™é‡Œ`fout`ä¸ºæ–‡ä»¶æµï¼Œæˆ‘ä»¬ä¸å†éœ€è¦æ‰‹åŠ¨å…³é—­`fout`ã€‚\n\nè¿™åœ¨å‡½æ•°ä¸Šç­‰ä»·äº\n\n~~~julia\njulia> f = fout -> begin\n           write(fout, data)\n       end\n#3 (generic function with 1 method)\njulia> open(f, \"output.txt\", \"w\")\n48\n~~~\n\nåŒ¿åå‡½æ•°å¸¸è¢«ç”¨ä¸º`open`çš„å‚æ•°ï¼š\n\n~~~julia\nfunction open(f::Function, args...)\n    io = open(args...)\n    try\n        f(io)\n    finally\n        close(io)\n    end\nend\n~~~\n\ndoå—å¯ä»¥ä»å®ƒçš„å°é—­ä½œç”¨åŸŸæ•è·å˜é‡ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢`openâ€¦do`ä¾‹å­ä¸­çš„å˜é‡`data`æ˜¯ä»å¤–éƒ¨ä½œç”¨åŸŸæ•è·çš„ã€‚\n\n### Control Flow\n\n#### Ternary Operator\n\n~~~julia\njulia> a = 150\n150\njulia> a % 2 == 0 ? println(\"even\") : println(\"odd\")\neven\n~~~\n\n#### Short-Circuit Evaluation\n\n`&&`å’Œ`||`æ˜¯çŸ­è·¯è¿ç®—ç¬¦ï¼Œå½“å‰ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼å¯ä»¥ç¡®å®šç»“æœæ˜¯å¦ä¸€ä¸ªå°±ä¸éœ€è¦è®¡ç®—äº†ã€‚\n\n#### Tasks (aka Coroutines)\n\nä»»åŠ¡æ˜¯ä¸€ç§èƒ½å¤Ÿä¼ é€’ååŒæ§åˆ¶è€Œä¸è¿”å›çš„æ§åˆ¶ç»“æ„ã€‚åœ¨Juliaä¸­ï¼Œä»»åŠ¡å¯ä»¥ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¸º`Channel`å¯¹è±¡çš„å‡½æ•°æ¥å®ç°ã€‚é€šé“ç”¨äºå°†å€¼ä»å‡½æ•°ä¼ é€’ç»™è¢«è°ƒç”¨æ–¹ã€‚\n\n~~~julia\nfunction fib(c::Channel)\n    a = 0\n    b = 1\n    put!(c, a)\n    while true\n        put!(c, b)\n        (a, b) = (b, a+b)\n    end\nend\n~~~\n\n`take!`å¯ä»¥ä»é€šé“ä¸­å–å€¼ï¼š\n\n~~~julia\njulia> fib_gen = Channel(fib);\n\njulia> take!(fib_gen)\n0\njulia> take!(fib_gen)\n1\njulia> take!(fib_gen)\n1\njulia> take!(fib_gen)\n2\njulia> take!(fib_gen)\n3\n~~~\n\né€šé“ä¹Ÿå¯ä»¥ä½œä¸ºè¿­ä»£å¯¹è±¡\n\n~~~julia\njulia> for val in Channel(fib)\n           print(val, \" \")\n           val > 20 && break\n       end\n0 1 1 2 3 5 8 13 21\n~~~\n\n### Types\n\n#### Primitive Types\n\nåœ¨`Julia`ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰è‡ªå·±çš„åŸå§‹ç±»å‹ï¼Œæ ‡å‡†åŸå§‹ç±»å‹ä¹Ÿç”¨åŒæ ·çš„æ–¹æ³•å®šä¹‰ï¼š\n\n~~~julia\nprimitive type Float64 <: AbstractFloat 64 end\nprimitive type Bool <: Integer 8 end\nprimitive type Char <: AbstractChar 32 end\nprimitive type Int64 <: Signed 64 end\n~~~\n\nåˆ›å»º`Byte`åŸå§‹ç±»å‹å’Œå…¶æ„é€ å‡½æ•°ï¼š\n\n~~~julia\njulia> primitive type Byte 8 end\n\njulia> Byte(val::UInt8) = reinterpret(Byte, val)\nByte\njulia> b = Byte(0x01)\nByte(0x01)\n~~~\n\n`reinterpret`å‡½æ•°ç”¨äºå­˜å‚¨ä¸€ä¸ª8ä½çš„æ— ç¬¦å·æ•´æ•°çš„ä½åˆ°å­—èŠ‚ä¸­ã€‚\n\n#### Parametric Types\n\n`Julia`çš„ç±»å‹æ˜¯å‚æ•°çš„ï¼Œè¯´æ˜å…¶ç±»å‹å¯ä»¥å¸¦å‚æ•°ã€‚\n\n~~~julia\nstruct Point{T<:Real}\n    x::T\n    y::T\nend\n~~~\n\n#### Type Unions\n\n~~~julia\njulia> IntOrString = Union{Int64, String}\nUnion{Int64, String}\njulia> 150 :: IntOrString\n150\njulia> \"Julia\" :: IntOrString\n\"Julia\"\n~~~\n\n\n\nç±»å‹è”åˆåœ¨å¤§å¤šæ•°è®¡ç®—æœºè¯­è¨€ä¸­æ˜¯å¯¹ç±»å‹è¿›è¡Œæ¨ç†çš„å†…éƒ¨æ„é€ ã€‚ç„¶è€Œï¼Œ`Julia`å‘ç”¨æˆ·å…¬å¼€äº†è¯¥ç‰¹æ€§ï¼Œå› ä¸ºå½“ç±»å‹è”åˆåªæœ‰å°‘é‡ç±»å‹æ—¶ï¼Œå¯ä»¥ç”Ÿæˆæœ‰æ•ˆçš„ä»£ç ã€‚è¿™ä¸ªç‰¹æ€§ä¸º`Julia`ç¨‹åºå‘˜æ§åˆ¶è°ƒåº¦æä¾›äº†æå¤§çš„çµæ´»æ€§ã€‚\n\n### Methods\n\n#### Parametric Methods\n\næ–¹æ³•å®šä¹‰ä¹Ÿå¯ä»¥å«æœ‰å‚æ•°çš„ç±»å‹å‚æ•°ï¼š\n\n~~~julia\njulia> isintpoint(p::Point{T}) where {T} = (T === Int64)\nisintpoint (generic function with 1 method)\njulia> p = Point(1, 2)\nPoint{Int64}(1, 2)\njulia> isintpoint(p)\ntrue\n~~~\n\n#### Function-like Objects\n\n`Julia`ä¸­çš„ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥è¢«è°ƒç”¨ï¼Œè¿™ç§å¯ä»¥è¢«è°ƒç”¨çš„å¯¹è±¡è¢«ç§°ä¸º`functors`ï¼š\n\n~~~julia\nstruct Polynomial{R}\n    coeff::Vector{R}\nend\n\nfunction (p::Polynomial)(x)\n    val = p.coeff[end]\n    for coeff in p.coeff[end-1:-1:1]\n        val = val * x + coeff\n    end\n    val\nend\n~~~\n\nå»è®¡ç®—å¤šé¡¹å¼ï¼Œæˆ‘ä»¬ç®€å•è°ƒç”¨å®ƒï¼š\n\n~~~julia\njulia> p = Polynomial([1,10,100])\nPolynomial{Int64}([1, 10, 100])\njulia> p(3)\n931\n~~~\n\n### Constructors\n\nå‚æ•°ç±»å‹å¯ä»¥æ˜¾å¼æˆ–éšå¼æ„é€ \n\n~~~julia\njulia> Point(1,2)         # implicit T\nPoint{Int64}(1, 2)\njulia> Point{Int64}(1, 2) # explicit T\nPoint{Int64}(1, 2)\njulia> Point(1,2.5)       # implicit T\nERROR: MethodError: no method matching Point(::Int64, ::Float64)\n~~~\n\nä¸ºæ¯ä¸ª`T`ç”Ÿæˆé»˜è®¤çš„å†…éƒ¨å’Œå¤–éƒ¨æ„é€ å‡½æ•°ï¼š\n\n~~~julia\nstruct Point{T<:Real}\n    x::T\n    y::T\n    Point{T}(x,y) where {T<:Real} = new(x,y)\nend\n\nPoint(x::T, y::T) where {T<:Real} = Point{T}(x,y);\n~~~\n\nå¹¶ä¸”æ¯ä¸€ä¸ª`x`å’Œ`y`çš„ç±»å‹éƒ½ç›¸åŒã€‚\n\nå½“ç±»å‹ä¸åŒæ—¶å¯ä»¥ï¼š\n\n~~~julia\nPoint(x::Real, y::Real) = Point(promote(x,y)...);\n~~~\n\n### Conversion and Promotion\n\n#### Conversion\n\næ•°æ®å¯ä»¥ä»ä¸€ä¸ªç±»å‹è½¬ä¸ºå¦ä¸€ä¸ªç±»å‹ï¼š\n\n~~~julia\njulia> x = 12\n12\njulia> typeof(x)\nInt64\njulia> convert(UInt8, x)\n0x0c\njulia> typeof(ans)\nUInt8\n~~~\n\næˆ‘ä»¬å¯ä»¥å¢åŠ è‡ªå·±çš„`convert`æ–¹æ³•ï¼š\n\n~~~julia\njulia> Base.convert(::Type{Point{T}}, x::Array{T, 1}) where {T<:Real} = Point(x...)\n\njulia> convert(Point{Int64}, [1, 2])\nPoint{Int64}(1, 2)\n~~~\n\n#### Promotion\n\n`Promotion`æ˜¯å°†æ··åˆç±»å‹çš„å€¼è½¬æ¢ä¸ºå•ä¸€å…¬å…±ç±»å‹ï¼š\n\n~~~julia\njulia> promote(1, 2.5, 3)\n(1.0, 2.5, 3.0)\n~~~\n\n### Metaprogramming\n\n`Julia`ä»£ç å¯ä»¥è¡¨ç¤ºä¸ºè¯­è¨€æœ¬èº«çš„æ•°æ®ç»“æ„ã€‚è¿™å…è®¸ç¨‹åºè½¬æ¢å’Œç”Ÿæˆè‡ªå·±çš„ä»£ç ã€‚\n\n#### Expressions\n\næ¯ä¸€ä¸ª`Julia`ç¨‹åºå¼€å§‹éƒ½ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼š\n\n~~~julia\njulia> prog = \"1 + 2\"\n\"1 + 2\"\n~~~\n\nä¸‹ä¸€æ­¥æ˜¯å°†æ¯ä¸ªå­—ç¬¦ä¸²è§£æä¸ºä¸€ä¸ªåä¸ºè¡¨è¾¾å¼çš„å¯¹è±¡ï¼Œè¡¨è¾¾å¼ç”±`Julia`ç±»å‹`Expr`è¡¨ç¤ºï¼š\n\n~~~julia\njulia> ex = Meta.parse(prog)\n:(1 + 2)\njulia> typeof(ex)\nExpr\njulia> dump(ex)\nExpr\n  head: Symbol call\n  args: Array{Any}((3,))\n    1: Symbol +\n    2: Int64 1\n    3: Int64 2\n~~~\n\n`dump`å‡½æ•°æ˜¾ç¤ºå¸¦æœ‰æ³¨é‡Šçš„`expr`å¯¹è±¡ã€‚\n\nè¡¨è¾¾å¼å¯ä»¥ç”±`:()`æˆ–`quote`å—æ„é€ ï¼š\n\n~~~julia\njulia> ex = quote\n           1 + 2\n       end;\n~~~\n\n#### `eval`\n\nå¯ä»¥ç”¨`eval`å‡½æ•°è®¡ç®—è¡¨è¾¾å¼çš„å€¼ï¼š\n\n~~~julia\njulia> eval(ex)\n3\n~~~\n\n#### Macros\n\nå®å¯ä»¥åŒ…æ‹¬ç¨‹åºä¸­ç”Ÿæˆçš„ä»£ç ã€‚å®å°†`Expr`å¯¹è±¡çš„å…ƒç»„ç›´æ¥æ˜ å°„åˆ°ç¼–è¯‘åçš„è¡¨è¾¾å¼ï¼š\n\n~~~julia\nmacro containervariable(container, element)\n    return esc(:($(Symbol(container,element)) = $container[$element]))\nend\n~~~\n\n#### Generated Functions\n\nå®`@generated`æ ¹æ®å‚æ•°çš„ç±»å‹ä¸ºæ–¹æ³•åˆ›å»ºä¸“é—¨çš„ä»£ç ï¼š\n\n~~~julia\n@generated function square(x)\n    println(x)\n    :(x * x)\nend\n\njulia> x = square(2); # note: output is from println() statement in the body\nInt64\njulia> x              # now we print x\n4\njulia> y = square(\"spam\");\nString\njulia> y\n\"spamspam\"\n~~~\n\n### Missing Values\n\nç¼ºå¤±çš„å€¼å¯ä»¥é€šè¿‡`missing`å¯¹è±¡è¡¨ç¤ºï¼Œè¯¥å¯¹è±¡æ˜¯`Missing`ç±»å‹çš„å•ä¾‹å®ä¾‹ï¼š\n\n~~~julia\njulia> a = [1, missing]\n2-element Array{Union{Missing, Int64},1}:\n 1\n  missing\n\njulia> sum(a)\nmissing\n\njulia> sum(skipmissing([1, missing]))\n1\n~~~\n\n## The Goodies: Base and Standard Library\n\n### Measuring Performance\n\nå¯ä»¥ä½¿ç”¨å®`@time`æ¥æ¯”è¾ƒç¨‹åºè¿è¡Œçš„å¿«æ…¢ã€‚\n\n### Collections and Data Structures\n\nJuliaæä¾›äº†å¦ä¸€ç§å†…ç½®ç±»å‹ï¼Œç§°ä¸ºsetï¼Œå®ƒçš„è¡Œä¸ºç±»ä¼¼äºæ²¡æœ‰å€¼çš„å­—å…¸é”®çš„é›†åˆã€‚é›†åˆæä¾›äº†è®¡ç®—å¸¸è§é›†åˆæ“ä½œçš„å‡½æ•°å’Œè¿ç®—ç¬¦ã€‚\n\n~~~julia\nfunction subtract(d1, d2)\n    res = Dict()\n    for key in keys(d1)\n        if key âˆ‰ keys(d2)\n            res[key] = nothing\n        end\n    end\n    res\nend\n~~~\n\n~~~julia\nfunction subtract(d1, d2)\n    setdiff(d1, d2)\nend\n~~~\n\n~~~julia\nfunction hasduplicates(t)\n    d = Dict()\n    for x in t\n        if x âˆˆ d\n            return true\n        end\n        d[x] = nothing\n    end\n    false\nend\n~~~\n\n~~~julia\nfunction hasduplicates(t)\n    length(Set(t)) < length(t)\nend\n~~~\n\n~~~julia\nfunction usesonly(word, available)\n    for letter in word\n        if letter âˆ‰ available\n            return false\n        end\n    end\n    true\nend\n~~~\n\n~~~julia\nfunction usesonly(word, available)\n    Set(word) âŠ† Set(available)\nend\n~~~\n\n### Interfaces\n\n`Julia`æŒ‡å®šäº†ä¸€äº›éæ­£å¼çš„æ¥å£æ¥å®šä¹‰è¡Œä¸ºï¼Œä¾‹å¦‚ï¼Œå…·æœ‰ç‰¹å®šç›®æ ‡çš„æ–¹æ³•ã€‚å½“æ‚¨ä¸ºæŸä¸ªç±»å‹æ‰©å±•è¿™æ ·çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ç±»å‹çš„å¯¹è±¡æ¥æ„å»ºè¿™äº›è¡Œä¸ºã€‚\n\nä¾‹å¦‚æ–æ³¢é‚£å¥‘ï¼š\n\n~~~julia\nstruct Fibonacci{T<:Real} end\nFibonacci(d::DataType) = d<:Real ? Fibonacci{d}() : error(\"No Real type!\")\n\nBase.iterate(::Fibonacci{T}) where {T<:Real} = (zero(T), (one(T), one(T)))\nBase.iterate(::Fibonacci{T}, state::Tuple{T, T}) where {T<:Real} = (state[1], (state[2], state[1] + state[2]))\n~~~\n\né¦–å…ˆå®šä¹‰äº†ç»“æ„å’Œæ„é€ æ–¹æ³•ï¼Œä¹‹åå®šä¹‰äº†åˆå§‹å¾ªç¯ï¼Œè¿”å›å€¼ç¬¬ä¸€ä¸ªä¸º$0$ï¼Œä¹‹åä¸€ä¸ªå…ƒç»„ä¸º`state`ç”¨äºä¸‹é¢çš„ä¸‹ä¸€æ¬¡å¾ªç¯ã€‚\n\n~~~julia\njulia> for e in Fibonacci(Int64)\n           e > 100 && break\n           print(e, \" \")\n       end\n0 1 1 2 3 5 8 13 21 34 55 89\n~~~\n\n","tags":["Julia","ç¼–ç¨‹"],"categories":["ä¹¦ç±é˜…è¯»"]},{"title":"ä¹¦ç±Thinking Juliaå‰åç« é˜…è¯»ç¬”è®°","url":"/2022/07/01/thinkjulia/","content":"\n<p align=\"center\">\n    <img src=\"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimglf6.lf127.net%2Fimg%2FanBSb2NqdEc5dTlseXpNTWxpY0RWQ2NwUlAyVmFEa2lFSVo0TVM4WXNwSndDMUdvN3crMS9nPT0.jpg%3FimageView%26thumbnail%3D2160x0%26quality%3D90%26interlace%3D1%26type%3Djpg&refer=http%3A%2F%2Fimglf6.lf127.net&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1659263087&t=d2faeee051aa3c102a86e173d74306ad\" style=\"zoom: 100%;\" />\n</p>\n\n> ä¹¦ç±ç½‘å€ï¼šhttps://benlauwens.github.io/ThinkJulia.jl/latest/book.html\n\n<!--more-->\n\n## The Way of the program\n\n### What is a Program?\n\nä¸€ä¸ªç¨‹åºåº”è¯¥åŒ…æ‹¬ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š\n\n+ è¾“å…¥ï¼šä»é”®ç›˜ã€æ–‡ä»¶ã€ç½‘ç»œæˆ–è€…å…¶ä»–è®¾å¤‡ä¸­è·å–æ•°æ®\n+ è¾“å‡ºï¼šå°†æ•°æ®å±•ç¤ºåœ¨å±å¹•ä¸Šã€æˆ–å°†å…¶å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ã€å°†å…¶å‘é€åˆ°ç½‘ç»œä¸Šç­‰ç­‰\n+ æ•°å­¦ï¼šæ‰§è¡ŒåŸºæœ¬çš„æ•°å­¦è¿ç®—ï¼Œå¦‚åŠ æ³•ä¹˜æ³•ç­‰\n+ æ¡ä»¶æ‰§è¡Œï¼šæŸ¥çœ‹ç‰¹å®šçš„æ¡ä»¶å¹¶ä¸”è¿è¡Œé€‚å½“çš„ä»£ç \n+ é‡å¤ï¼šé‡å¤åœ°åšä¸€äº›åŠ¨ä½œï¼Œé€šå¸¸æœ‰ä¸€äº›å˜åŒ–\n\n### The First Program\n\n~~~julia\njulia> println(\"Hello, World!\")\nHello, World!\n~~~\n\n### Arithmetic Operators\n\nç¬¦å·`+`ï¼Œ`-`ï¼Œ`*`ï¼Œ`/`ï¼Œ`^`åˆ†åˆ«è¡¨ç¤ºåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•ã€é™¤æ³•ã€å¹‚è¿ç®—ã€‚\n\n~~~julia\njulia> 40 + 2         \n42                    \n                      \njulia> 43 - 1         \n42                    \n                      \njulia> 6 * 7          \n42                    \n                      \njulia> 84 / 2         \n42.0                  \n                      \njulia> 6 ^ 2 + 6      \n42                    \n~~~\n\n> æ³¨æ„åœ¨é™¤æ³•ä¸­æˆ‘ä»¬å¾—åˆ°æ˜¯$42.0$è€Œä¸æ˜¯$42$ï¼Œåé¢æˆ‘ä»¬ä¼šè§£é‡ŠåŸå› ã€‚\n\n### Values and Types\n\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨`typeof`å‡½æ•°æ¥è·å–ç±»å‹ã€‚\n\n~~~julia\njulia> typeof(2)\nInt64\n\njulia> typeof(42.0)\nFloat64\n\njulia> typeof(\"Hello, World!\")\nString\n~~~\n\n## Variables, Expressions and Statements\n\n### Assignment Statements\n\nä½¿ç”¨`=`å¯¹å˜é‡è¿›è¡Œèµ‹å€¼ã€‚\n\n~~~julia\njulia> n = 17\n17\n~~~\n\n### Variable Names\n\nå‘½åå¯ä»¥é‡‡ç”¨å­—æ¯ã€æ•°å­—å’Œ`_`ï¼Œä½†æ˜¯æ•°å­—ä¸èƒ½åœ¨å¼€å¤´ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨å…³é”®å­—ã€‚\n\nä¸‹é¢ä¸º`Julia`çš„å…³é”®å­—ï¼š\n\n~~~julia\nabstract type    baremodule   begin      break       catch\nconst            continue     do         else        elseif\nend              export       finally    for         function\nglobal           if           import     importall   in\nlet              local        macro      module      mutable struct\nprimitive type   quote        return     try         using\nstruct           where        while\n~~~\n\n### Expressions and Statements\n\nè¡¨è¾¾å¼æ˜¯å€¼ï¼ˆvaluesï¼‰ã€å˜é‡ï¼ˆvariablesï¼‰å’Œç¬¦å·ï¼ˆoperatorsï¼‰çš„ç»„åˆã€‚\n\n~~~julia\njulia> 42\n42\n\njulia> n\n17\n\njulia> n + 25\n42\n~~~\n\nè¯­å¥æ˜¯å…·æœ‰æ•ˆæœçš„ä»£ç å•ä½ï¼Œä¾‹å¦‚åˆ›å»ºå˜é‡æˆ–æ˜¾ç¤ºå€¼ã€‚\n\n~~~julia\njulia> n = 17\n17\n\njulia> println(n)\n17\n~~~\n\n### Operator Precedence\n\næ‹¬å·ä¼˜å…ˆçº§æœ€é«˜ï¼Œå…¶æ¬¡æ˜¯å¹‚ï¼Œä¹‹åæ˜¯ä¹˜é™¤æ³•ã€åŠ å‡æ³•ä¼˜å…ˆçº§æœ€ä½ã€‚\n\n### String Operations\n\n`*`è¡¨ç¤ºå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œ`^`è¡¨ç¤ºå­—ç¬¦ä¸²é‡å¤ã€‚\n\n~~~julia\njulia> first_str = \"throat\"\n\"throat\"\n\njulia> second_str = \"warbler\"\n\"warbler\"\n\njulia> first_str * second_str\n\"throatwarbler\"\n\njulia> \"Spam\"^3\n\"SpamSpamSpam\"\n~~~\n\n### Comments\n\næ³¨é‡Šç”¨`#`ã€‚\n\n### Debugging\n\n`Julia`ä¸­å­˜åœ¨ä¸‰ç§é”™è¯¯ã€‚\n\n+ è¯­æ³•é”™è¯¯(Syntax error)ï¼šè¯­æ³•æŒ‡çš„æ˜¯ç¨‹åºçš„ç»“æ„å’Œå…³äºè¯¥ç»“æ„çš„è§„åˆ™ã€‚å¦‚æ‹¬å·å°‘ä¸€è¾¹ã€‚\n+ è¿è¡Œæ—¶é”™è¯¯(Runtime error)ï¼šæŒ‡çš„æ˜¯ç¨‹åºè¿è¡Œæ—¶å‡ºé”™ï¼Œä¹Ÿè¢«ç§°ä¸ºå¼‚å¸¸ã€‚\n+ è¯­ä¹‰é”™è¯¯(Semantic error)ï¼šè¿™ç§é”™è¯¯ç¨‹åºä¼šè¿è¡Œï¼Œä½†æ˜¯å¾—åˆ°çš„ç»“æœä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚\n\n## Functions\n\n### Function Calls\n\næˆ‘ä»¬ä¹‹å‰å·²ç»çœ‹åˆ°ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„ä¾‹å­ï¼š\n\n~~~julia\njulia> println(\"Hello, World!\")\nHello, World!\n~~~\n\n`Println()`æ˜¯å‡½æ•°çš„åå­—ï¼Œæ‹¬å·é‡Œé¢æ˜¯å‡½æ•°çš„å‚æ•°ã€‚\n\n`Julia`æä¾›ä¸€äº›ç±»å‹è½¬æ¢çš„å‡½æ•°ï¼š\n\n`parse`å‡½æ•°å°†å­—ç¬¦ä¸²ç±»å‹è½¬ä¸ºä»»ä½•æ•°å­—(number)ç±»å‹\n\n~~~julia\njulia> parse(Int64, \"32\")\n32\n\njulia> parse(Float64, \"3.14159\")\n3.14159\n\njulia> parse(Int64, \"Hello\")\nERROR: ArgumentError: invalid base 10 digit 'H' in \"Hello\"\n~~~\n\n`trunc`å¯ä»¥å°†å­—ç¬¦ä¸²æˆªæ–­ä¸ºæ•´æ•°ï¼š\n\n~~~julia\njulia> trunc(Int64, 3.9999)\n3\n\njulia> trunc(Int64, -2.3)\n-2\n~~~\n\n`float`å°†æ•´æ•°è½¬ä¸ºæµ®ç‚¹æ•°ï¼š\n\n~~~julia\njulia> float(24)\n24.0\n~~~\n\n`string`å°†å‚æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š\n\n~~~julia\njulia> string(32)\n\"32\"\n\njulia> string(32.2)\n\"32.2\"\n~~~\n\n### Adding New Functions\n\næˆ‘ä»¬ä½¿ç”¨`function`å®šä¹‰å‡½æ•°ï¼Œä»¥`end`ç»“æŸã€‚\n\n~~~julia\nfunction printlyrics()\n    println(\"I'm a lumberjack, and I'm okay.\")\n    println(\"I sleep all night and I work all day.\")\nend\n~~~\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å‡½æ•°ä¸­è°ƒç”¨å‡½æ•°ï¼š\n\n~~~julia\nfunction repeatlyrics()\n    printlyrics()\n    printlyrics()\nend\n~~~\n\n>  å‡½æ•°åœ¨è¿è¡Œå‰å¿…é¡»è¢«å®šä¹‰ã€‚\n\n### Parameters and Arguments\n\nä¸‹é¢æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå«æœ‰å‚æ•°çš„å‡½æ•°ï¼š\n\n~~~julia\nfunction printtwice(bruce)\n    println(bruce)\n    println(bruce)\nend\n~~~\n\nä¼ å…¥çš„å‚æ•°å¯ä»¥æ˜¯å€¼(value)ã€è¡¨è¾¾å¼å’Œå˜é‡ã€‚\n\n### Variables and Parameters Are Local\n\nå‡½æ•°çš„å˜é‡å’Œå‚æ•°æ˜¯å±€éƒ¨çš„ã€‚\n\n### Fruitful Functions and Void Functions\n\næœ‰è¿”å›å€¼çš„å‡½æ•°ç§°ä¸ºFruitful Functionsï¼Œæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°ç§°ä¸ºVoid Functionsã€‚æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°çš„è¿”å›å€¼ä¸º`nothing`ï¼Œæˆ‘ä»¬åªèƒ½ä½¿ç”¨`show`å‡½æ•°æ‰“å°ã€‚\n\n~~~julia\njulia> result = printtwice(\"Bing\")\nBing\nBing\njulia> show(result)\nnothing\n~~~\n\n`nothing`çš„ç±»å‹ä¸º`Nothing`ï¼š\n\n~~~julia\njulia> typeof(nothing)\nNothing\n~~~\n\n## Case Study: Interface Design\n\n### Turtles\n\næˆ‘ä»¬ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤ä¸‹è½½æ‰€éœ€è¦çš„åŒ…ï¼š\n\né¦–å…ˆåœ¨`REPL`ä¸‹æŒ‰`]`é”®è°ƒå‡ºåŒ…ç®¡ç†ï¼š\n\n~~~julia\n(v1.0) pkg> add https://github.com/BenLauwens/ThinkJulia.jl\n~~~\n\n~~~julia\njulia> using ThinkJulia\n\njulia> ğŸ¢ = Turtle()\nLuxor.Turtle(0.0, 0.0, true, 0.0, (0.0, 0.0, 0.0))\n~~~\n\n>  è¾“å…¥ï¼š`ğŸ¢` (**`\\:turtle: TAB`**)ã€‚\n\nä¸€æ—¦åˆ›å»ºäº†ä¸€ä¸ªä¹Œé¾Ÿï¼Œå¯ä»¥è°ƒç”¨å‡½æ•°æ¥è®©ä»–ç§»åŠ¨ã€‚\n\n~~~julia\n@svg begin\n    forward(ğŸ¢, 100)\nend\n~~~\n\n`@svg`å…³é”®å­—è¿è¡Œä¸€ä¸ªç»˜åˆ¶SVGå›¾ç‰‡çš„å®ã€‚å®æ˜¯Juliaçš„ä¸€ä¸ªé‡è¦ä½†é«˜çº§çš„ç‰¹æ€§ã€‚\n\nä¸ºäº†ç»˜åˆ¶ç›´è§’ï¼Œä¿®æ”¹å®\n\n~~~julia\nğŸ¢ = Turtle()\n@svg begin\n    forward(ğŸ¢, 100)\n    turn(ğŸ¢, -90)\n    forward(ğŸ¢, 100)\nend\n~~~\n\n### Simple Repetition\n\næˆ‘ä»¬ä½¿ç”¨`for`å¾ªç¯æ¥ç»˜åˆ¶ä¸€ä¸ªæ­£æ–¹å½¢ï¼š\n\n~~~julia\nğŸ¢ = Turtle()\n@svg begin\n    for i in 1:4\n        forward(ğŸ¢, 100)\n        turn(ğŸ¢, -90)\n    end\nend\n~~~\n\n## Conditionals and Recursion\n\n### Floor Division and Modulus\n\n`floor division`ç¬¦å·`Ã·` (**`\\div TAB`**)ï¼Œä¸¤ä¸ªæ•°å­—ç›¸é™¤åå¾—åˆ°æ•´æ•°ã€‚å–ä½™ç¬¦å·`%`å¾—åˆ°ä½™æ•°ã€‚\n\n~~~julia\njulia> minutes = 105            \n105                             \n                                \njulia> hours = minutesÃ·60       \n1                               \n                                \njulia> remainder = minutes % 60 \n45                              \n~~~\n\n### Boolean Expressions\n\nå¸ƒå°”è¡¨è¾¾å¼ä¸ºç»“æœä¸ºçœŸæˆ–å‡çš„è¡¨è¾¾å¼ã€‚\n\n~~~julia\n      x == y               # x is equal to y\n      x != y               # x is not equal to y\n      x â‰  y                # (\\ne TAB)\n      x > y                # x is greater than y\n      x < y                # x is less than y\n      x >= y               # x is greater than or equal to y\n      x â‰¥ y                # (\\ge TAB)\n      x <= y               # x is less than or equal to y\n      x â‰¤ y                # (\\le TAB)\n~~~\n\n### Logical Operators\n\nä¸`&&`\n\næˆ–`||`\n\né`!`\n\nå…¶ä¸­`&&`çš„ä¼˜å…ˆçº§é«˜äº`||`ã€‚\n\n### Conditional Execution\n\n```julia\nif x > 0\n    println(\"x is positive\")\nend\n```\n\n### Alternative Execution\n\n```julia\nif x % 2 == 0\n    println(\"x is even\")\nelse\n    println(\"x is odd\")\nend\n```\n\n### Chained Conditionals\n\n~~~julia\nif x < y\n    println(\"x is less than y\")\nelseif x > y\n    println(\"x is greater than y\")\nelse\n    println(\"x and y are equal\")\nend\n~~~\n\n### Nested Conditionals\n\n~~~julia\nif x == y\n    println(\"x and y are equal\")\nelse\n    if x < y\n        println(\"x is less than y\")\n    else\n        println(\"x is greater than y\")\n    end\nend\n~~~\n\n~~~julia\nif 0 < x < 10\n    println(\"x is a positive single-digit number.\")\nend\n~~~\n\n### Recursion\n\nå‡½æ•°è‡ªå·±è°ƒç”¨è‡ªå·±è¢«ç§°ä¸ºé€’å½’ã€‚\n\n~~~julia\nfunction printn(s, n)\n    if n â‰¤ 0\n        return\n    end\n    println(s)\n    printn(s, n-1)\nend\n~~~\n\n### Keyboard Input\n\n`Julia`æä¾›å†…å»ºå‡½æ•°`readline`æ¥åœæ­¢ç¨‹åºæ¥ç­‰å¾…ç”¨æˆ·è¾“å…¥ä¸€äº›ä¸œè¥¿ï¼Œå½“ç”¨æˆ·é”®å…¥`RETURN`æˆ–`ENTERN`æ—¶ç¨‹åºç»§ç»­è¿è¡Œï¼Œ`readline`ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ç”¨æˆ·è¾“å…¥çš„å†…å®¹ã€‚\n\n~~~julia\njulia> text = readline()\nWhat are you waiting for?\n\"What are you waiting for?\"\n~~~\n\n## Fruitful Functions\n\n### Return Values\n\nå‡½æ•°å…·æœ‰è¿”å›å€¼ï¼š\n\n~~~julia\nfunction area(radius)\n    a = Ï€ * radius^2\n    return a\nend\n~~~\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥çœç•¥`return`ï¼Œé»˜è®¤æœ€åä¸€è¡Œä¸ºå‡½æ•°çš„è¿”å›å€¼ï¼š\n\n~~~julia\nfunction area(radius)\n    Ï€ * radius^2\nend\n~~~\n\n### Checking Types\n\n~~~julia\nfunction fact(n)\n    if !(n isa Int64)\n        error(\"Factorial is only defined for integers.\")\n    elseif n < 0\n        error(\"Factorial is not defined for negative integers.\")\n    elseif n == 0\n        return 1\n    else\n        return n * fact(n-1)\n    end\nend\n~~~\n\n## Iteration\n\n### The `while` Statement\n\n~~~julia\nfunction countdown(n)\n    while n > 0\n        print(n, \" \")\n        n = n - 1\n    end\n    println(\"Blastoff!\")\nend\n~~~\n\n#### break\n\n~~~julia\nwhile true\n    print(\"> \")\n    line = readline()\n    if line == \"done\"\n        break\n    end\n    println(line)\nend\nprintln(\"Done!\")\n~~~\n\n#### continue\n\n~~~julia\nfor i in 1:10\n    if i % 3 == 0\n        continue\n    end\n    print(i, \" \")\nend\n~~~\n\n## Strings\n\n### Characters\n\nä¸€ä¸ªå­—ç¬¦ç”¨å•å¼•å·`''`åŒ…è£¹ï¼š\n\n~~~julia\njulia> 'x'\n'x': ASCII/Unicode U+0078 (category Ll: Letter, lowercase)\njulia> 'ğŸŒ'\n'ğŸŒ': Unicode U+01f34c (category So: Symbol, other)\njulia> typeof('x')\nChar\n~~~\n\n### A String Is a Sequence\n\næˆ‘ä»¬å¯ä»¥å¯¹å­—ç¬¦ä¸²è¿›è¡Œç´¢å¼•ï¼š\n\n~~~julia\njulia> fruit = \"banana\"\n\"banana\"\njulia> letter = fruit[1]\n'b': ASCII/Unicode U+0062 (category Ll: Letter, lowercase)\njulia> fruit[end]\n'a': ASCII/Unicode U+0061 (category Ll: Letter, lowercase)\n~~~\n\n### `length`\n\n`length`è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼š\n\n```julia\njulia> fruits = \"ğŸŒ ğŸ ğŸ\"\n\"ğŸŒ ğŸ ğŸ\"\njulia> len = length(fruits)\n5\n```\n\nå­—ç¬¦ä¸²æ˜¯ä½¿ç”¨`UTF-8`è¿›è¡Œç¼–ç çš„ã€‚`UTF-8`æ˜¯ä¸€ä¸ªå¯å˜å®½åº¦çš„ç¼–ç ï¼Œè¿™æ„å‘³ç€å¹¶éæ‰€æœ‰å­—ç¬¦å‡ä»¥ç›¸åŒæ•°é‡çš„å­—èŠ‚ç¼–ç ã€‚å› æ­¤æˆ‘ä»¬ç´¢å¼•å¯èƒ½ä¼šå‡ºé”™ã€‚\n\nå‡½æ•°`sizeof`å¯ä»¥ç»™å‡ºå­—ç¬¦ä¸²çš„å­—èŠ‚æ•°ï¼š\n\n~~~julia\njulia> sizeof(\"ğŸŒ\")\n4\n~~~\n\nè¿™æ„å‘³ç€`UTF-8`ç¼–ç çš„å­—ç¬¦ä¸²ä¸­çš„å­—èŠ‚ç´¢å¼•å¹¶ä¸æ˜¯å¹¶ä¸æ€»æ˜¯ä¸€ä¸ªå­—ç¬¦çš„åˆç†çš„ç´¢å¼•ï¼š\n\n~~~julia\njulia> fruits[2]\nERROR: StringIndexError(\"ğŸŒ ğŸ ğŸ\", 2)\n~~~\n\n### Traversal\n\n~~~julia\nindex = firstindex(fruits)\nwhile index <= sizeof(fruits)\n    letter = fruits[index]\n    println(letter)\n    global index = nextind(fruits, index)\nend\n~~~\n\n`nextind`è¿”å›ä¸‹ä¸€ä¸ªåˆç†çš„ç´¢å¼•ï¼›`prevind`æŸ¥æ‰¾å‰ä¸€ä¸ªåˆç†çš„ç´¢å¼•ã€‚\n\n### String Slices\n\n~~~julia\njulia> str = \"Julius Caesar\";\n\njulia> str[1:6]\n\"Julius\"\njulia> str[:]\n\"Julius Caesar\"\n~~~\n\n### Strings Are Immutable\n\n~~~julia\njulia> greeting = \"Hello, world!\"\n\"Hello, world!\"\njulia> greeting[1] = 'J'\nERROR: MethodError: no method matching setindex!(::String, ::Char, ::Int64)\n~~~\n\n### String Interpolation\n\nä½¿ç”¨ç¬¦å·`$`å¯ä»¥å°†è¡¨è¾¾å¼çš„å€¼æ’å…¥åˆ°å­—ç¬¦ä¸²ä¸­ï¼š\n\n~~~julia\njulia> greet = \"Hello\"  \n\"Hello\"                 \n                        \njulia> whom = \"World\"   \n\"World\"                 \n\njulia> \"$(greet), $(whom)!\"\n\"Hello, World!\"\n~~~\n\n### Searching\n\n~~~julia\nfunction find(word, letter)\n    index = firstindex(word)\n    while index <= sizeof(word)\n        if word[index] == letter\n            return index\n        end\n        index = nextind(word, index)\n    end\n    -1\nend\n~~~\n\n### Looping and Counting\n\n~~~julia\nword = \"banana\"\ncounter = 0\nfor letter in word\n    if letter == 'a'\n        global counter = counter + 1\n    end\nend\nprintln(counter)\n~~~\n\n### String Library\n\n~~~julia\njulia> uppercase(\"Hello, World!\")\n\"HELLO, WORLD!\"\n\njulia> findfirst(\"a\", \"banana\")\n2:2\n\njulia> findfirst(\"na\", \"banana\")\n3:4\n\njulia> findnext(\"na\", \"banana\", 4)\n5:6\n~~~\n\n### The `âˆˆ` Operator\n\n~~~julia\njulia> 'a' âˆˆ \"banana\"    # 'a' in \"banana\"\ntrue\n~~~\n\n### String Comparison\n\n~~~julia\nword = \"Pineapple\"\nif word < \"banana\"\n    println(\"Your word, $(word), comes before banana.\")\nelseif word > \"banana\"\n    println(\"Your word, $(word), comes after banana.\")\nelse\n    println(\"All right, bananas.\")\nend\n> Your word, Pineapple, comes before banana.\n~~~\n\n##  Arrays\n\n`Array`ä¸º`Julia`å†…ç½®çš„æ•°æ®ç»“æ„ã€‚\n\n### An Array is a Sequence\n\næ•°ç»„ä¸­å…ƒç´ ä¸ä¸€å®šè¦æ˜¯åŒä¸€ç§ç±»å‹ï¼Œæœ€ç®€å•çš„åˆ›å»ºæ•°ç»„çš„æ–¹æ³•æ˜¯ç”¨ä¸­æ‹¬å·`[]`ï¼š\n\n~~~julia\n[\"spam\", 2.0, 5, [10, 20]]\n~~~\n\n~~~julia\njulia> cheeses = [\"Cheddar\", \"Edam\", \"Gouda\"];\n\njulia> numbers = [42, 123];\n\njulia> empty = [];\n\njulia> print(cheeses, \" \", numbers, \" \", empty)\n[\"Cheddar\", \"Edam\", \"Gouda\"] [42, 123] Any[]\n~~~\n\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨`typeof`æ¥æŸ¥çœ‹ç±»å‹ï¼š\n\n~~~julia\njulia> typeof(cheeses)\nArray{String,1}\njulia> typeof(numbers)\nArray{Int64,1}\njulia> typeof(empty)\nArray{Any,1}\n~~~\n\næ•°ç»„ç±»å‹åŒ…å«æ•°ç»„ä¸­å…ƒç´ çš„ç±»å‹å’Œç»´åº¦ã€‚\n\n### Arrays Are Mutable\n\næ•°ç»„æ˜¯å¯å˜çš„ï¼š\n\n~~~julia\njulia> numbers[2] = 5\n5\njulia> print(numbers)\n[42, 5]\n~~~\n\n### Traversing an Array\n\n~~~julia\nfor cheese in cheeses\n    println(cheese)\nend\n\nfor x in []\n    println(\"This can never happens.\")\nend\n~~~\n\n### Array Slices\n\n~~~julia\njulia> t = ['a', 'b', 'c', 'd', 'e', 'f'];\n\njulia> print(t[1:3])\n['a', 'b', 'c']\njulia> print(t[3:end])\n['c', 'd', 'e', 'f']\n~~~\n\n`[:]`æ‹·è´æ•°ç»„ï¼š\n\n~~~julia\njulia> print(t[:])\n['a', 'b', 'c', 'd', 'e', 'f']\n~~~\n\n### Array Library\n\n`push!`å‘æ•°ç»„ä¸­æ·»åŠ å…ƒç´ ï¼š\n\n~~~julia\njulia> t = ['a', 'b', 'c'];\n\njulia> push!(t, 'd');\n\njulia> print(t)\n['a', 'b', 'c', 'd']\n~~~\n\n`append!`å°†ç¬¬ä¸€ä¸ªæ•°ç»„çš„å…ƒç´ æ”¾åœ¨ç¬¬äºŒä¸ªæ•°ç»„å‰é¢ï¼š\n\n~~~julia\njulia> t1 = ['a', 'b', 'c'];\n\njulia> t2 = ['d', 'e'];\n\njulia> append!(t1, t2);\n\njulia> print(t1)\n['a', 'b', 'c', 'd', 'e']\n~~~\n\n`sort!`æ’åºï¼Œæ”¹å˜åŸæ•°ç»„ï¼Œ`sort`ä¸æ”¹å˜åŸæ•°ç»„ï¼Œå¸¦`!`çš„å‡½æ•°æ”¹å˜åŸæ¥çš„æ•°ç»„ã€‚\n\n~~~julia\njulia> t = ['d', 'c', 'e', 'b', 'a'];\n\njulia> sort!(t);\n\njulia> print(t)\n['a', 'b', 'c', 'd', 'e']\n\njulia> t1 = ['d', 'c', 'e', 'b', 'a'];\n\njulia> t2 = sort(t1);\n\njulia> print(t1)\n['d', 'c', 'e', 'b', 'a']\njulia> print(t2)\n['a', 'b', 'c', 'd', 'e']\n~~~\n\n\n\n### Dot Syntax\n\nå‡½æ•°å‰æ·»åŠ `.`æ˜¯é€å…ƒç´ æ“ä½œï¼š\n\n~~~julia\njulia> t = uppercase.([\"abc\", \"def\", \"ghi\"]);\n\njulia> print(t)\n[\"ABC\", \"DEF\", \"GHI\"]\n~~~\n\n### Deleting (Inserting) Elements\n\n`splice!`åˆ é™¤è¿”å›å…ƒç´ ï¼š\n\n~~~julia\njulia> t = ['a', 'b', 'c'];\n\njulia> splice!(t, 2)\n'b': ASCII/Unicode U+0062 (category Ll: Letter, lowercase)\njulia> print(t)\n['a', 'c']\n~~~\n\n`pop!`åˆ é™¤å¹¶è¿”å›æœ€åä¸€ä¸ªå…ƒç´ ï¼š\n\n~~~julia\njulia> t = ['a', 'b', 'c'];\n\njulia> pop!(t)\n'c': ASCII/Unicode U+0063 (category Ll: Letter, lowercase)\njulia> print(t)\n['a', 'b']\n~~~\n\n`popfirst!`åˆ é™¤è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š\n\n~~~julia\njulia> t = ['a', 'b', 'c'];\n\njulia> popfirst!(t)\n'a': ASCII/Unicode U+0061 (category Ll: Letter, lowercase)\njulia> print(t)\n['b', 'c']\n~~~\n\n`pushfirst!` and `push!`åˆ†åˆ«åœ¨ç¬¬ä¸€ä½å’Œæœ€åä¸€ä½æ’å…¥æ•°æ®ã€‚\n\n`deleteat!`åˆ é™¤ä½†ä¸è¿”å›å…ƒç´ ï¼š\n\n~~~julia\njulia> t = ['a', 'b', 'c'];\n\njulia> print(deleteat!(t, 2))\n['a', 'c']\n~~~\n\n `insert!`åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ ï¼š\n\n~~~julia\njulia> t = ['a', 'b', 'c'];\n\njulia> print(insert!(t, 2, 'x'))\n['a', 'x', 'b', 'c']\n~~~\n\n### Arrays and Strings\n\n`collect`å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸ºæ•°ç»„ï¼š\n\n~~~julia\njulia> t = collect(\"spam\");\n\njulia> print(t)\n['s', 'p', 'a', 'm']\n~~~\n\n`split`å¯ä»¥å°†å­—ç¬¦ä¸²æŒ‰ç…§åˆ†éš”ç¬¦åˆ†å‰²ä¸ºæ•°ç»„ï¼š\n\n~~~julia\njulia> t = split(\"spam-spam-spam\", '-');\n\njulia> print(t)\nSubString{String}[\"spam\", \"spam\", \"spam\"]\n~~~\n\n`join`æ˜¯`split`çš„é€†è¿ç®—ï¼Œå°†æ•°ç»„è½¬ä¸ºå­—ç¬¦ä¸²ï¼š\n\n~~~julia\njulia> t = [\"pining\", \"for\", \"the\", \"fjords\"];\n\njulia> s = join(t, ' ')\n\"pining for the fjords\"\n~~~\n\n### Objects and Values\n\nä¸€ä¸ªå¯¹è±¡æ˜¯å˜é‡å¯ä»¥å¼•ç”¨çš„ä¸œè¥¿ã€‚\n\nå¯¹äºå­—ç¬¦ä¸²ï¼š\n\n~~~julia\njulia> a = \"banana\"\n\"banana\"\njulia> b = \"banana\"\n\"banana\"\njulia> a â‰¡ b\ntrue\n~~~\n\nå¯¹äºæ•°ç»„ï¼š\n\n~~~julia\njulia> a = [1, 2, 3];\n\njulia> b = [1, 2, 3];\n\njulia> a â‰¡ b\nfalse\n~~~\n\n### Aliasing\n\n~~~julia\njulia> a = [1, 2, 3];\n\njulia> b = a;\n\njulia> b â‰¡ a\ntrue\n~~~\n\nå˜é‡ä¸å¯¹è±¡çš„å…³è”ç§°ä¸ºå¼•ç”¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰ä¸¤ä¸ªå¯¹åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚\n\n### Array Arguments\n\nå½“æŠŠä¸€ä¸ªæ•°ç»„ä¼ ç»™å‡½æ•°æ—¶ï¼Œå‡½æ•°å¾—åˆ°æ•°ç»„çš„å¼•ç”¨ï¼Œå‡½æ•°ä¼šæ”¹å˜æ•°ç»„ï¼š\n\n~~~julia\nfunction deletehead!(t)\n    popfirst!(t)\nend\n\njulia> letters = ['a', 'b', 'c'];\n\njulia> deletehead!(letters);\n\njulia> print(letters)\n['b', 'c']\n~~~\n\nå‡½æ•°`vcat`åˆ›å»ºæ–°çš„æ•°ç»„ï¼Œä¸ä¼šæ”¹å˜åŸæ•°ç»„ï¼š\n\n~~~julia\njulia> t3 = vcat(t1, [4]);\n\njulia> print(t1)\n[1, 2, 3]\njulia> print(t3)\n[1, 2, 3, 4]\n~~~\n\nåˆ‡ç‰‡ä¹Ÿä¼šåˆ›å»ºæ–°æ•°ç»„ï¼Œä¸ä¼šæ”¹å˜åŸæ•°ç»„ï¼š\n\n~~~julia\nfunction baddeletehead(t)\n    t = t[2:end]                # WRONG!\nend\n\njulia> t4 = baddeletehead(t3);\n\njulia> print(t3)\n[1, 2, 3, 4]\njulia> print(t4)\n[2, 3, 4]\n~~~\n\n","tags":["Julia","ç¼–ç¨‹"],"categories":["ä¹¦ç±é˜…è¯»"]},{"title":"Bç«™è¯¾ç¨‹Mathematicaå‰ä¸‰å‘¨","url":"/2022/07/01/math/","content":"\n<p align=\"center\">\n    <img src=\"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fi0.hdslb.com%2Fbfs%2Farticle%2F7d065302ef2984abddb60152758c13bd66f74fba.jpg&refer=http%3A%2F%2Fi0.hdslb.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1659263087&t=447b47f50cbb4d4d181ed18e4ac43cb5\" style=\"zoom: 100%;\" />\n</p>\n\n>  Bç«™è¯¾ç¨‹é“¾æ¥ï¼šhttps://www.bilibili.com/video/BV1av411N7Xi?spm_id_from=333.999.0.0&vd_source=6177c61c946280bb88c727585de76bc8\n\n<!--more-->\n\n## ç¬¬ä¸€å‘¨\n\n### å€¼ã€å˜é‡ã€ç±»å‹\n\nä»¥ä¸‹ä¸‰ç§å¯¹è±¡æˆä¸ºåŸå­(atom)ï¼š\n\nç¬¦å·(Symbol)ï¼šç”±å­—æ¯å’Œæ•°å­—(æ•°å­—ä¸èƒ½åœ¨èµ·å§‹ä½ç½®)æ„æˆçš„æœ‰é™åºåˆ—\n\næ•°å­—(Number)ï¼šæ•´æ•°ã€æœ‰ç†æ•°ã€å®æ•°ã€å¤æ•°\n\nå­—ç¬¦ä¸²(String)ï¼šç”±åŒå¼•å·`\"\"`æ‹¬èµ·æ¥çš„ä»»æ„å­—ç¬¦æ„æˆçš„æœ‰é™åºåˆ—\n\n#### å‘½å\n\næˆ‘ä»¬åœ¨å‘½åæ—¶åº”æ³¨æ„é¿å¼€ç³»ç»Ÿå†…å»ºç¬¦å·ï¼Œç³»ç»Ÿå†…å»ºç¬¦å·çš„ç‰¹ç‚¹ä¸ºï¼š\n\n+ ç”±ç¬¬ä¸€ä¸ªå­—æ¯å¤§å†™çš„å•è¯ç»„æˆ(Camelå‘½åæ³•)ï¼šTrueã€Falseã€FactorIntegerã€SetAttributes\n+ ç”¨æ¥åšåˆ¤æ–­çš„å‡½æ•°æœ«å°¾é€šå¸¸æœ‰\"Q\"ï¼šEvenQã€PrimeQã€MatchQ\n+ ç”¨äººåå‘½åçš„ç¬¦å·=äººå+ç¬¦å·åï¼šEulerGammaã€BesselJã€DiracDelta\n\n#### ç±»å‹æ£€æŸ¥\n\nä¸€ä¸ªç¼–ç¨‹è¯­è¨€çš„ç±»å‹æ£€æŸ¥è¶Šä¸¥æ ¼ï¼Œç¨‹åºå‘˜å—åˆ°çš„æŸç¼šè¶Šå¤§ã€‚Mathematicaç¨‹åºé€šå¸¸æ¥è¯´éƒ½æ¯”è¾ƒçŸ­å°ï¼Œé ç¨‹åºå‘˜è‡ªè§‰æ£€æŸ¥ç±»å‹åŸºæœ¬ä¸Šå°±è¶³å¤Ÿäº†ï¼Œæ‰€ä»¥ä¸éœ€è¦å¤ªä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥æœºåˆ¶ã€‚ä¸€ä¸ªè¾ƒå¼±çš„ç±»å‹æ£€æŸ¥å¯ä»¥è®©ç¨‹åºå‘˜å†™å‡ºæ›´çµæ´»çš„ç¨‹åºã€‚\n\n~~~mathematica\nSin[\"I'm a string!\"]\n> Sin[\"I'm a string!\"]\nSin[\"I'm a string!\"] /. {\"I'm a string!\" -> Pi/3}\n> Sqrt[3]/2\n~~~\n\n### æ¡ä»¶ã€å¾ªç¯ã€å­ç¨‹åº\n\nåœ¨Mathematicaä¸­ï¼Œæ¡ä»¶å’Œå¾ªç¯ç»“æ„å…¶å®ç”¨çš„å¹¶ä¸å¤šã€‚è¿™æ˜¯å› ä¸ºæ¡ä»¶ç»“æ„çš„åŠŸèƒ½åŸºæœ¬ä¸Šå¯ä»¥é€šè¿‡æ ¸å¿ƒè¯­è¨€ä¸­çš„æ¨¡å¼åŒ¹é…æ¥å®Œæˆï¼›è€Œå¾ªç¯ç»“æ„çš„åŠŸèƒ½åˆ™å¯ä»¥é€šè¿‡è¡¨å¤„ç†å’Œæ³›å‡½ç¼–ç¨‹å®Œæˆã€‚\n\n#### ç®€å•çš„æ¡ä»¶åˆ¤æ–­\n\n~~~mathematica\nIf[True, Print[\"Then\"]]\n> Then\nIf[False, Print[\"Then\"], Print[\"Else\"]]\n> Else\nIf[a == b, Print[\"Then\"], Print[\"Else\"], Print[\"Unevaluated\"]]\n> Unevaluated\nIf[a === b, Print[\"Then\"], Print[\"Else\"], Print[\"Unevaluated\"]]\n> Else\n~~~\n\n#### å¤šé‡æ¡ä»¶åˆ¤æ–­\n\n~~~mathematica\nx = 5; Which[x == 1, 1, x == 2, 2, x == 3, 3, True, Print[\"x!=1,2,3\"]]\n> x!=1,2,3\nPlot[Piecewise[{{1, x == 0}, {Sin[x]/x, x != 0}}], {x, -4 Pi, 4 Pi}]\n~~~\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/math1.jpg)\n\n~~~mathematica\nSwitch[b, True, 1, False, 0, _, Print[\"b is not a boolean value!\"]]\n> b is not a boolean value!\n~~~\n\n#### ç®€å•å¾ªç¯\n\n~~~mathematica\nDo[Print[\"å“Ÿ,\"], {3}]; Print[\"åˆ‡å…‹é—¹!\"]\nDo[Print[Prime[i]], {i, 2, PrimePi[100]}]\nDo[Print[i, \" is a prime number.\"], {i, {2, 3, 5, 7, 11}}]\n~~~\n\n#### å¤æ‚å¾ªç¯\n\n~~~mathematica\nFor[i = 1; t = i, i <= 10, i++, Print[t *= i]]\nn = 1234567; While[Not[PrimeQ[++n]]]; n\n~~~\n\n### å‡½æ•°\n\nå‡½æ•°å®šä¹‰æ–¹æ³•ä¸€ï¼šæ¨¡å¼åŒ¹é…+å»¶è¿Ÿèµ‹å€¼\n\n~~~mathematica\nf[x_] := x^2;\nf[x_, y_] := x y;\n~~~\n\nå‡½æ•°å®šä¹‰æ–¹æ³•äºŒï¼šçº¯å‡½æ•°($\\lambda-$è¡¨è¾¾å¼ã€åŒ¿åå‡½æ•°)\n\n~~~mathematica\nf1 = Function[x, x^2];\n(* ç®€å†™å½¢å¼ *)\nf2 = #^2 &;\ng1 = Function[{x, y}, x y];\n(* ç®€å†™å½¢å¼ *)\ng2 = #1 #2 &;\n~~~\n\nä¾‹å­ï¼šæ±‚ä¸å¤§äºç»™å®šæ­£æ•´æ•°$n$çš„æ‰€æœ‰ç´ æ•°çš„å’Œ\n\n~~~mathematica\n(* ç±»Cå®ç° *)\nmyPrimeQ = \n  Function[x, i = 2; max = Floor[Sqrt[x]] + 1; \n   While[Mod[x, i] != 0 && i < max, i++]; Not[i < max]];\nmyPrimeSum = \n  Function[n, sum = 0; Do[If[myPrimeQ[x], sum += x], {x, 2, n}]; sum];\n(*æ ¸å¿ƒè¯­è¨€å®ç°ã€‚Mathematicaå†…éƒ¨å­˜å‚¨äº†å‰10äº¿ä¸ªç´ æ•°çš„ç´ æ•°è¡¨*)\nmyPrimesum2 = Plus @@ Prime /@ Range @ PrimePi[#] &;\nTiming[#[100000]] & /@ {myPrimeSum, myPrimesum2}\n> {{3.4375, 454396537}, {0., 454396537}}\n~~~\n\n## ç¬¬äºŒå‘¨\n\n### æ ¸å¿ƒè¯­è¨€\n\nä»€ä¹ˆæ˜¯Mathematicaæ ¸å¿ƒè¯­è¨€\n\næˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œè™½ç„¶Mathematicaæä¾›äº†ä¸€äº›å‡½æ•°å¯ä»¥è®©æˆ‘ä»¬åƒç¼–å†™Cç¨‹åºä¸€æ ·ç¼–å†™Mathematicaç¨‹åºï¼Œä½†æ˜¯è¿™æ ·ç¼–å†™å‡ºæ¥çš„ç¨‹åºçš„æ•ˆç‡å¾ˆæˆé—®é¢˜ï¼Œè€Œä¸”ç¨‹åºæœ¬èº«ä¹Ÿä¸æ˜“æ‡‚ã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬è¿˜å±•ç¤ºäº†å¦‚ä½•ç”¨æ‰€è°“Mathematicaæ ¸å¿ƒè¯­è¨€ç¼–åˆ¶å‡ºæ›´é«˜æ•ˆã€æ›´ç®€æ˜çš„ç¨‹åºã€‚å¦‚ï¼š\n\n~~~mathematica\nmyPrimesum2 = Plus @@ Prime /@ Range @ PrimePi[#] &;\n~~~\n\nè¿™é‡Œæœ‰å¾ˆå¤šç¬¦å·(`@@`ã€`/@`ã€`#`ã€`&`)ï¼Œå®ƒä»¬å…¶å®åªæ˜¯ä¸€äº›Mathematicaå†…å»ºå‡½æ•°çš„ç®€å†™å½¢å¼ï¼Œå…¶å®Œæ•´å½¢å¼ä¸ºï¼š\n\n~~~mathematica\nmyPrimesum2 = Function[n,\n  Apply[\n   Plus,\n   Map[\n    Prime,\n    Range[\n     PrimePi[n]\n     ]\n    ]\n   ]\n  ] \n~~~\n\nåœ¨Mathematicaä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨TreeFormæ¥è·å¾—ä¸€ä¸ªè¡¨è¾¾å¼çš„è¯­æ³•æ ‘ã€‚\n\n~~~mathematica\nTreeForm[(a + b^n)/z == x]\n~~~\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/math2.jpg)\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨FullFormæ¥è·å¾—ä¸€ä¸ªè¡¨è¾¾å¼åœ¨Mathematicaå†…éƒ¨çš„å®Œæ•´å½¢å¼ï¼š\n\n~~~mathematica\nFullForm[(a + b^n)/z == x]\n> FullForm[(a + b^n)/z == x]\n~~~\n\nåœ¨Mathematicaä¸­ï¼Œæ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„å¯¹è±¡å°±å«åšè¡¨è¾¾å¼\n\n1. åŸå­å¯¹è±¡æ˜¯è¡¨è¾¾å¼\n2. è‹¥$\\mathrm{F,X_1,X_2,\\cdots,X_n}$æ˜¯è¡¨è¾¾å¼ï¼Œåˆ™$\\mathrm{F[X_1,X_2,\\cdots,X_n]}$ä¹Ÿæ˜¯è¡¨è¾¾å¼ã€‚\n\nMathematicaä¸­çš„ä¸€åˆ‡å¯¹è±¡éƒ½æ˜¯è¡¨è¾¾å¼ï¼Œä¸€ä¸ªMathematicaç¨‹åºå°±æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚\n\n> è¿™ä¸€äº‹å®å¦‚æ­¤åœ°é‡è¦ï¼Œä»¥è‡³äºæœ‰äººå°†å…¶ç§°ä¸ºMathematicaçš„ç¬¬ä¸€åŸç†ï¼šä¸‡ç‰©çš†è¡¨(è¾¾å¼)ã€‚\n\nMathematicaçš„è®¡ç®—ï¼š\n\n1. ä»å¾…è®¡ç®—å¯¹è±¡ä¸­è¯†åˆ«ä¸€äº›å¯åŒ–ç®€çš„æ¨¡å¼\n2. å°†è¯†åˆ«å‡ºçš„æ¨¡å¼ç”¨å·²çŸ¥çš„è§„åˆ™è¿›è¡ŒåŒ–è§£\n\nMathematicaæ˜¯è¿™æ ·è¿›è¡Œè®¡ç®—çš„ï¼Œå…¶ä¸­ç¬¬ä¸€æ­¥å«åšæ¨¡å¼åŒ¹é…ï¼Œç¬¬äºŒæ­¥å«åšè§„åˆ™ä»£å…¥ã€‚åŸºäºæ¨¡å¼å’Œè§„åˆ™çš„è®¡ç®—æ¨¡å‹åœ¨æ•°ç†é€»è¾‘æˆ–è®¡ç®—æœºç§‘å­¦ä¸­å«åšé‡å†™ç³»ç»Ÿã€‚\n\nMathematicaç¬¬äºŒåŸç†ï¼šè®¡ç®—å³é‡å†™ã€‚\n\n### è¡¨è¾¾å¼ä¸è¡¨\n\næ ¹æ®å®šä¹‰ï¼Œä¸€ä¸ªè¡¨è¾¾å¼æˆ–è€…æ˜¯åŸå­ï¼Œæˆ–è€…æ˜¯å½¢å¦‚$\\mathrm{F[X_1,X_2,\\cdots,X_n]}$çš„å‡½æ•°ã€‚äº‹å®ä¸Šï¼ŒåŸå­ä¹Ÿå¯ä»¥çœ‹æˆåè€…çš„ç‰¹æ®Šæƒ…å†µï¼Œåªè¦æˆ‘ä»¬æŠŠå‡½æ•°çš„è‡ªå˜é‡ä¸ªæ•°å–æˆé›¶å°±è¡Œäº†ã€‚æ‰€ä»¥ï¼Œä»¥åæˆ‘ä»¬è®¨è®ºè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œæ€»æŠŠå®ƒå†™æˆ$\\mathrm{F[X_1,X_2,\\cdots,X_n]}$çš„æ ·å­ã€‚\n\nç»™å®šä¸€ä¸ªè¡¨è¾¾å¼$\\mathrm{F[X_1,X_2,\\cdots,X_n]}$ï¼Œæˆ‘ä»¬ç§°$\\mathrm{F}$æ˜¯å®ƒçš„\"å¤´\"ã€‚\n\n~~~mathematica\nHead /@ {1, 1/2, True, \"number\", a + b, a - b, a*b, \n  a/b, (f + g)[x1, x2, x3]}\n> {Integer, Rational, Symbol, String, Plus, Plus, Times, Times, f + g}\n~~~\n\næˆ‘ä»¬å‘ç°å¯¹äºåŸå­è¡¨è¾¾å¼ï¼šç¬¦å·çš„å¤´æ€»æ˜¯Symbolï¼›æ•°å­—çš„å¤´åˆ™ä¾èµ–äºå®ƒçš„ç±»å‹ï¼Œç»“æœå¯ä»¥æ˜¯Integerã€Rationalã€Realå’ŒComplexï¼›å­—ç¬¦ä¸²çš„å¤´æ€»æ˜¯Stringï¼›å›¾ç‰‡çš„å¤´æ˜¯Imageç­‰ç­‰ã€‚\n\nåˆ©ç”¨è¿™ä¸ªæ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦æ˜¯åŸå­ã€‚\n\n~~~mathematica\nmyAtomQ = \n  Function[ex, \n   MemberQ[{Symbol, Integer, Rational, Reals, Complex, String, \n     Image}, Head[ex]]];\n~~~\n\né™¤äº†å¤´ä»¥å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¸¸å¸¸éœ€è¦å°†è¡¨è¾¾å¼çš„å‚æ•°éƒ¨åˆ†å–å‡ºæ¥ã€‚å–å‡ºæ¥çš„ä¸œè¥¿ä¸€äº›è¡¨è¾¾å¼æ„æˆçš„åºåˆ—ï¼Œæ˜¯æ²¡æœ‰å¤´çš„ã€‚ä½†æ˜¯åœ¨Mathematicaé‡Œæ‰€æœ‰çš„è¡¨è¾¾å¼éƒ½å¿…é¡»æœ‰å¤´ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†å¤„ç†è¿™ç§æ— å¤´è¡¨è¾¾å¼ï¼ŒMathematicaå¼•å…¥è¡¨(List)è¿™ä¸ªæ¦‚å¿µï¼Œç„¶åè§„å®šæ‰€å“Ÿæ— å¤´è¡¨è¾¾å¼çš„å¤´éƒ½æ˜¯Listã€‚\n\n~~~mathematica\nex = f[x1, x2, x3];\nList @@ ex\nApply[g, ex]\n(*å¯ä»¥å°†Applyå‡½æ•°ç†è§£ä¸ºæ¢å¤´*)\n> {x1, x2, x3}\n> g[x1, x2, x3]\n~~~\n\nè¡¨è¿™ç§è¡¨è¾¾å¼è¿˜æœ‰ä¸€ç§å˜ä½“ï¼Œå«åšåºåˆ—(Sequence)ã€‚åºåˆ—å¯ä»¥è®¤ä¸ºæ˜¯æ²¡æœ‰ä¸¤è¾¹èŠ±æ‹¬å·(\"{}\")çš„è¡¨ï¼Œæˆ–è€…è¯´ï¼Œè¡¨æ˜¯ç”¨åºåˆ—çš„å…ƒç´ åšæˆäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè€Œåºåˆ—æ˜¯æŸç§æ›´åŸå§‹çš„ä¸œè¥¿ã€‚\n\n~~~mathematica\nex = h[1, 2, 3];\nseq = Sequence @@ ex\nlst = List @@ ex\n> Sequence[1, 2, 3]\n> {1, 2, 3}\n~~~\n\n~~~mathematica\nf[seq]\nf[lst]\nf @@ lst\nf[seq, lst, 4, 5, 6]\n> f[1, 2, 3]\n> f[{1, 2, 3}]\n> f[1, 2, 3]\n> f[1, 2, 3, {1, 2, 3}, 4, 5, 6]\n~~~\n\nä¸Šé¢çš„ä¾‹å­è¡¨æ˜ï¼Œå½“æˆ‘ä»¬æƒ³æŠŠä¸€ä¸ªè¡¨è¾¾å¼çš„å‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œç”¨Listæ¢å¤´çš„ç»“æœå¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºå¤šäº†ä¸€å±‚èŠ±æ‹¬å·ã€‚å¦‚æœä¸æƒ³è¦è¿™å±‚èŠ±æ‹¬å·ï¼Œå°±è¦ç”¨Sequenceæ¢å¤´ã€‚\n\né™¤äº†ç”¨Headå’ŒApplyä»¥å¤–ï¼ŒMathematicaè¿˜æä¾›äº†å¦ä¸€ç§è®¿é—®å¤åˆè¡¨è¾¾å¼å†…éƒ¨è¡¨è¾¾å¼çš„æ–¹æ³•ï¼Œå³ç³»ç»Ÿå†…å»ºå‡½æ•°Partï¼Œç®€å†™å½¢å¼ä¸º`[[...]]`ã€‚\n\n~~~mathematica\nex = f[x1, x2, x3];\n{ex[[0]], ex[[1]], ex[[2]], ex[[3]]}\n> {f, x1, x2, x3}\n~~~\n\nå¯¹äºåµŒå¥—çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¤šæ¬¡åœ°å–Partï¼š\n\n~~~mathematica\nex = f[a, g[b, c], h[d, k[e, i], j]];\nex[[3]][[2]][[2]]\n> i\n~~~\n\nè¿™ä¸ªæ“ä½œå¯ä»¥é€šè¿‡ä¸€ä¸ªPartå®ç°ï¼š\n\n~~~mathematica\nex[[3, 2, 2]]\n> i\n~~~\n\nå¦å¤–Partè¿˜æœ‰æ›´å¤šçš„ç”¨æ³•ï¼š\n\n~~~mathematica\nex[[-1, -2, -1]]\nex[[{2, 3}]]\nex[1 ;; 2]\nex[[1 ;; 3 ;; 2]]\n> i\n> f[g[b, c], h[d, k[e, i], j]]\n> f[a, g[b, c], h[d, k[e, i], j]][1 ;; 2]\n> f[a, h[d, k[e, i], j]]\n~~~\n\næœ€å¸¸ç”¨çš„Partéƒ½æœ‰å±äºå®ƒä»¬è‡ªå·±çš„å†…å»ºå‡½æ•°ï¼š\n\n~~~mathematica\nFunction[op, op[f[x1, x2, x3, x4]]] /@ {First, Last, Rest, Most}\n> {x1, x4, f[x2, x3, x4], f[x1, x2, x3]}\nTake[f[x1, x2, x3, x4], {2, 3}]\nDrop[f[x1, x2, x3, x4], {2, 3}]\n> f[x2, x3]\n> f[x1, x4]\n~~~\n\nå¯¹äºTakeå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ›¿ä»£ï¼š\n\n~~~mathematica\nf[x1, x2, x3, x4][[{2, 3}]]\n> f[x2, x3]\n~~~\n\nå¯¹äºç»™å®šçš„è¡¨è¾¾å¼ï¼Œæœ‰ä¸¤ä¸ªå€¼å¾ˆé‡è¦ï¼Œå³å®ƒçš„é•¿åº¦å’Œæ·±åº¦ï¼š\n\n~~~mathematica\nLength[f[g[x1, h[x2, x3]], x4]]\nDepth[f[g[x1, h[x2, x3]], x4]]\n> 2\n> 4\n~~~\n\n### è¡¨çš„æ„é€ \n\n~~~mathematica\nRange[10]\nRange[2, 10]\nRange[2, 10, 3]\n> {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\n> {2, 3, 4, 5, 6, 7, 8, 9, 10}\n> {2, 5, 8}\n~~~\n\n~~~mathematica\nTable[i^2 + i + 1, {i, 10}]\nTable[KroneckerDelta[i, j - 1] + t KroneckerDelta[i, j + 4], {i, \n   5}, {j, 5}] // MatrixForm\n> {3, 7, 13, 21, 31, 43, 57, 73, 91, 111}\n~~~\n\n$$\n\\left(\\begin{array}{lllll}\n0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 1 \\\\\nt & 0 & 0 & 0 & 0\n\\end{array}\\right)\n$$\n\n~~~mathematica\nArray[#^2 + # + 1 &, 10]\n> {3, 7, 13, 21, 31, 43, 57, 73, 91, 111}\n#^2 + # + 1 & /@ Range[10]\n> {3, 7, 13, 21, 31, 43, 57, 73, 91, 111}\n\nArray[f, 5, 2, h](*5æŒ‡çš„æ˜¯é•¿åº¦ï¼Œ2æŒ‡çš„æ˜¯èµ·å§‹ä½ç½®ï¼ŒhæŒ‡çš„æ˜¯å¤´*)\n> h[f[2], f[3], f[4], f[5], f[6]]\n~~~\n\n~~~mathematica\nTuples[Range[3], 2]\n> {{1, 1}, {1, 2}, {1, 3}, {2, 1}, {2, 2}, {2, 3}, {3, 1}, {3, 2}, {3, \n  3}}\nOuter[f, Range[3], Range[2]]\n> {{f[1, 1], f[1, 2]}, {f[2, 1], f[2, 2]}, {f[3, 1], f[3, 2]}}\n~~~\n\n### è¡¨çš„æŸ¥è¯¢å’Œæœç´¢\n\n~~~mathematica\nex = f[x1, x2, x3, x4];\nFunction[i, MemberQ[ex, i]] /@ {f, x1, x2, x3, x4, x5, x6}\nFunction[i, FreeQ[ex, i]] /@ {f, x1, x2, x3, x4, x5, x6}\n> {False, True, True, True, True, False, False}\n> {False, False, False, False, False, True, True}\n~~~\n\nå¯ä»¥çœ‹å‡ºMemberQå’ŒFreeQç»“æœå¹¶ä¸æ˜¯ç›¸åçš„ã€‚\n\nMemberQå‡½æ•°è¿˜æœ‰å‚æ•°ï¼š\n\n~~~mathematica\nMemberQ[ex, f, Heads -> True]\n> True\n~~~\n\nFreeQå‡½æ•°å¯ä»¥æŒ‡å®šæ·±åº¦ï¼ˆé»˜è®¤æ·±åº¦æ˜¯æ‰€æœ‰æ·±åº¦éƒ½æŸ¥æ‰¾ï¼‰ï¼š\n\n~~~mathematica\nFreeQ[{{1, 1, 3, 0}, {2, 1, 2, 2}}, 0]\nFreeQ[{{1, 1, 3, 0}, {2, 1, 2, 2}}, 0, 1](*åœ¨ç¬¬ä¸€å±‚æœç´¢*)\n> False\n> True\n~~~\n\nè¿˜æœ‰Countå‡½æ•°(é»˜è®¤åªçœ‹ç¬¬ä¸€å±‚)ï¼š\n\n~~~mathematica\neuler = (a + b^n)/n == x;\n{Count[euler, n], Count[euler, n, Infinity]}\n> {0, 2}\n~~~\n\nPositionå¯ä»¥æ‰¾åˆ°ä½ç½®ï¼š\n\n~~~mathematica\nPosition[euler, n]\nPosition[euler, n, 4]\nPosition[euler, n, {4}](*å¸¦{}è¡¨ç¤ºåªæœè¿™ä¸€å±‚ï¼Œä¸å¸¦è¡¨ç¤ºæœ€æ·±æœåˆ°è¿™å±‚*)\nFunction[level, Position[euler, n, level]] /@ {0, 1, 2, 3, 4}\nFunction[level, Position[euler, n, level]] /@ {3, 4}\nFunction[level, Position[euler, n, level]] /@ {{3}, {4}}\n> {{1, 1, 2, 2}, {1, 2, 1}}\n> {{1, 1, 2, 2}, {1, 2, 1}}\n> {{1, 1, 2, 2}}\n> {{}, {}, {}, {{1, 2, 1}}, {{1, 1, 2, 2}, {1, 2, 1}}}\n> {{{1, 2, 1}}, {{1, 1, 2, 2}, {1, 2, 1}}}\n> {{{1, 2, 1}}, {{1, 1, 2, 2}}}\n~~~\n\nSelecté€‰å–æ»¡è¶³æŸä¸ªæ¡ä»¶çš„ï¼š\n\n~~~mathematica\nSelect[Prime /@ Range[10], OddQ]\nSelect[Prime /@ Range[10], Mod[#, 4] == 1 &]\n> {3, 5, 7, 11, 13, 17, 19, 23, 29}\n> {5, 13, 17, 29}\n~~~\n\n### è¡¨çš„æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹\n\nä¸‹é¢çš„æ“ä½œä¸æ”¹å˜è¡¨è¾¾å¼æœ¬èº«ï¼š\n\n~~~mathematica\nex = f[a, b, c];\n{Prepend[ex, z], Append[ex, d], Insert[ex, i, 2], Insert[ex, i, -2]}\n> {f[z, a, b, c], f[a, b, c, d], f[a, i, b, c], f[a, b, i, c]}\nex\n> f[a, b, c]\n~~~\n\nä¸‹é¢çš„æ“ä½œä¼šæ”¹å˜è¡¨è¾¾å¼ï¼š\n\n~~~mathematica\n{PrependTo[ex, z], AppendTo[ex, d]}\n> {f[z, a, b, c], f[z, a, b, c, d]}\n~~~\n\nDeleteä¹Ÿä¸æ”¹å˜åŸè¡¨è¾¾å¼ï¼š\n\n~~~mathematica\nDelete[ex, 1]\nDelete[ex, {{1}, {-1}}]\n> f[a, b, c, d]\n> f[a, b, c]\n~~~\n\nReplacePartä¹Ÿä¸æ”¹å˜ï¼š\n\n~~~mathematica\n{ReplacePart[ex, 1 -> x], ex}\n> {f[x, a, b, c, d], f[z, a, b, c, d]}\n~~~\n\nä½†æ˜¯ä¸‹é¢ä¼šæ”¹å˜ï¼š\n\n~~~mathematica\nex[[1]] = y;\nex\n> f[y, a, b, c, d]\n~~~\n\nä¸‹é¢çš„æ˜¯æ—‹è½¬çš„å‡½æ•°ï¼š\n\n~~~mathematica\nReverse[ex]\nRotateLeft[ex, 2]\nRotateRight[ex, -1]\n> f[d, c, b, a, y]\n> f[b, c, d, y, a]\n> f[a, b, c, d, y]\n~~~\n\n### é›†åˆè¿ç®—\n\nå¤´éƒ¨ä¸€æ ·çš„è¡¨è¾¾å¼ä¹‹é—´çš„é›†åˆè¿ç®—ï¼š\n\n~~~mathematica\nJoin[f[x1, x2], f[x1, x3]]\n> f[x1, x2, x1, x3]\nUnion[f[x1, x2, x1, x3]]\n> f[x1, x2, x3]\nIntersection[f[x1, x2, x3], f[x1, x2, x4]]\n> f[x1, x2]\nComplement[f[x1, x2, x3], f[x1, x2, x4]]\n> f[x3]\n~~~\n\n### æ’åº\n\n~~~mathematica\nlist = Array[RandomInteger[10] &, {20, 2}]\nSort[list]\n> {{8, 0}, {6, 7}, {4, 3}, {2, 10}, {9, 6}, {1, 0}, {5, 10}, {8, \n  10}, {1, 1}, {8, 5}, {5, 8}, {9, 3}, {10, 7}, {4, 3}, {2, 9}, {4, \n  5}, {5, 1}, {1, 0}, {4, 3}, {5, 9}}\n> {{1, 0}, {1, 0}, {1, 1}, {2, 9}, {2, 10}, {4, 3}, {4, 3}, {4, 3}, {4, \n  5}, {5, 1}, {5, 8}, {5, 9}, {5, 10}, {6, 7}, {8, 0}, {8, 5}, {8, \n  10}, {9, 3}, {9, 6}, {10, 7}}\n\nSort[list, Function[{list1, list2}, list1[[1]] < list2[[1]]]]\n> {{1, 0}, {1, 1}, {1, 0}, {2, 9}, {2, 10}, {4, 3}, {4, 5}, {4, 3}, {4, \n  3}, {5, 9}, {5, 1}, {5, 8}, {5, 10}, {6, 7}, {8, 5}, {8, 10}, {8, \n  0}, {9, 3}, {9, 6}, {10, 7}}\nSort[list, (#1[[1]] < #2[[1]]) || (#1[[1]] == #2[[1]] && #1[[2]] > #2[[2]]) &]\n> {{1, 1}, {1, 0}, {1, 0}, {2, 10}, {2, 9}, {4, 5}, {4, 3}, {4, 3}, {4, \n  3}, {5, 10}, {5, 9}, {5, 8}, {5, 1}, {6, 7}, {8, 10}, {8, 5}, {8, \n  0}, {9, 6}, {9, 3}, {10, 7}}\n  \nlist = {2, 3, 5, 1, 4}\nSort[list]\nOrdering[list]\nlist[[Ordering[list]]]\n\n> {2, 3, 5, 1, 4}\n> {1, 2, 3, 4, 5}\n> {4, 1, 2, 5, 3}\n> {1, 2, 3, 4, 5}\n~~~\n\n## ç¬¬ä¸‰å‘¨\n\nä¾‹ï¼šä¸€ç§å¸¸ç”¨çš„æé€ŸæŠ€å·§\n\n`Append`å‡½æ•°å¾ˆæ…¢ï¼Œå› ä¸ºåœ¨è¡¨çš„æœ€åæ’å…¥æ•°æ®ï¼Œéœ€è¦éå†æ•´ä¸ªè¡¨ã€‚\n\né—®é¢˜ï¼šæ‰¾åˆ°ä¸å¤§äº$n$çš„æ‰€æœ‰æ— å¹³æ–¹å› å­çš„è‡ªç„¶æ•°\n\n~~~mathematica\nsolution1 = \n  Function[n, L = {}; \n   Function[i, If[SquareFreeQ[i], AppendTo[L, i]]] /@ Range[n]; L];\nsolution2 = \n  Function[n, L = {}; \n   Function[i, If[SquareFreeQ[i], PrependTo[L, i]]] /@ Range[n]; \n   Reverse[L]];\n(*åµŒå¥—è¡¨:Flatten*)\nsolution3 = \n  Function[n, L = {}; \n   Function[i, If[SquareFreeQ[i], L = {L, i}]] /@ Range[n]; \n   Flatten[L]];\n(*æ”¶è·ä¸æ’­ç§*)\nsolution4 = \n  Function[n, \n   Reap[Function[i, If[SquareFreeQ[i], Sow[i], 0]] /@ Range[n]][[2, \n     1]]];\n\nTiming[#[50000]][[1]] & /@ {solution1, solution2, solution3, \n  solution4}\n> {1.5625, 1.34375, 0.125, 0.109375}\n~~~\n\nä½†æ˜¯Flattenå‡½æ•°ä¹Ÿå­˜åœ¨ç¼ºç‚¹ï¼Œå°±æ˜¯å½“æˆ‘ä»¬æœç´¢çš„ç»“æœä¸­å«æœ‰è¡¨æ—¶ï¼Œä¼šç ´åæˆ‘ä»¬æœç´¢ç»“æœçš„ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•è§£å†³ï¼š\n\næ±‚è§£`Pell`æ–¹ç¨‹$x^2-2y^2=1$çš„æ»¡è¶³$1\\le y\\le n$çš„è§£ã€‚\n\n~~~mathematica\nsolution5 = \n  Function[n, L = {}; \n   Do[If[IntegerQ[x = Sqrt[1 + 2 y^2]], L = {L, list[x, y]}], {y , \n     n}]; Flatten[L] /. {list -> List}];\n~~~\n\nè¿™é‡Œæ˜¯ç”¨`list`ä»£æ›¿`List`æ”¾ç½®è¢«å‹å¹³ï¼Œä¹‹ååˆè¿˜åŸã€‚\n\nä½†æ”¶è·ä¸æ’­ç§ä¸å­˜åœ¨æ­¤ç±»é—®é¢˜ï¼š\n\n~~~mathematica\nsolution6 = \n Function[n, \n  Reap[Do[If[IntegerQ[x = Sqrt[1 + 2 y^2]], Sow[{x, y}]], {y, n}]][[2,\n     1]]]\n~~~\n\næ”¶è·ä¸æ’­ç§æ˜¯å¾ˆæœ‰ç”¨çš„ä¸€ç§æ„é€ è¡¨çš„æ–¹æ³•ï¼Œå®ƒä»¬è¿˜æœ‰æ›´é«˜çº§çš„ç”¨æ³•ï¼šæ’­ç§çš„æ—¶å€™å¯ä»¥ç»™æ¯ä¸ªç§å­åŠ æ ‡ç­¾ï¼Œæ”¶è·æ—¶å¯ä»¥æŒ‰ç…§æ ‡ç­¾æˆ–æ¨¡å¼åŒ¹é…è¿›è¡Œæ”¶è·ã€‚\n\n~~~mathematica\nReap[\n Sow[å¼ ä¸‰, {æŠ«è¨, å¯ä¹, é¸¡ç¿…}];\n Sow[æå››, {æ„é¢, å¯ä¹, é¸¡ç¿…}];\n Sow[ç‹äº”, {æŠ«è¨, é›ªç¢§, è–¯æ¡}];\n Sow[åˆ˜å…­, {æ„é¢, çº¢èŒ¶, æ²™æ‹‰}];\n Sow[é™ˆä¸ƒ, {æŠ«è¨, å¯ä¹, è–¯æ¡}];\n Sow[æ¨å…«, {æ„é¢, æ©™æ±, æ²™æ‹‰}];,\n çº¢èŒ¶\n ]\n > Null, {{åˆ˜å…­}}}\n \n Reap[\n Sow[å¼ ä¸‰, {æŠ«è¨, å¯ä¹, é¸¡ç¿…}];\n Sow[æå››, {æ„é¢, å¯ä¹, é¸¡ç¿…}];\n Sow[ç‹äº”, {æŠ«è¨, é›ªç¢§, è–¯æ¡}];\n Sow[åˆ˜å…­, {æ„é¢, çº¢èŒ¶, æ²™æ‹‰}];\n Sow[é™ˆä¸ƒ, {æŠ«è¨, å¯ä¹, è–¯æ¡}];\n Sow[æ¨å…«, {æ„é¢, æ©™æ±, æ²™æ‹‰}];,\n _, #1 -> #2 &\n ]\n \n > {Null, {æŠ«è¨ -> {å¼ ä¸‰, ç‹äº”, é™ˆä¸ƒ}, å¯ä¹ -> {å¼ ä¸‰, æå››, é™ˆä¸ƒ}, é¸¡ç¿… -> {å¼ ä¸‰, æå››}, \n  æ„é¢ -> {æå››, åˆ˜å…­, æ¨å…«}, é›ªç¢§ -> {ç‹äº”}, è–¯æ¡ -> {ç‹äº”, é™ˆä¸ƒ}, çº¢èŒ¶ -> {åˆ˜å…­}, \n  æ²™æ‹‰ -> {åˆ˜å…­, æ¨å…«}, æ©™æ± -> {æ¨å…«}}}\n~~~\n\n`,`åçš„è¡¨ç¤ºæ¨¡å¼åŒ¹é…,`_`è¡¨ç¤ºæ‰€æœ‰æ¨¡å¼éƒ½å¯ï¼Œè€Œåé¢çš„ä¸ºåŒ¿åå‡½æ•°ã€‚\n\n### æ¨¡å¼åŒ¹é…\n\næˆ‘ä»¬å·²ç»æè¿‡Mathematicaçš„ç¬¬äºŒåŸç†ï¼šè®¡ç®—å³é‡å†™ã€‚é‡å†™åˆ†ä¸¤æ­¥ã€åˆ†åˆ«æ˜¯æ¨¡å¼åŒ¹é…å’Œè§„åˆ™ä»£å…¥ã€‚æˆ‘ä»¬å…ˆè®²æ¨¡å¼åŒ¹é…ã€‚\n\næ‰€è°“æ¨¡å¼ï¼Œæ˜¯æŒ‡æ»¡è¶³ä¸€å®šæ¡ä»¶çš„è¡¨è¾¾å¼æ„æˆçš„é›†åˆã€‚è€Œæ¨¡å¼åŒ¹é…ï¼Œå°±æ˜¯ä»ç»™å®šçš„å¾…è®¡ç®—è¡¨è¾¾å¼ä¸­æœç´¢å‡ºç¬¦åˆæŸç§æ¨¡å¼ï¼ˆå³è¾“å…¥è¿™ä¸ªé›†åˆï¼‰çš„å­è¡¨è¾¾å¼ã€‚æ¨¡å¼åŒ¹é…å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹è¿™äº›åŒ¹é…å‡ºæ¥çš„å­è¡¨è¾¾å¼åº”ç”¨è®¡ç®—è§„åˆ™ï¼Œä»è€Œè¾¾åˆ°è®¡ç®—æˆ–åŒ–ç®€çš„ç›®çš„ã€‚æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æœ¬èº«å°±æ˜¯æŸç§æœç´¢ç»“æœï¼Œå¦‚æœå–„ç”¨æ¨¡å¼åŒ¹é…ï¼Œå°±å¯ä»¥å†™å‡ºéå¸¸é«˜æ•ˆçš„ç¨‹åºã€‚\n\næ ¹æ®å®šä¹‰ï¼Œå•ä¸ªè¡¨è¾¾å¼ä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§æ¨¡å¼ï¼Œå®ƒåªåŒ…å«ä¸€ä¸ªè¡¨è¾¾å¼ä½œä¸ºå…¶å…ƒç´ ï¼Œè¿™åœ¨æ¨¡å¼åŒ¹é…çš„æ—¶å€™ä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ã€‚ä¸è¿‡è¿™ç§æ¨¡å¼å¤ªç®€å•äº†ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå¹³å‡¡æ¨¡å¼ï¼Œæˆ‘ä»¬åé¢è®¨è®ºæ¨¡å¼æ—¶ä¸€èˆ¬æ€»å‡è®¾æ˜¯éå¹³å‡¡çš„ã€‚\n\næœ€ç®€å•çš„(éå¹³å‡¡)çš„æ¨¡å¼æ˜¯`_`ï¼Œå…¨å`Blank[]`ï¼Œå®ƒä»£è¡¨ä¸€åˆ‡è¡¨è¾¾å¼ã€‚\n\n~~~mathematica\nFullForm /@ {f[_], g[_, _], _[x, y], _[_, _, _]}\n> {f[Blank[]],g[Blank[],Blank[]],Blank[][x,y],Blank[][Blank[],Blank[],Blank[]]}\n\nFullForm /@ {_ + _, _ - _, _*_, _^_}\n> {Times[2,Blank[]],0,Power[Blank[],2],Power[Blank[],Blank[]]}\n~~~\n\n~~~mathematica\nMatchQ[a + b, _ + _]\nMatchQ[a + a, _ + _]\nMatchQ[a - b, _ - _]\nMatchQ[a - a, _ - _]\nMatchQ[a*b, _*_]\nMatchQ[a*a, _*_]\nMatchQ[a/b, _/_]\nMatchQ[a/a, _/_]\nMatchQ[g[a, b], _[_, _]]\n> False\n> True\n> False\n> True\n> False\n> True\n> False\n> True\n> True\n~~~\n\n`+,-,/,*`ä¸ºå…·ä½“çš„äºŒå…ƒè¿ç®—ï¼Œè€Œ`g`ä¸ºæŠ½è±¡çš„äºŒå…ƒè¿ç®—ï¼Œæ‰€ä»¥ç»“æœå¯èƒ½æœ‰æ‰€ä¸åŒã€‚\n\næˆ‘ä»¬å¯ä»¥å°†åŒ¹é…å¥½çš„æ¨¡å¼å‘½åï¼Œå…¶å®Œæ•´å½¢å¼ä¸ºPattern[name, pattern]ï¼Œç®€å†™å½¢å¼æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«å¯¹åº”äºä¸åŒçš„ä¼˜å…ˆçº§ã€‚\n\n~~~mathematica\nFullForm[x_]\nFullForm[x : _]\nFullForm[x_[_]]\nFullForm[x : _[_]]\n> Pattern[x,Blank[]]\n> Pattern[x,Blank[]]\n> Pattern[x,Blank[]][Blank[]]\n> Pattern[x,Blank[][Blank[]]]\n~~~\n\nå¦‚æœåœ¨ä¸€ä¸ªæ¨¡å¼ä¸­ï¼ŒåŒä¸€ä¸ªå‘½åæ¨¡å¼å‡ºç°äº†å¤šæ¬¡ï¼Œå®ƒä»¬ä¼šè¢«è®¤ä¸ºæ˜¯åŒæ ·çš„ã€‚\n\n~~~mathematica\nMatchQ[f[a, a], f[x_, x_]]\nMatchQ[f[a, b], f[x_, x_]]\nMatchQ[f[a, b], f[x_, y_]]\n> True\n> False\n> True\n~~~\n\næ³¨æ„æ¨¡å¼åŒ¹é…æ˜¯æŒ‰Mathematicaå†…éƒ¨çš„FullFormåŒ¹é…çš„ï¼Œå®ƒæ€»æ˜¯åŸºäºç»“æ„çš„ï¼Œè€ŒéåŸºäºæ•°å­¦çš„ã€‚ä¾‹å¦‚å½“æˆ‘ä»¬åŒ¹é…`x^_`è¿™ä¸ªæ¨¡å¼æ—¶ï¼Œ`x`æœ¬èº«å¹¶ä¸ä¼šåŒ¹é…åˆ°ï¼Œå°½ç®¡åœ¨æ•°å­¦ä¸Š$x=x^1$ã€‚\n\n~~~mathematica\n{1, x, x^2, x^3} /. {x^n_ :>  p[n]}\n> 1, x, p[2], p[3]}\n~~~\n\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼š\n\n~~~mathematica\n{1, x, x^2, x^3} /. {x^n_ :>  p[n], 1 -> p[0], x -> p[1]}\n> {p[0], p[1], p[2], p[3]}\n~~~\n\nä½†æ˜¯å¦‚æœæœ‰æ¶‰åŠåˆ°å¸¦æœ‰äº¤æ¢æ€§ã€ç»“åˆæ€§çš„å‡½æ•°ï¼ŒMathematicaä¹Ÿä¼šå˜å¾—èªæ˜ä¸€äº›ã€‚\n\n~~~mathematica\n{a + b, b + c, Plus[a, Plus[b, c]]} /. {b + x_  :> x}\n> {a, c, a + c}\n~~~\n\nè¿™æ˜¯å› ä¸ºPlusè¿™ä¸ªå‡½æ•°åœ¨Mathematicaå†…éƒ¨å…·æœ‰Flatå’ŒOrderlessä¸¤ç§å±æ€§ï¼Œåˆ†åˆ«å¯¹åº”äºç»“åˆæ€§å’Œäº¤æ¢æ€§ã€‚Mathematicaåœ¨åšæ¨¡å¼åŒ¹é…çš„æ—¶å€™ä¼šè€ƒè™‘è¿™äº›å±æ€§å¯¼è‡´çš„ä¸€äº›ç­‰ä»·å½¢å¼ï¼Œå¦‚Plus[a,b] = Plus[b,a]ï¼ŒPlus[a,Plus[b,c]] = Plus[b, Plus[a,c]]ç­‰ç­‰ã€‚\n\næˆ‘ä»¬å¯ä»¥ç”¨Caseså‡½æ•°æ¥åˆ—å‡ºæ‰€åŒ¹é…çš„ä¸œè¥¿ï¼Œä¸æŒ‡å®šæ·±åº¦åªæœç¬¬ä¸€å±‚ï¼š\n\n~~~mathematica\nCases[1 + x + f[x^2, x^3], x^_]\nCases[1 + x + f[x^2, x^3], x^_, Infinity]\n> {}\n> {x^2, x^3}\n~~~\n\n~~~mathematica\nMax[Cases[a0 + a1 x + a2 x^2 + a3 x^3, x^n_ :> n, Infinity]]\n> 3\n~~~\n\nå¯ä»¥ç”¨æ¨¡å¼åŒ¹é…æ¨¡å¼ï¼š\n\n~~~mathematica\nCases[{a -> b, c -> d}, HoldPattern[a -> _]]\n> {a -> b}\n~~~\n\nè¿˜å¯ä»¥ç”¨DeleteCaseså»æ‰è¢«åŒ¹é…åˆ°çš„ä¸œè¥¿ã€‚\n\n~~~mathematica\nDeleteCases[f[x] + g[y], f[_]]\n> g[y]\nDeleteCases[CoefficientList[(1 + x)^10 + (1 - x)^10, x], 0]\n> {2, 90, 420, 420, 90, 2}\n(*CoefficientListæ±‚å¤šé¡¹å¼ç³»æ•°*)\n~~~\n\næ¯”ç®€å•åŒ¹é…ç¨å¾®å¤æ‚ä¸€ç‚¹çš„æ˜¯ç±»å‹åŒ¹é…ï¼Œå®Œæ•´å½¢å¼ä¸ºBlank[head]ï¼š\n\n~~~mathematica\nCases[{1, 2.5, x, y, f[x]}, _f]\nCases[{1, 2.5, x, y, f[x]}, _Symbol]\nCases[{1, 2.5, x, y, f[x]}, _Integer]\nCases[{1, 2.5, x, y, f[x]}, _Real]\n> {f[x]}\n> {x,y}\n> {1}\n> {2.5}\n~~~\n\næ›´å¤æ‚çš„æ˜¯å¸¦æ¡ä»¶çš„æ¨¡å¼ï¼š\n\n~~~mathematica\nCases[{1, 2, 3, 4, 5, 6, x, y}, _?(EvenQ[(# + #^2)/2] &)]\nCases[{1, 2, 3, 4, 5, 6, x, y}, _?(Not@EvenQ[(# + #^2)/2] &)]\nCases[{1, 2, 3, 4, 5, 6, x, y}, Except[_?(EvenQ[(# + #^2)/2] &)]]\nCases[{1, 2, 3, 4, 5, 6, x, y}, \n Except[_?(EvenQ[(# + #^2)/2] &), _?NumberQ]]\n > {3, 4}\n > {1, 2, 5, 6, x, y}\n > {1, 2, 5, 6, x, y}\n > 1, 2, 5, 6}\n~~~\n\n`Except[c,p]`æ»¡è¶³`p`ä½†ä¸æ»¡è¶³`c`ã€‚\n\nä¸å‘½åç±»ä¼¼ï¼Œæ¡ä»¶ä¹Ÿæœ‰æ›´ä½ä¼˜å…ˆçº§çš„ä¸€ç§ç®€å†™å½¢å¼ï¼š\n\n~~~mathematica\nCases[{{1, 2}, {2, 3}, {3, 1}}, _?(#[[1]] < #[[2]] &)]\nCases[{{1, 2}, {2, 3}, {3, 1}}, {x_, y_} /; x < y]\n> {{1, 2}, {2, 3}}\n> {{1, 2}, {2, 3}}\n~~~\n\nè¿ç®—ç¬¦`/;`ç»å¸¸è¢«ç”¨æ¥å®šä¹‰åˆ†æƒ…å†µçš„å‡½æ•°ï¼Œå¦‚è‘—åçš„$3x+1$é—®é¢˜ï¼š\n\n~~~mathematica\nf[n_] := n/2 /; EvenQ[n]\nf[n_] := 3 n + 1 /; OddQ[n]\n~~~\n\nå¦‚ä½•å®šä¹‰åŒçº¿æ€§è¿ç®—ï¼Ÿ\n\n~~~mathematica\ninner[x1_ + x2_, x3_] := inner[x1, x3] + inner[x2, x3]\ninner[x1_, x2_ + x3_] := inner[x1, x2] + inner[x1, x3]\ninner[a_?NumberQ x1_, x2_] := a inner[x1, x2]\ninner[x1_, a_?NumberQ x2_] := a inner[x1, x2]\n\ninner[3 x + 2 y, z/2]\n> 3/2 inner[x, z] + inner[y, z]\n~~~\n\næœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹å¥½å‡ ç§æƒ…å†µåšåŒä¸€ç§è§„åˆ™ä»£å…¥ï¼Œè¿™æ—¶å€™å°±éœ€è¦\"æˆ–ç„¶åŒ¹é…\"ï¼Œå…¶å½¢å¼ä¸º`p1|p2|p3`ï¼š\n\n~~~mathematica\n{1, 1/2, 0.25, 3 + 4 I} /. {_Rational -> 0, _Real -> 0}\n{1, 1/2, 0.25, 3 + 4 I} /. {_Rational | _Real -> 0}\nCases[Symbol /@ CharacterRange[\"a\", \"z\"], Except[a | e | i | o | u]]\n> {1, 0, 0, 3 + 4 I}\n> {1, 0, 0, 3 + 4 I}\n> {b, c, d, f, g, h, j, k, l, m, n, p, q, r, s, t, v, w, x, y, z}\n~~~\n\nä¹‹å‰æ¨¡å¼åŒ¹é…éƒ½æ˜¯é’ˆå¯¹ä¸€ä¸ªè¡¨è¾¾å¼çš„ï¼Œæ¨¡å¼åŒ¹é…è¿˜å¯ä»¥å¯¹è¡¨è¾¾å¼åºåˆ—è¿›è¡Œã€‚\n\n~~~mathematica\n{f[], f[x], f[x, y]} /. {f[a__] :> {a}}\n{f[], f[x], f[x, y]} /. {f[a___] :> {a}}\n> {f[], {x}, {x, y}}\n> {{}, {x}, {x, y}}\n~~~\n\nä¸¤ä¸ªä¸‹åˆ’çº¿å¯¹äºç©º(0ä¸ªè¡¨è¾¾å¼ï¼Œå¯¹åº”äºf[]æ— è¡¨è¾¾å¼)ä¸åŒ¹é…ï¼Œä¸‰ä¸ªä¸‹åˆ’çº¿åŒ¹é…ç©ºä¸ºç©ºã€‚\n\nä¾‹å­ï¼šåˆ¤æ–­è¡¨ä¸­å…ƒç´ æ˜¯å¦éƒ½æ˜¯ç´ æ•°ã€‚\n\n~~~mathematica\nlistPrimeQ[list_] := \n Not@MatchQ[list, {___, _?(Not[PrimeQ[#]] &), ___}]\n (*å‰åä¸¤ä¸ª___ï¼Œè¡¨ç¤ºå‰é¢æœ‰0ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼ï¼Œä¸­é—´çš„ä¸èƒ½ä¸ºç´ æ•°*)\nlist = Array[#^2 + # + 41 &, 40, 0]\nlistPrimeQ[list]\n> True\n~~~\n\nç”¨Longestå’ŒShortestå¯ä»¥æ§åˆ¶`__`å’Œ`___`çš„åŒ¹é…é•¿åº¦ï¼š\n\n~~~mathematica\n{a, b, c, d, e, f, g} /. {x__, y__, z__} -> {{x}, {y}, {z}}\n{a, b, c, d, e, f, g} /. {x__, Longest[y__], z__} -> {{x}, {y}, {z}}\n> {{a}, {b}, {c, d, e, f, g}}\n> {{a}, {b, c, d, e, f}, {g}}\n~~~\n\né‡å¤æ¨¡å¼ï¼š\n\n~~~mathematica\nCases[{f[a], f[a, b], f[a, a], f[a, a, a]}, f[a ..]]\nCases[{f[a], f[a, b], f[a, a], f[a, a, a]}, f[Repeated[a]]]\nCases[{f[a], f[a, b], f[a, a], f[a, a, a]}, f[Repeated[a, 2]]]\nCases[{f[a], f[a, b], f[a, a], f[a, a, a]}, f[Repeated[a, {2, 3}]]]\n> {f[a], f[a, a], f[a, a, a]}\n> {f[a], f[a, a], f[a, a, a]}\n> {f[a], f[a, a]}\n> {f[a, a], f[a, a, a]}\n~~~\n\næ¨¡å¼åºåˆ—ï¼š\n\n~~~mathematica\nf[x : PatternSequence[_, _], y___] := p[{x}, {y}]\n{f[1], f[1, 2], f[1, 2, 3, 4, 5]}\n> {f[1], p[{1, 2}, {}], p[{1, 2}, {3, 4, 5}]}\n{a, b, b, a, b, a, b, a, a, \n  b} /. {___, x : Longest[PatternSequence[a, b] ..], ___} :> {x}\n> {a, b, a, b}\n~~~\n\næ¨¡å¼çš„é»˜è®¤å€¼ï¼š\n\n~~~mathematica\nplus[x_: 0, y_: 0] := x + y;\nplus[]\nplus[x]\nplus[x, y]\n> 0\n> x\n> x+y\n~~~\n\n~~~mathematica\n{1, x, x^2, x^3} /. {x^n_ :> n}\n{1, x, x^2, x^3} /. {x^n_. :>  n}(*ç›¸å½“äºæŠŠPowerå‡½æ•°çš„é»˜è®¤å€¼ä¹Ÿè€ƒè™‘è¿›å»äº†*)\n> {1, x, 2, 3}\n> {1, 1, 2, 3}\n~~~\n\nå­—é¢æ¨¡å¼ï¼š\n\n~~~mathematica\n{f[2], f[a], f[x_], f[y_]} /. f[x_] :> x^2\n{f[2], f[a], f[x_], f[y_]} /. f[Verbatim[x_]] :> x^2\n> {4, a^2, x_^2, y_^2}\n> {f[2], f[a], x^2, f[y_]}\n~~~\n\n","tags":["Mathematica","ç¼–ç¨‹"],"categories":["è¯¾ç¨‹ç¬”è®°"]},{"title":"Statistical Rethinking:Chapter3","url":"/2022/06/29/rt3/","content":"\n## Sampling the Imaginary\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt3_1.png)\n\n<!--more-->\n\n### Sampling from a grid-approximate\n\næˆ‘ä»¬å…ˆç”¨ç¬¬äºŒç« çš„ä¾‹å­ç”ŸæˆåéªŒåˆ†å¸ƒï¼š\n\n~~~R\np_grid <- seq(from=0, to=1, length.out=1000)\nprior <- rep(1, 1000)\nlikelihood <- dbinom(6, size = 9, prob = p_grid)\nposterior <- likelihood * prior\nposterior <- posterior / sum(posterior)\n~~~\n\nä¸‹é¢æˆ‘ä»¬å¯¹åéªŒè¿›è¡ŒæŠ½æ ·ï¼ŒæŠ½å–$10000$ä¸ªæ ·æœ¬ï¼š\n\n~~~R\n# sample\nsamples <- sample(p_grid, prob = posterior, size = 1e4, replace = TRUE)\n# plot(samples)\ndens(samples)\n~~~\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt3_2.jpeg)\n\n### Sampling to summarize\n\nå¯¹æ ·æœ¬è¿›è¡Œæ€»ç»“ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š\n\n1. å®šä¹‰è¾¹ç•Œçš„åŒºé—´\n2. å®šä¹‰æ¦‚ç‡è´¨é‡åŒºé—´çš„é—®é¢˜\n3. ç‚¹ä¼°è®¡çš„é—®é¢˜\n\n#### Intervals of defined boundaries\n\n~~~R\n# add up posterior probability where p < 0.5\nsum(posterior[p_grid < 0.5])\n> 0.1718746\n\n# use samples\nsum(samples < 0.5) / 1e4\n> 0.1731\n\nsum(samples > 0.5 & samples < 0.75) / 1e4\n> 0.6037\n~~~\n\n#### Intervals of defined mass\n\n~~~R\nquantile(samples, 0.8)\n>       80% \n0.7597598 \n\nquantile(samples, c(0.1, 0.9))\n>       10%       90% \n0.4504505 0.8118118 \n~~~\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡`PI`å’Œ`HDPI`ï¼ˆhighest posterior density interval ï¼‰å‡½æ•°è®¡ç®—ç»™å®šæ¦‚ç‡è´¨é‡çš„åŒºé—´ï¼š\n\n~~~R\np_grid <- seq( from=0 , to=1 , length.out=1000 )\nprior <- rep(1,1000)\nlikelihood <- dbinom( 3 , size=3 , prob=p_grid ) \nposterior <- likelihood * prior\nposterior <- posterior / sum(posterior)\nsamples <- sample( p_grid , size=1e4 , replace=TRUE , prob=posterior )\n# center\nPI(samples, prob = 0.5)\n>       25%       75% \n0.7067067 0.9321822 \n\nHPDI(samples, prob = 0.5)\n>   |0.5      0.5| \n0.8428428 0.9979980 \n~~~\n\nä¸€èˆ¬æƒ…å†µä¸‹`PI`å’Œ`HDPI`çš„ç»“æœç›¸å·®ä¸å¤§ï¼Œä½†æ˜¯å½“æ¦‚ç‡å¯†åº¦å‡½æ•°é«˜åº¦å€¾æ–œæ—¶å…¶å€¼ä¼šå¤§ä¸ç›¸åŒã€‚\n\n#### Point estimates\n\næœ€å¤§åéªŒä¼°è®¡ï¼š\n\n~~~R\np_grid[which.max(posterior)]\n> 1\n~~~\n\nä¹Ÿå¯ä»¥æ ¹æ®æ ·æœ¬æ¥è®¡ç®—ä¼—æ•°ï¼š\n\n~~~R\nchainmode(samples, adj=0.01)\n> 0.9901787\n~~~\n\næˆ–æ˜¯å‡å€¼å’Œä¸­ä½æ•°\n\n~~~R\nmean(samples)\nmedian(samples)\n> 0.8015405\n> 0.8448448\n~~~\n\né‚£ä¹ˆæè¿°åéªŒä¼°è®¡ç”¨å“ªä¸€ä¸ªç‚¹å‘¢ï¼Ÿæœ‰æ—¶å€™æˆ‘ä»¬é‡‡ç”¨æŸå¤±å‡½æ•°è¿˜è¡¡é‡ç‚¹çš„å¥½åï¼Œä½†æ˜¯æŸå¤±å‡½æ•°çš„é€‰æ‹©ä¹Ÿä¼šå½±å“ç‚¹çš„é€‰æ‹©ï¼Œå¦‚æˆ‘ä»¬é€‰æ‹©ä¸¤ä¸ªç‚¹ä¹‹é—´è·ç¦»çš„ç»å¯¹å€¼çš„å·®å€¼ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ä¸­ä½æ•°ã€‚\n\n~~~R\nloss <- sapply(p_grid, function(d) sum(posterior*abs(d-p_grid)))\np_grid[which.min(loss)]\n> 0.8408408\n~~~\n\nå¯ä»¥çœ‹åˆ°ä¸ä¸­ä½æ•°éå¸¸æ¥è¿‘ã€‚\n\n### Sampling to simulate prediction\n\n#### Dummy data\n\nä¼¼ç„¶å‡½æ•°ä¹Ÿå¯ä»¥ç”¨æ¥äº§äº§ç”Ÿæ•°æ®ï¼Œä¾‹å¦‚æˆ‘ä»¬ä¹‹é—´çš„ä¾‹å­ï¼Œæˆ‘ä»¬çš„ä¼¼ç„¶å‡½æ•°ä¸ºï¼š\n$$\n\\Pr(w\\mid n,p) = \\frac{n!}{w!(n-w)!}p^w(1-p)^{n-w}\n$$\nä¾‹å¦‚è®¡ç®—æŠ•æ·ä¸¤æ¬¡ï¼Œåˆ†åˆ«æœ‰$0,1,2$æ¬¡æ˜¯æ°´çš„æ¦‚ç‡ï¼Œ$p=0.7$ã€‚\n\n~~~R\ndbinom(0:2, size = 2, prob = 0.7)\n> 0.09 0.42 0.49\n~~~\n\näº§ç”Ÿæ•°æ®ï¼š\n\n~~~R\nrbinom(10, size = 2, prob = 0.7)\n> 0 2 2 0 1 2 1 2 1 1\n~~~\n\nè®©æˆ‘ä»¬ä»¥$p=0.7$çš„æ¦‚ç‡æŠ•æ·$9$æ¬¡äº§ç”Ÿ$100000$ä¸ªæ•°æ®ï¼š\n\n~~~R\ndummy_w <- rbinom(1e5, size = 9, prob = 0.7)\nsimplehist(dummy_w, xlab = \"dummy water count\")\n~~~\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt3_3.jpeg)\n\n\n\n#### Model checking\n\nç°åœ¨æˆ‘ä»¬çš„æ¨¡å‹æœ‰ä¸¤ä¸ªä¸ç¡®å®šæ€§ï¼Œä¸€ä¸ªæ˜¯$p$çš„ä¸ç¡®å®šæ€§ï¼Œå› ä¸º$p$å­˜åœ¨ä¸€ä¸ªåéªŒåˆ†å¸ƒï¼Œå¦ä¸€ä¸ªæ˜¯æ ·æœ¬ç”Ÿæˆçš„ä¸ç¡®å®šæ€§ï¼Œå³ä½¿å¯¹äºå›ºå®šçš„$p$ï¼Œæ ·æœ¬çš„ç”Ÿæˆä¹Ÿæ˜¯ä¸ç¡®å®šçš„ã€‚\n\n~~~R\nw <- rbinom(1e4, size = 9, prob = samples)\nsimplehist(w)\n~~~\n\nç›¸å½“äºæˆ‘ä»¬å…ˆä»$p$çš„åéªŒåˆ†å¸ƒä¸­é‡‡æ ·$p$ï¼Œä¹‹åæ ¹æ®é‡‡æ ·å¾—åˆ°çš„$p$ç”Ÿæˆæ•°æ®ï¼Œå¾—åˆ°çš„å°±æ˜¯$p$çš„**åéªŒé¢„æµ‹åˆ†å¸ƒ**ã€‚\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt3_4.jpeg)\n\n","tags":["æ¦‚ç‡ç¼–ç¨‹","è´å¶æ–¯ç»Ÿè®¡","Statistical Rethinking"],"categories":["ä¹¦ç±é˜…è¯»"]},{"title":"Statistical Rethinking:Chapter2","url":"/2022/06/29/rt2/","content":"\n## Small Worlds and Large Worlds\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt2_1.png)\n\nå½“åˆéº¦å“²ä¼¦è¿›è¡Œç¯çƒèˆªè¡Œçš„æ—¶å€™ï¼Œé”™è¯¯åœ°è®¤ä¸ºåœ°çƒæ¯”å®é™…è¦å°ï¼Œä»–è®¤ä¸ºåœ°çƒçš„å‘¨é•¿åªæœ‰$30000$kmè€Œä¸æ˜¯$40000$kmã€‚éº¦å“²ä¼¦çš„å¤§å°ä¸–ç•Œæä¾›äº†æ¨¡å‹ä¸ç°å®çš„å¯¹æ¯”ã€‚å°ä¸–ç•Œæ˜¯æ¨¡å‹è‡ªæˆä¸€ä½“çš„é€»è¾‘ä¸–ç•Œï¼Œåœ¨è¿™ä¸ªå°ä¸–ç•Œé‡Œæˆ‘ä»¬æ ¹æ®è‡ªå·±çš„è®¤çŸ¥å¯¹æ¨¡å‹åšå‡ºä¸€ç³»åˆ—å‡è®¾å¹¶ä¸”èƒ½å¤ŸéªŒè¯æ¨¡å‹çš„é€»è¾‘ã€‚å‡è®¾å°ä¸–ç•Œæ˜¯å¯¹ç°å®ä¸–ç•Œçš„å‡†ç¡®æè¿°ï¼Œæ²¡æœ‰æ›¿ä»£æ¨¡å‹å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨æ•°æ®ä¸­çš„ä¿¡æ¯å¹¶æ”¯æŒæ›´å¥½çš„å†³ç­–ã€‚\n\nå¤§ä¸–ç•Œæ˜¯ç°å®ä¸–ç•Œï¼Œå¯èƒ½å­˜åœ¨å¾ˆå¤šæˆ‘ä»¬å°ä¸–ç•Œä¸­æ²¡æœ‰è€ƒè™‘çš„äº‹ä»¶ï¼Œæ¨¡å‹æ˜¯å¯¹ç°å®ä¸–ç•Œçš„ä¸å®Œæ•´è¡¨ç¤ºã€‚\n\n<!--more-->\n\n### The garden of forking data\n\nç»™å®šæ•°æ®ï¼Œèƒ½å¤Ÿç”¨æ›´å¤šçš„æ–¹å¼äº§ç”Ÿæ•°æ®çš„è§£é‡Šæ›´å¯é (æ¦‚ç‡æ›´å¤§)ã€‚\n\n#### Counting possibilities\n\nè€ƒè™‘ä¸‹é¢çš„ä¾‹å­ï¼Œå‡è®¾æœ‰ä¸ªè¢‹å­é‡Œæœ‰$4$ä¸ªçƒï¼Œçƒçš„é¢œè‰²ä¸ºè“è‰²å’Œç™½è‰²ï¼Œæˆ‘ä»¬æœ‰æ”¾å›åœ°å–ä¸‰ä¸ªçƒï¼Œå¾—åˆ°çš„ç»“æœä¸º**è“ç™½è“**ã€‚è¢‹å­é‡Œçš„çƒå’Œå¯¹åº”äºäº§ç”Ÿè¯¥ç»“æœçš„æ–¹å¼å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt2_2.jpg)\n\næ‰€ä»¥æˆ‘ä»¬æ¨æµ‹è¢‹å­é‡Œçš„çƒä¸ºç¬¬å››ç§çš„å¯èƒ½æ€§è¾ƒå¤§ã€‚\n\n#### Using prior information\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥ç»“åˆå…ˆéªŒä¿¡æ¯ã€‚å‡è®¾æˆ‘ä»¬åˆä»è¢‹å­é‡ŒæŠ½å‡ºæ¥ä¸€ä¸ªçƒä¸ºè“è‰²ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸Šé¢å¾—åˆ°çš„ç»“æœå°±å¯ä»¥ä½œä¸ºå…ˆéªŒæ¥è¿›è¡Œæ¨æµ‹ï¼Œä¸ç°åœ¨çš„ç»“æœè¿›è¡Œç›¸ä¹˜ï¼Œå¾—åˆ°çš„ç»“æœå¦‚ä¸‹å›¾ï¼š\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt2_3.jpg)\n\n> ç¬¬ä¸€åˆ—æ¯ä¸­å‡è®¾ä¸ºäº§ç”Ÿæ–°æ•°æ®çš„æ–¹å¼ï¼Œç¬¬äºŒåˆ—ä¸ºä¹‹å‰çš„ç»“æœä½œä¸ºå…ˆéªŒã€‚\n\n#### From counts to probability\n\næˆ‘ä»¬å¯ä»¥å°†ä¹‹é—´çš„è®¡ç®—è½¬ä¸ºæ¦‚ç‡ï¼Œè¿˜æ˜¯ä¹‹å‰çš„ä¾‹å­ï¼Œå˜ä¸ºï¼š\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt2_4.jpg)\n\n> $p$ä¸ºè“è‰²çš„æ¯”ä¾‹ã€‚\n\nè®¡ç®—æ–¹æ³•ä¸ºï¼š\n\n~~~R\nways <- c(0, 3, 8, 9, 0)\nways/sum(ways)\n> 0.00 0.15 0.40 0.45 0.00\n~~~\n\n### Building a  model\n\nå‡è®¾æˆ‘ä»¬è¦ä¼°è®¡åœ°çƒä¸Šæµ·æ´‹æ‰€å çš„æ¯”ä¾‹ï¼Œå‡è®¾æˆ‘ä»¬åœ¨åœ°çƒä¸ŠéšæœºæŠ½æ ·å¾—åˆ°çš„ç»“æœä¸º`WLWWWLWLW`ã€‚æˆ‘ä»¬åˆ©ç”¨ä¸Šé¢æåˆ°çš„æ–¹æ³•å¯¹å…¶è¿›è¡Œæ¨æ–­ï¼š\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt2_5.jpg)\n\n### Components of the model\n\n#### Likelihood\n\né¦–å…ˆæ˜¯ä¼¼ç„¶ï¼Œä¼¼ç„¶æŒ‡çš„æ˜¯åœ¨ç»™å®šå‚æ•°æƒ…å†µä¸‹æ•°æ®çš„åˆç†æ€§(å‘ç”Ÿçš„å¯èƒ½æ€§)ã€‚\n\n#### Prior\n\nå¯¹äºæˆ‘ä»¬æƒ³è¦è´å¶æ–¯ä¼°è®¡çš„æ¯ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå…¶æä¾›å…ˆéªŒã€‚å…ˆéªŒä¹Ÿä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œå¯ä»¥æ˜¯ä¹‹å‰æ•°æ®å¾—åˆ°çš„å‚æ•°çš„æ¦‚ç‡åˆ†å¸ƒæˆ–æ˜¯æˆ‘ä»¬è‡ªå·±æ ¹æ®ç»éªŒçš„æ¦‚ç‡åˆ†å¸ƒã€‚\n\n#### Posterior\n\nå†æœ‰äº†å…ˆéªŒå’Œä¼¼ç„¶åæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—åéªŒï¼š\n$$\n\\text { Posterior }=\\frac{\\text { Likelihood } \\times \\text { Prior }}{\\text { Average Likelihood }}\n$$\n\n### Making the model go\n\nç”±äºåéªŒåˆ†å¸ƒå­˜åœ¨ç§¯åˆ†ï¼Œæˆ‘ä»¬æœ‰æ—¶æ— æ³•ç›´æ¥å¯¹å…¶è¿›è¡Œè®¡ç®—ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ•°å€¼æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç»ä¸‰ç§æ–¹æ³•ï¼š\n\n1. ç½‘æ ¼è¿‘ä¼¼\n2. äºŒæ¬¡é€¼è¿‘\n3. MCMC\n\n#### Grid approximation\n\næœ€ç®€å•çš„è°ƒèŠ‚æŠ€æœ¯ä¹‹ä¸€æ˜¯ç½‘æ ¼è¿‘ä¼¼ã€‚è™½ç„¶å¤§å¤šæ•°å‚æ•°æ˜¯è¿ç»­çš„ï¼Œèƒ½å¤Ÿå–æ— é™æ•°é‡çš„å€¼ï¼Œä½†äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»…è€ƒè™‘å‚æ•°å€¼çš„æœ‰é™ç½‘æ ¼æ¥å®ç°å¯¹è¿ç»­åéªŒåˆ†å¸ƒçš„æå¥½è¿‘ä¼¼ã€‚\n\nä½†æ˜¯åœ¨å¤§å¤šæ•°çœŸå®å»ºæ¨¡ä¸­ï¼Œç½‘æ ¼è¿‘ä¼¼æ˜¯ä¸åˆ‡å®é™…çš„ã€‚åŸå› æ˜¯éšç€å‚æ•°æ•°é‡çš„å¢åŠ ï¼Œå®ƒçš„æ‰©å±•æ€§å¾ˆå·®ã€‚æ‰€ä»¥åœ¨åé¢çš„ç« èŠ‚ä¸­ï¼Œç½‘æ ¼è¿‘ä¼¼å°†é€æ¸æ¶ˆå¤±ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å…¶ä»–æ›´æœ‰æ•ˆçš„æŠ€æœ¯ã€‚\n\n~~~R\n# define grid\np_grid <- seq(from=0, to=1, length.out=20)\n\n# define prior\nprior = rep(1, 20)\n\n# compute likelihood at each value in grid\nlikelihood <- dbinom(6, size = 9, prob = p_grid)\n\n\n# compute product of likelihood and prior\nunstd.posterior <- likelihood * prior\n\n# standardize the posterior, so it sums to 1\nposterior <- unstd.posterior / sum(unstd.posterior)\n~~~\n\n~~~R\nplot(p_grid, posterior, type = \"b\", xlab = \"probability of water\", ylab = \"posterior probability\")\nmtext(\"20 points\")\n~~~\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt2_6.jpeg)\n\n#### Quadratic approximation\n\nåœ¨ä¸€èˆ¬çš„æ¡ä»¶ä¸‹ï¼ŒåéªŒåˆ†å¸ƒå³°å€¼é™„è¿‘çš„åŒºåŸŸåœ¨å½¢çŠ¶ä¸Šå°†æ¥è¿‘é«˜æ–¯æˆ–æ­£æ€åˆ†å¸ƒã€‚è¿™æ„å‘³ç€åéªŒåˆ†å¸ƒå¯ä»¥æœ‰ç”¨åœ°è¿‘ä¼¼ä¸ºé«˜æ–¯åˆ†å¸ƒã€‚é«˜æ–¯åˆ†å¸ƒå¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºå®ƒå¯ä»¥å®Œå…¨ç”¨ä¸¤ä¸ªæ•°å­—æ¥æè¿°ï¼šä¸­å¿ƒçš„ä½ç½®ï¼ˆå‡å€¼ï¼‰å’Œåˆ†å¸ƒï¼ˆæ–¹å·®ï¼‰ã€‚è¯¥æ–¹æ³•åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š\n\n1. æ‰¾åˆ°åéªŒåˆ†å¸ƒçš„ä¼—æ•°\n2. ä¸€æ—¦æ‰¾åˆ°åéªŒçš„å³°å€¼ï¼Œå°±å¿…é¡»ä¼°è®¡å³°å€¼é™„è¿‘çš„æ›²ç‡ã€‚è¯¥æ›²ç‡è¶³ä»¥è®¡ç®—æ•´ä¸ªåéªŒåˆ†å¸ƒçš„äºŒæ¬¡è¿‘ä¼¼\n\n~~~R\nlibrary(rethinking)\nglobe.qa <- map(\n  alist(\n    w ~ dbinom(9, p), #likelihood\n    p ~ dunif(0,1)\n  ),\n  data = list(w=6)\n)\n# display summary of quadratic approximation\nprecis(globe.qa)\n>  mean   sd 5.5% 94.5%\np 0.67 0.16 0.42  0.92\n~~~\n\næˆ‘ä»¬ä¸çœŸå®çš„åéªŒè¿›è¡Œæ¯”è¾ƒï¼š\n\n~~~R\n# analytical calculation\nw <- 6\nn <- 9\ncurve(dbeta(x, w+1, n-w+1), from = 0, to=1)\n# quadratic approximation\ncurve(dnorm(x, 0.67, 0.16), lty=2, add = TRUE)\n~~~\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt2_7.jpeg)\n\n","tags":["æ¦‚ç‡ç¼–ç¨‹","è´å¶æ–¯ç»Ÿè®¡","Statistical Rethinking"],"categories":["ä¹¦ç±é˜…è¯»"]},{"title":"Statistical Rethinking:Chapter1","url":"/2022/06/28/rt1/","content":"\n## The Golem of Prague\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt1_1.png)\n\n`golem`ä¸ºé­”åƒï¼Œä¸ºä¸€ä¸ªéå¸¸å¼ºå¤§çš„æœºå™¨äººï¼Œä½†æ˜¯å®ƒåªä¼šå¬ä»äººçš„å‘½ä»¤ï¼Œæ²¡æœ‰è‡ªä¸»æ€è€ƒçš„èƒ½åŠ›ã€‚å› æ­¤äººç±»å¿…é¡»ç»™ä»–è®¾ç½®éå¸¸å…·ä½“çš„å‘½ä»¤ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¹äººç±»é€ æˆä¼¤å®³ã€‚\n\n<!--more-->\n\n### Statistical golems\n\nç»Ÿè®¡å®¶ä¹Ÿåˆ¶é€ é­”åƒã€‚\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt1_2.jpg)\n\n> ç»Ÿè®¡å®¶åˆ¶é€ çš„é­”åƒï¼Œéå¸¸å¼ºå¤§ï¼Œä½†ä¹ŸåŒæ ·éœ€è¦äººç±»çš„æŒ‡å¯¼ã€‚ç¼ºä¹çµæ´»æ€§ï¼Œåœ¨éœ€è¦åˆ›é€ æ€§çš„åŒºåŸŸæ— æ³•åº”ç”¨ã€‚\n\n### Statistical rethinking\n\nå¾ˆå¤šäººè®¤ä¸ºç»Ÿè®¡æ¨æ–­çš„ç›®æ ‡æ˜¯æ£€éªŒæ— æ•ˆå‡è®¾ã€‚ä½†è¿™æ˜¯ä¸æ­£ç¡®çš„ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸¤ä¸ªç†ç”±ï¼š\n\n1. å‡è®¾ä¸æ˜¯æ¨¡å‹ã€‚å‡è®¾å’Œä¸åŒç§ç±»çš„æ¨¡å‹ä¹‹é—´çš„å…³ç³»æ˜¯å¤æ‚çš„ã€‚è®¸å¤šæ¨¡å‹å¯¹åº”åŒä¸€ä¸ªå‡è®¾ï¼Œè®¸å¤šå‡è®¾å¯¹åº”ä¸€ä¸ªæ¨¡å‹ã€‚è¿™ä½¿å¾—ä¸¥æ ¼çš„è¯ä¼ªå˜å¾—ä¸å¯èƒ½ã€‚\n2. æµ‹é‡å¾ˆé‡è¦ã€‚å³ä½¿æˆ‘ä»¬è®¤ä¸ºæ•°æ®è¯ä¼ªäº†æ¨¡å‹ï¼Œå¦ä¸€ä½è§‚å¯Ÿè€…ä¹Ÿä¼šäº‰è®ºæˆ‘ä»¬çš„æ–¹æ³•å’Œæªæ–½ã€‚ä»–ä»¬ä¸ç›¸ä¿¡æ•°æ®ã€‚æœ‰æ—¶ä»–ä»¬æ˜¯å¯¹çš„ã€‚\n\n#### Hypotheses are not models\n\nå½“æˆ‘ä»¬è¯•å›¾è¯ä¼ªä¸€ä¸ªå‡è®¾æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨æŸç§æ¨¡å‹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ä»…ä»…é€šè¿‡ä¸€ä¸ªæ¨¡å‹æ¥è¯æ˜å‡è®¾æ˜¯é”™è¯¯çš„ã€‚\n\næˆ‘ä»¬çœ‹ä¸€ä¸ªå…³äºè¿›åŒ–çš„ä¾‹å­ï¼Œæœ‰äººè®¤ä¸ºè¿›åŒ–æ˜¯ä¸­æ€§çš„ï¼Œè€Œæœ‰äººä¸è¿™ä¹ˆè®¤ä¸ºï¼Œæ‰€æœ‰å­˜åœ¨ä¸¤ä¸ªå‡è®¾ã€‚åŒä¸€ä¸ªå‡è®¾å¯èƒ½å¯¼è‡´ä¸åŒçš„è¿‡ç¨‹çš„æ¨¡å‹ï¼Œè€ŒåŒä¸€ä¸ªè¿‡ç¨‹æ¨¡å‹ä¼šå¼•å‡ºä¸åŒçš„ç»Ÿè®¡æ¨¡å‹ï¼ŒåŒä¸€ä¸ªç»Ÿè®¡æ¨¡å‹ä¹Ÿå¯èƒ½å¯¹åº”äºä¸åŒçš„è¿‡ç¨‹æ¨¡å‹å’Œå‡è®¾ï¼Œå› æ­¤è¯ä¼ªéå¸¸å¤æ‚ã€‚\n\n![](https://raw.githubusercontent.com/HFC666/image/master/img/rt1_3.jpg)\n\n\n\n#### Measurement matters\n\né¦–å…ˆè§‚æµ‹æ˜¯å­˜åœ¨è¯¯å·®çš„ï¼Œè€Œä¸”æœ‰çš„æµ‹é‡éå¸¸å¤æ‚å®¹æ˜“å‡ºç°è¯¯å·®ã€‚\n\nå…¶æ¬¡å‡è®¾å¹¶ä¸ä¸€å®šæ˜¯ç¦»æ•£çš„ï¼Œç°å®ç”Ÿæ´»ä¸­çš„å¾ˆå¤šå‡è®¾éƒ½æ˜¯è¿ç»­çš„ï¼Œä¾‹å¦‚$80\\%$çš„å¤©é¹…éƒ½æ˜¯ç™½è‰²çš„ï¼Œå¯¹æˆ‘ä»¬è¯ä¼ªæ¥è¯´éå¸¸å›°éš¾ã€‚\n\n### Three tools for golem engineering\n\n#### Bayesian data analysis\n\nè´å¶æ–¯ç»Ÿè®¡ç”¨éšæœºå‹æ¥æè¿°ä¸ç¡®å®šæ€§ï¼Œæ›´è¯¦ç»†çš„å°†åœ¨ç¬¬äºŒç« è®²è¿°ã€‚\n\n#### Multilevel models\n\nä½¿ç”¨å¤šçº§æ¨¡å‹æœ‰å››ä¸ªå…¸å‹ä¸”äº’è¡¥çš„åŸå› ï¼š\n\n1. è°ƒæ•´é‡å¤æŠ½æ ·çš„ä¼°è®¡å€¼ã€‚å½“ä¸æ­¢ä¸€ä¸ªè§‚å¯Ÿæ¥è‡ªåŒä¸€ä¸ªäººã€åœ°ç‚¹æˆ–æ—¶é—´æ—¶ï¼Œä¼ ç»Ÿçš„å•çº§æ¨¡å‹å¯èƒ½ä¼šè¯¯å¯¼æˆ‘ä»¬ã€‚\n2. è°ƒæ•´æŠ½æ ·ä¸å¹³è¡¡çš„ä¼°è®¡å€¼ã€‚å½“æŸäº›ä¸ªä½“ã€åœ°ç‚¹æˆ–æ—¶é—´çš„é‡‡æ ·æ¬¡æ•°å¤šäºå…¶ä»–äººæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯èƒ½ä¼šè¢«å•çº§æ¨¡å‹è¯¯å¯¼ã€‚\n3. ç ”ç©¶å˜å¼‚ã€‚å¦‚æœæˆ‘ä»¬çš„ç ”ç©¶é—®é¢˜åŒ…æ‹¬æ•°æ®ä¸­ä¸ªäººæˆ–å…¶ä»–ç¾¤ä½“ä¹‹é—´çš„å˜åŒ–ï¼Œé‚£ä¹ˆå¤šå±‚æ¬¡æ¨¡å‹å°†æœ‰å¾ˆå¤§å¸®åŠ©ï¼Œå› ä¸ºå®ƒä»¬æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†å˜åŒ–ã€‚\n4. é¿å…å¹³å‡ã€‚å­¦è€…ä»¬ç»å¸¸å¯¹ä¸€äº›æ•°æ®è¿›è¡Œé¢„å¹³å‡ï¼Œä»¥æ„å»ºç”¨äºå›å½’åˆ†æçš„å˜é‡ã€‚è¿™å¯èƒ½å¾ˆå±é™©ï¼Œå› ä¸ºå¹³å‡ä¼šæ¶ˆé™¤å˜åŒ–ã€‚å› æ­¤ï¼Œå®ƒåˆ¶é€ äº†è™šå‡çš„ä¿¡å¿µã€‚å¤šçº§æ¨¡å‹å…è®¸æˆ‘ä»¬ä¿ç•™åŸå§‹é¢„å¹³å‡å€¼ä¸­çš„ä¸ç¡®å®šæ€§ï¼ŒåŒæ—¶ä»ä½¿ç”¨å¹³å‡å€¼è¿›è¡Œé¢„æµ‹ã€‚\n\n#### Model comparison and information criteria\n\næœ€è‘—åçš„ä¿¡æ¯å‡†åˆ™æ˜¯ AICï¼Œå³ Akaike (ah-kah-ee-kay) ä¿¡æ¯å‡†åˆ™ã€‚AIC åŠå…¶åŒç±»è¢«ç§°ä¸ºâ€œä¿¡æ¯â€æ ‡å‡†ï¼Œå› ä¸ºå®ƒä»¬ä»ä¿¡æ¯è®ºä¸­å‘å±•å‡ºå¯¹æ¨¡å‹å‡†ç¡®æ€§çš„åº¦é‡ã€‚æˆ‘ä»¬å¯ä»¥ç”¨èµ·æ¥æ¯”è¾ƒæ¨¡å‹çš„å¥½åã€‚\n\n","tags":["æ¦‚ç‡ç¼–ç¨‹","è´å¶æ–¯ç»Ÿè®¡","Statistical Rethinking"],"categories":["ä¹¦ç±é˜…è¯»"]},{"title":"Turing:a language for flexible probabilistic inference","url":"/2022/06/28/Turing/","content":"\n## Turing: a language for flexible probabilistic inference\n\n> æ–‡ç« é“¾æ¥ï¼šhttp://proceedings.mlr.press/v84/ge18b.html?ref=https://githubhelp.com\n\n![](http://static01.imgkr.com/temp/9ce5f3b2581549b8b89e6c9cdf7ebea5.png)\n\n<!--more-->\n\n### Background\n\nåœ¨æ¦‚ç‡æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å…³æ³¨çš„ä¸€èˆ¬æ˜¯$p(\\theta\\mid y,\\gamma)$ï¼Œå…¶ä¸­$\\theta$ä¸ºå‚æ•°ï¼Œ$y$ä¸ºè§‚æµ‹æ•°æ®ï¼Œ$\\gamma$ä¸ºä¸€äº›ç¡®å®šäº†çš„è¶…å‚æ•°ã€‚\n\n#### Models as computer programs\n\næœ€æ—©çš„æ¦‚ç‡ç¼–ç¨‹è¯­è¨€ä¸ºBUGSï¼Œå¯ä»¥è¿½æº¯åˆ°20ä¸–çºª90å¹´ä»£ã€‚ä¸‹é¢å±•ç¤ºäº†æ¦‚ç‡ç¨‹åºçš„ä¸€èˆ¬ç»“æ„ã€‚\n\nè¾“å…¥ï¼šæ•°æ®$y$å’Œè¶…å‚æ•°$\\gamma$\n\næ­¥éª¤1ï¼šå®šä¹‰å…¨å±€å‚æ•°ï¼š\n$$\n\\theta^{\\text{global}}\\sim p(\\cdot\\mid \\gamma)\n$$\næ­¥éª¤2ï¼šå¯¹äºæ¯ä¸€ä¸ªè§‚æµ‹$y_n$ï¼Œå®šä¹‰(å±€éƒ¨)éšå˜é‡å¹¶è®¡ç®—ä¼¼ç„¶ï¼š\n$$\n\\begin{aligned}\n\\theta_n^{\\text{local}}&\\sim p\\left(\\cdot\\mid\\theta_{1:n-1}^{\\text{local}},\\theta^{\\text{global}},\\gamma\\right)\\\\\ny_n&\\sim p\\left(\\cdot\\mid \\theta_{1:n}^{\\text{local}},\\theta^{\\text{global}},\\gamma\\right)\n\\end{aligned}\n$$\nå…¶ä¸­$n=1,2,\\cdots,N$ã€‚\n\nå‚æ•°åˆ†ä¸ºä¸¤ç±»ï¼š$\\theta_n^{\\text{local}}$è¡¨ç¤ºå¯¹äºè§‚æµ‹$y_n$çš„æ¨¡å‹å‚æ•°ï¼Œå¦‚æ··åˆé«˜æ–¯æ¨¡å‹ä¸­$y_n$å±äºå“ªä¸ªé«˜æ–¯åˆ†å¸ƒçš„å‚æ•°ï¼Œè€Œ$\\theta^{\\text{global}}$è¡¨ç¤ºå…¨å±€å˜é‡ã€‚\n\n#### Inference for probabilistic programs\n\næ¦‚ç‡ç¨‹åºåªæœ‰åœ¨ä¸é«˜æ•ˆçš„æ¨ç†å¼•æ“ç›¸ç»“åˆæ—¶æ‰èƒ½å‘æŒ¥å…¶çµæ´»æ€§æ½œåŠ›ã€‚ä¸ºäº†è§£é‡Šæ¦‚ç‡ç¼–ç¨‹ä¸­æ¨ç†å¦‚ä½•å·¥ä½œï¼Œæˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹å…·æœ‰$K$ä¸ªçŠ¶æ€çš„HMMä¾‹å­ï¼š\n$$\n\\begin{aligned}\n\\pi_k&\\sim \\text{Dir}(\\theta)\\\\\n\\phi_k&\\sim p(\\gamma)\\\\\nz_t\\mid z_{t-1}&\\sim \\text{Cat}(\\cdot\\mid \\pi_{z_{t-1}})\\\\\ny_t\\mid z_t&\\sim h(\\cdot\\mid \\phi_{z_t})\n\\end{aligned}\n$$\nå…¶ä¸­$k = 1,2,\\cdots,K$ï¼Œ$t = 1,\\cdots,N$ã€‚\n\nå…·æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤çš„é«˜æ•ˆ Gibbs é‡‡æ ·å™¨é€šå¸¸ç”¨äºè´å¶æ–¯æ¨ç†ï¼š\n\n+ Step 1: Sample $z_{1: T} \\sim z_{1: T} \\mid \\phi_{1: K}, \\pi_{1: K}, y_{1: T} ;$\n+ Step 2: Sample $\\phi_{k} \\sim \\phi_{k} \\mid z_{1: T}, y_{1: T}, \\gamma$;\n+ Step 3: Sample $\\pi_{k} \\sim \\pi_{k} \\mid z_{1: T}, \\theta(k=1, \\ldots, K)$.\n\n\n\n#### Computation graph based inference\n\nå¯¹æ¦‚ç‡ç¨‹åºè¿›è¡Œå»ºæ¨¡çš„ä¸€å¤§æŒ‘æˆ˜æ˜¯æ„å»ºæ¨¡å‹å˜é‡ä¹‹é—´çš„è®¡ç®—å›¾ã€‚å¯¹äºä¸€äº›ç¼–ç¨‹è¯­è¨€ï¼Œåœ¨æ¨ç†ä¹‹å‰æ¦‚ç‡å›¾æ¨¡å‹å°±å·²ç»ç”Ÿæˆï¼Œä½†æ˜¯å½“ç¨‹åºä¸­å­˜åœ¨éšæœºåˆ†æ”¯æ—¶å°±ä¼šå‡ºç°é—®é¢˜ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¾—ä¸æ±‚åŠ©äºå…¶ä»–æ¨ç†æ–¹æ³•ã€‚\n\n### Composable MCMC inference\n\næˆ‘ä»¬æå‡ºçš„å¯ç»„åˆæ¨ç†æ–¹æ³•åˆ©ç”¨äº†HMCç®—æ³•å’Œç²’å­å‰å¸ƒæ–¯(PG)ç®—æ³•ã€‚ä¸ºäº†æè¿°æ‰€æå‡ºçš„æ¦‚ç‡ç¨‹åºæ–¹æ³•ï¼Œæˆ‘ä»¬åˆ©ç”¨æ½œåœ¨ç‹„åˆ©å…‹é›·åˆ†é…(LDA)çš„ä¾‹å­ã€‚\n\n~~~julia\n@model lda(K ,M, N, w, d, beta, alpha) = begin\n    theta = Vector{Vector{Real}}(M)\n    for m = 1:M\n        theta[m] ~ Dirichlet(alpha)\n    end\n    phi = Vector{Vector{Real}}(K)\n    for k = 1:K\n        phi[k] ~ Dirichlet(beta)\n    end\n    \n    z = tzeros(Int, N)\n    for n = 1:N\n        z[n] ~ Categorical(theta[d[n]])\n        w[n] ~ Categorical(phi[z[n]])\n    end\nend\n~~~\n\nå…¶ä¸­å˜é‡$\\phi,\\theta,z$è¡¨ç¤ºæ¨¡å‹å‚æ•°ï¼Œå˜é‡$K,M,N,d,\\beta,\\alpha$è¡¨ç¤ºè¶…å‚æ•°ï¼Œ$w$è¡¨ç¤ºè§‚æµ‹æ•°æ®ã€‚\n\nä¸€æ—¦å®šä¹‰äº†æ¨¡å‹ï¼Œæä¾›æ•°æ®å’Œæ‰§è¡Œæ¨ç†å°±å¾ˆç›´è§‚äº†ã€‚\n\n~~~julia\nmodel = lda(K, V, M, N, w, d, beta, alpha)\nsample(model, engine)\n~~~\n\n`engine`æ˜¯æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„MCMCå¼•æ“ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦åº”ç”¨ä¾‹å­å‰å¸ƒæ–¯é‡‡æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š\n\n~~~julia\nspl = PG(n, m)\nsample(model, spl)\n~~~\n\nè¿™å°†ä¼šç”¨å«æœ‰$m$ä¸ªç²’å­çš„PGè¿›è¡Œ$n$æ¬¡è¿­ä»£ã€‚\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ä¸åŒçš„å‚æ•°é‡‡ç”¨ä¸åŒçš„é‡‡æ ·å™¨ï¼š\n\n~~~julia\nspl2 = Gibbs(1000, PG(10,2,:z), HMC(2, 0.1, 1, 5, :phi,:theta))\n~~~\n\nä¸Šè¿°é‡‡æ ·å¼•æ“`spl2`å°†å‚æ•°åˆ†å‰²ä¸ºä¸¤éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†é‡‡ç”¨ä¸åŒçš„é‡‡æ ·æ–¹æ³•ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåˆ†å¸ƒçš„ä¸¤ä¸ªéƒ¨åˆ†ä¸éœ€è¦æ˜¯äº’æ–¥çš„ã€‚\n\n#### A family of MCMC operators\n\n![](http://static01.imgkr.com/temp/679a0f1dc05a4456ae7ee80183c63582.jpg)\n\n> Supported Monte Carlo algorithms in Turing\n\n### Implementation and Experiments\n\n#### The Turing library\n\nTuringä¸ºJuliaçš„ä¸€ä¸ªåŒ…ã€‚å› ä¸ºTuringä¸ºä¸€èˆ¬çš„Juliaç¨‹åºï¼Œå› æ­¤å®ƒå¯ä»¥åˆ©ç”¨Juliaä¸­ä¸°å¯Œçš„æ•°å€¼å’Œç»Ÿè®¡åº“ã€‚\n\n##### Efficient particle Gibbs implementation\n\næˆ‘ä»¬ä½¿ç”¨åç¨‹æ¥å®ç°ç²’å­ Gibbsã€‚åç¨‹å¯ä»¥çœ‹ä½œæ˜¯å‡½æ•°çš„æ³›åŒ–ï¼Œå…·æœ‰å¯ä»¥åœ¨å¤šä¸ªç‚¹æš‚åœå’Œæ¢å¤çš„ç‰¹æ€§ã€‚\n\n##### Automatic differentiation\n\nHMCåœ¨é‡‡æ ·çš„è¿‡ç¨‹éœ€è¦æ¢¯åº¦ï¼Œå½“ç»™å®šå®šä¹‰$\\log p(\\theta\\mid z_{1:N},\\gamma)$çš„è®¡ç®—ç¨‹åºæ—¶ï¼Œè¿™äº›æ¢¯åº¦å¯ä»¥é€šè¿‡è‡ªåŠ¨å¾®åˆ†(AD)è‡ªåŠ¨è·å¾—ã€‚ä¸ºäº†ç®€ä¾¿å’Œé«˜æ•ˆï¼Œæˆ‘ä»¬ç‡å…ˆä½¿ç”¨äº†ä¸€ç§ç§°ä¸ºå‘é‡æ¨¡å¼çš„å‰å‘å¾®åˆ†æŠ€æœ¯ã€‚å‘é‡æ¨¡å¼å‰å‘å¾®åˆ†èƒŒåçš„ä¸»è¦æ¦‚å¿µæ˜¯å¤šç»´å¯¹å¶æ•°ï¼Œå…¶åœ¨æ ‡é‡å‡½æ•°ä¸Šçš„è¡Œä¸ºå®šä¹‰ä¸ºï¼š\n$$\nf\\left(\\theta+\\sum_{i=1}^D y_i\\epsilon_i\\right) = f(\\theta) + f^{\\prime}(\\theta)\\sum_{i=1}^Dy_i\\epsilon_i\n$$\nå…¶ä¸­$\\epsilon_i\\epsilon_j=0,\\text{for }i\\neq j$ã€‚\n\nå¯¹äºå°æ¨¡å‹ï¼Œå‘é‡å‰å‘ADéå¸¸é«˜æ•ˆã€‚ä½†æ˜¯å¯¹äºå¤§æ¨¡å‹é€†å‘æ¨¡å¼çš„ADè¾ƒä¸ºé«˜æ•ˆï¼Œå› æ­¤Turingä¸¤ç§æ¨¡å¼éƒ½å­˜åœ¨ã€‚\n\n##### Vectorized random variables\n\nTuringæ”¯æŒåˆ©ç”¨ä»¥ä¸‹è¯­æ³•å¯¹ç‹¬ç«‹åŒåˆ†å¸ƒçš„å˜é‡è¿›è¡ŒçŸ¢é‡åŒ–é‡‡æ ·ï¼š\n\n~~~julia\nrv = Vector(10)\nrv ~ [Normal(0, 1)]\n~~~\n\n##### Constrained random variables\n\nTuringæ”¯æŒçº¦æŸçš„å˜é‡ã€‚ä¸»è¦ç”±ä¸‰ç§ç±»å‹çš„çº¦æŸï¼š\n\n1. æœ‰ç•Œçš„å•å˜é‡ã€‚\n2. æœ‰ç®€å•çº¦æŸçš„å¤šç»´å˜é‡ï¼Œå¦‚ç›¸åŠ å’Œä¸º$1$ã€‚\n3. çŸ©é˜µçº¦æŸï¼šä¾‹å¦‚åæ–¹å·®çŸ©é˜µä¸ºåŠæ­£å®šçŸ©é˜µã€‚\n\n##### MCMC output analysis\n\nåœ¨Turingä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`describe`å‡½æ•°è®¡ç®—ï¼š\n\n1. å‡å€¼\n2. æ ‡å‡†å·®\n3. naive standard error\n4. è’™ç‰¹å¡æ´›æ ‡å‡†è¯¯å·®\n5. æœ‰æ•ˆæ ·æœ¬æ•°\n6. åˆ†ä½æ•°\n\nä¹Ÿå¯ä»¥ä½¿ç”¨`hpd`å‡½æ•°è®¡ç®—é«˜åéªŒæ¦‚ç‡åŒºé—´ï¼Œäº’ç›¸å…³`cor`ï¼Œè‡ªç›¸å…³`autocor`ï¼ŒçŠ¶æ€ç©ºé—´å˜åŒ–ç‡`changerate`å’Œåå·®ä¿¡æ¯å‡†åˆ™`dic`ç­‰ç­‰ã€‚\n\n#### Finding the right inference engine\n\nä¸‹é¢æˆ‘ä»¬å°†æ¯”è¾ƒ`NUTS`å’Œ`Gibbs(PG,HMC)`åœ¨ä¸åŒçš„æ¦‚ç‡æ¨¡å‹ä¸Šã€‚\n\n##### Models and inference engine setup\n\n**Stochastic Volatility Model**ï¼šå‚æ•°çš„é›†åˆä¸º$\\{\\phi,\\sigma,\\mu,h_{1:N}\\}$ã€‚æ‰€æœ‰è¿™äº›å‚æ•°å¯¹äºç›®æ ‡åˆ†å¸ƒæ¥è¯´éƒ½æ˜¯å¯å¯¼çš„ï¼Œå› æ­¤NUTSç®—æ³•æ˜¯å¯ç”¨çš„ï¼š\n$$\n\\begin{aligned}\n\\mu &\\sim \\mathcal{C} \\mathrm{a}(0,10)), \\phi \\sim \\mathcal{U} \\mathrm{n}(-1,1), \\sigma \\sim \\mathcal{C} \\mathrm{a}(0,5), \\quad(\\sigma>0) \\\\\nh_{1} & \\sim \\mathcal{N}\\left(\\mu, \\sigma / \\sqrt{1-\\phi^{2}}\\right), h_{n} \\sim \\mathcal{N}\\left(\\mu+\\phi\\left(h_{n-1}-\\mu\\right), \\sigma\\right) \\\\\ny_{n} & \\sim \\mathcal{N}\\left(0, \\exp \\left(h_{n} / 2\\right)\\right) \\quad(n=2,3, \\ldots, N) .\n\\end{aligned}\n$$\nå…¶ä¸­$\\mathcal{C}\\mathrm{a}$è¡¨ç¤ºæŸ¯è¥¿åˆ†å¸ƒã€‚\n\n~~~julia\nspl1 = NUTS(1e4, 1e3, 0.65)\nspl2 = Gibbs(1e4, PG(5, 1, :h), NUTS(1, 1e3, 0.65, :mu, :phi, :sigma))\n~~~\n\n**Gaussian Mixture Model**ï¼šå‚æ•°çš„é›†åˆä¸º$\\{z,\\theta\\}$ï¼Œå…¶ä¸­å‚æ•°$\\theta$æ˜¯å¯å¯¼çš„ï¼Œå‚æ•°$z$ä¸å¯ä»¥ã€‚ä¸ºäº†è¿è¡ŒNUTSç®—æ³•ï¼Œæˆ‘ä»¬ç§¯åˆ†ç§¯æ‰$z$åªå¯¹$\\theta$é‡‡æ ·ï¼š\n$$\n\\begin{array}{r}\n\\mu=\\left(\\mu_{1: K}\\right), \\quad \\sigma=\\left(\\sigma_{1: K}\\right), \\quad \\pi=\\left(p_{1: K}\\right) \\\\\nz \\sim \\operatorname{Cat}(\\pi), \\quad \\theta \\sim \\mathcal{N}\\left(\\mu_{z}, \\sigma_{z}\\right)\n\\end{array}\n$$\n\n~~~julia\nspl3 = NUTS(5e4, 1000, 0.65)\nspl4 = Gibbs(5e4, PG(5, 1, :z), NUTS(5e2, 1e3, 0.65, :theta))\n~~~\n\n##### Results\n\n![](http://static01.imgkr.com/temp/99d803e553514e089858f61d913babd1.jpg)\n\n> ä¸Šå›¾ä¸ºåœ¨GMMæ¨¡å‹ä¸Štrace plotï¼Œä¸‹å›¾ä¸ºè”åˆåˆ†å¸ƒçš„æ¦‚ç‡çš„å¯¹æ•°çš„å›¾ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªç®—æ³•éƒ½è¾¾åˆ°äº†æ”¶æ•›ï¼Œä½†æ˜¯NUTSç®—æ³•åœ¨æŸäº›å¯¹æ–¹è¢«\"å›°ä½äº†\"ã€‚åœ¨ä¸‹å›¾æ›´æ˜æ˜¾ã€‚\n\n![](http://static01.imgkr.com/temp/095ae7d0d5a54a33960b6cd2162133bc.jpg)\n\n> å¯¹å…·æœ‰$5$ä¸ªæ··åˆçš„GMMé‡‡æ ·çš„ç»“æœï¼Œå¯ä»¥æ›´æ˜æ˜¾åœ°çœ‹åˆ°NUTSç®—æ³•è¢«å›°ä½äº†ï¼Œåœ¨å›¾çš„ä¸ŠåŠéƒ¨åˆ†åªæ¢ç´¢åˆ°äº†ä¸¤ä¸ªæ··åˆæˆåˆ†ã€‚\n\n\n\n","tags":["æ¦‚ç‡ç¼–ç¨‹","Julia"],"categories":["æ–‡çŒ®é˜…è¯»"]},{"title":"æ–‡ç« A Conceptual Introduction to Hamiltonian Monte Carloé˜…è¯»ç¬”è®°","url":"/2022/06/22/HMC/","content":"\n## A Conceptual Introduction to Hamiltonian Monte Carlo\n\n> æ–‡ç« é“¾æ¥ï¼šhttps://arxiv.org/abs/1701.02434\n\n![](http://static01.imgkr.com/temp/8a010064bcee4b0eac9e9c05caa3f1ee.png)\n\n<!--more-->\n\n### æœŸæœ›çš„è®¡ç®—\n\nå¯¹äºç»™å®šå‡½æ•°$f(q)$ï¼Œæˆ‘ä»¬åœ¨ç»™å®šçš„$q$çš„åˆ†å¸ƒ$\\pi (q)$ä¸Šè®¡ç®—å…¶æœŸæœ›ï¼š\n$$\n\\mathbb{E}_{\\pi}[f] = \\int_{\\mathcal{Q}}\\pi(q)f(q)dq\n$$\nä¸€èˆ¬æƒ…å†µä¸‹æ­¤ç§¯åˆ†çš„åŸå‡½æ•°å¾—ä¸åˆ°ï¼Œå› æ­¤æˆ‘ä»¬é‡‡ç”¨è’™ç‰¹å¡æ´›çš„æ–¹æ³•ï¼Œåœ¨$\\pi(q)$ä¸Šå¯¹$q$è¿›è¡Œé‡‡æ ·ï¼Œç”¨ä¸‹å¼è®¡ç®—æœŸæœ›ï¼š\n$$\n\\mathbb{E}_{\\pi}[f]\\approx \\frac{1}{n}\\sum_{i=1}^n f(q_i)\\quad q_i\\sim \\pi(q)\n$$\nä½†æ˜¯æˆ‘ä»¬å¦‚ä½•åœ¨$\\pi(q)$ä¸Šè¿›è¡Œé‡‡æ ·å‘¢ï¼Ÿä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€‰æ‹©åœ¨æ¦‚ç‡å¯†åº¦è¾ƒé«˜çš„ä½ç½®è¿›è¡Œé‡‡æ ·ï¼Œå³åœ¨æ¦‚ç‡å¯†åº¦æœ€é«˜çš„é‚»åŸŸå†…è¿›è¡Œé‡‡æ ·ã€‚ä½†æ˜¯åœ¨é«˜ç»´æƒ…å†µä¸‹å­˜åœ¨é—®é¢˜ï¼Œå‡è®¾æˆ‘ä»¬åœ¨æ¦‚ç‡å¯†åº¦æœ€é«˜çš„$1/3$é‚»åŸŸå†…è¿›è¡Œé‡‡æ ·ï¼Œå½“ç»´åº¦ä¸º$n$æ—¶ï¼Œç§¯åˆ†åŒºåŸŸçš„ä½“ç§¯ä¸º$(1/3)^n$ï¼Œå½“$n$å¾ˆå¤§æ—¶è¶‹è¿‘äº$0$ï¼Œå› æ­¤å¯¹ç§¯åˆ†çš„è´¡çŒ®å¾ˆå°ã€‚è€Œæ¦‚ç‡å¯†åº¦è¾ƒå°çš„åœ°æ–¹ç”±äºæ¦‚ç‡å¯†åº¦è¶‹è¿‘äº$0$ï¼Œå¯¹ç§¯åˆ†çš„è´¡çŒ®ä¹Ÿä¸å¤§ã€‚æˆ‘ä»¬ç€é‡å…³æ³¨çš„åº”è¯¥æ˜¯ä»‹äºä¸¤è€…ä¹‹é—´çš„åŒºåŸŸï¼Œå…¶å¯¹ç§¯åˆ†çš„è´¡çŒ®è¾ƒå¤§ï¼Œæˆä¸ºå…¸å‹é›†(typical set)ã€‚æˆ‘ä»¬ç ”ç©¶çš„é‡ç‚¹åœ¨äºå¦‚ä½•åœ¨**å…¸å‹é›†ä¸Šé‡‡æ ·**ã€‚\n\n### é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡æ´›æ–¹æ³•\n\n#### ç†æƒ³çŠ¶æ€\n\nåˆ©ç”¨é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡æ´›(MCMC)æ–¹æ³•å¯ä»¥åœ¨å…¸å‹é›†ä¸Šè¿›è¡Œé‡‡æ ·ã€‚åœ¨ç†æƒ³çŠ¶æ€ä¸‹ï¼ŒMCMCçš„é‡‡æ ·è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š\n\n1. ä»åˆå§‹ä½ç½®åˆ°å…¸å‹é›†ï¼Œæ­¤æ—¶åå·®(bias)è¾ƒå¤§ã€‚\n2. è¿›å…¥å…¸å‹é›†åï¼Œåœ¨å…¸å‹é›†ä¸Šè¿›è¡Œæ¢ç´¢ï¼Œå‡†ç¡®åº¦è¿…é€Ÿä¸Šå‡ã€‚\n3. ç»§ç»­åœ¨å…¸å‹é›†ä¸Šè¿›è¡Œæ¢ç´¢ï¼Œå‡†ç¡®åº¦ä¸Šå‡ç¼“æ…¢ã€‚\n\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![](http://static01.imgkr.com/temp/1a1df50a72d54d1998ae2b266f3e3aed.jpg)\n\n> å›¾(a)è¡¨ç¤ºé˜¶æ®µ1ï¼Œå›¾(b)è¡¨ç¤ºé˜¶æ®µ2ï¼Œå›¾(c)è¡¨ç¤ºé˜¶æ®µ3ã€‚\n\nå½“è¾¾åˆ°é˜¶æ®µ3æ—¶ï¼Œä¼°è®¡çš„ç»“æœç¬¦åˆå¤§æ•°å®šå¾‹ï¼š\n$$\n\\hat{f}^{\\text{MCMC}}_N\\sim \\mathcal{N}(\\mathbb{E}_{\\pi}[f],\\text{MCMC-SE})\n$$\nå…¶ä¸­è’™ç‰¹å¡æ´›è¯¯å·®ä¸ºï¼š\n$$\n\\text{MCMC-SE}\\equiv \\sqrt{\\frac{\\text{Var}_{\\pi}[f]}{\\text{ESS}}}\n$$\nå…¶ä¸­ESSä¸ºæœ‰æ•ˆæ ·æœ¬é‡ï¼Œå®šä¹‰ä¸ºï¼š\n$$\n\\text{ESS} = \\frac{N}{1+2\\sum_{l=1}^\\infty \\rho_l}\n$$\nå…¶ä¸­$\\rho_l$ä¸ºä¹‹å$l$çš„è‡ªç›¸å…³ç³»æ•°ã€‚\n\n#### ç—…æ€æƒ…å†µ\n\nå½“å…¸å‹é›†å†…å­˜åœ¨é«˜æ›²ç‡åŒºåŸŸæ—¶ï¼Œä¼šå¯¼è‡´æ­¤åŒºåŸŸæ— æ³•è¢«æ¢ç´¢ï¼Œé€ æˆåå·®ã€‚\n\n![](http://static01.imgkr.com/temp/ef84320549ab469690733e68a944729c.jpg)\n\n> ç—…æ€æƒ…å†µï¼šå…¶ä¸­ç»¿è‰²åŒºåŸŸè¡¨ç¤ºé«˜æ›²ç‡åŒºåŸŸã€‚å­˜åœ¨ä¸‰ç§æƒ…å†µï¼š\n>\n> 1. æ— æ³•è·¨è¿‡æ­¤é«˜æ›²ç‡åŒºåŸŸï¼Œä»…åœ¨ä¸€ä¾§è¿›è¡Œé‡‡æ ·ã€‚\n> 2. åœ¨é«˜æ›²ç‡åŒºåŸŸå‘¨å›´éœ‡è¡ã€‚\n> 3. å¯ä»¥è·¨è¿‡é«˜åŒºåŸŸåŒºåŸŸï¼Œåœ¨æ•´ä¸ªå…¸å‹é›†ä¸Šè¿›è¡Œé‡‡æ ·ã€‚\n\n#### Metropolis-Hastingsé‡‡æ ·\n\nä¸€ä¸ªè¾ƒä¸ºç®€å•çš„MCMCæ–¹æ³•ä¸ºM-Hé‡‡æ ·(Metropolis-Hastingsé‡‡æ ·)ï¼Œåœ¨å±€éƒ¨åˆ©ç”¨å»ºè®®åˆ†å¸ƒå¯¹ç›®æ ‡åˆ†å¸ƒè¿›è¡Œè¿‘ä¼¼ï¼Œå…¶åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š\n\n1. åœ¨æè®®åˆ†å¸ƒ$\\mathbb{Q}(q^\\prime\\mid q)$è¿›è¡Œé‡‡æ ·\n2. è®¡ç®—æ¥å—ç‡$$a(q^\\prime\\mid q) = \\min\\left(1,\\frac{\\mathbb{Q}(q\\mid q^\\prime)\\pi(q^\\prime)}{\\mathbb{Q}(q^\\prime\\mid q)\\pi(q)}\\right)$$ï¼Œå¦‚æœ$a$å¤§äºç”Ÿæˆçš„$0\\sim1$ä¹‹é—´çš„éšæœºæ•°ï¼Œæ¥å—æ ·æœ¬$q^\\prime$ï¼Œå¦åˆ™ç»§ç»­æ¥å—æ ·æœ¬$q$ã€‚\nä½†æ˜¯M-Hé‡‡æ ·åœ¨é«˜ç»´æƒ…å†µä¸‹å­˜åœ¨æ¥å—ç‡è¿‡ä½çš„é—®é¢˜ã€‚\n\n### Hamiltonian Monte Carlo\n\næ±‰å¯†å°”é¡¿è’™ç‰¹å¡æ´›(HMC)æ–¹æ³•ï¼šæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¸å‹é›†çš„å½¢çŠ¶çš„ç‰¹å¾æ¥è¿›è¡Œé‡‡æ ·ã€‚æˆ‘ä»¬ä¸å†åœ¨å…¸å‹é›†ä¸Šéšæœºç§»åŠ¨ï¼Œè€Œæ˜¯é€šè¿‡å‘é‡åœºçš„å½¢å¼æ¥æŒ‡ç¤ºç§»åŠ¨çš„æ–¹å‘ï¼Œä½¿å…¶é«˜æ•ˆåœ°åœ¨å…¸å‹é›†ä¸Šç§»åŠ¨ã€‚\n\næˆ‘ä»¬å°†æ¦‚ç‡ç³»ç»Ÿç±»æ¯”äºç‰©ç†ç³»ç»Ÿï¼Œå…¸å‹é›†ç±»ä¼¼äºè¡Œæ˜Ÿç»•åœ°çƒæ—‹è½¬åœ°è½¨é“ã€‚å¯¹äºè¡Œæ˜Ÿï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ åŠ¨é‡æ¥æŠµæ¶ˆé‡åŠ›ä½¿è¡Œæ˜Ÿæ­£å¸¸å›´ç»•åœ°çƒè¿åŠ¨ï¼›ç±»æ¯”äºæ¦‚ç‡ç©ºé—´ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ åŠ¨é‡æ¥æŠµæ¶ˆæ¢¯åº¦ä½¿é©¬å°”å¯å¤«é“¾åœ¨å…¸å‹é›†ä¸Šé‡‡æ ·ã€‚\n\n#### ç›¸ç©ºé—´å’Œæ±‰å¯†å°”é¡¿æ–¹ç¨‹\n\næˆ‘ä»¬éœ€è¦å¼•å…¥åŠ¨é‡å‚æ•°æ¥è¡¥å……ç›®æ ‡å‚æ•°ç©ºé—´çš„æ¯ä¸ªç»´åº¦ï¼š\n$$\nq_n \\rightarrow (q_n,p_n)\n$$\nè¿™æ ·å°†$D$ç»´ç©ºé—´æ‹“å±•ä¸ºäº†$2D$ç»´çš„ç©ºé—´ï¼Œæˆ‘ä»¬å°±å°†ç›®æ ‡å‚æ•°ç©ºé—´æ‹“å±•ä¸ºäº†ç›¸ç©ºé—´ã€‚ç›¸ç©ºé—´ä¸Šçš„è”åˆåˆ†å¸ƒæˆä¸ºå…¸å‹åˆ†å¸ƒ(canonical distribution)ï¼š\n$$\n\\pi(q,p) = \\pi(p\\mid q)\\pi(q)\n$$\nè¿™æ ·æˆ‘ä»¬å¯¹åŠ¨é‡å‚æ•°è¿›è¡Œç§¯åˆ†åå¾ˆå®¹æ˜“å¾—åˆ°æˆ‘ä»¬è¦é‡‡æ ·çš„ç›®æ ‡å‚æ•°ã€‚\n\næˆ‘ä»¬å°†å…¸å‹åˆ†å¸ƒå†™ä¸ºä¸å˜çš„æ±‰å¯†å°”é¡¿å‡½æ•°çš„å½¢å¼ï¼š\n$$\n\\pi(q,p) = \\exp^{-H(q,p)}\n$$\næ‰€ä»¥ï¼š\n$$\n\\begin{aligned}\nH(q,p) &= -\\log\\pi(p\\mid q) - \\log\\pi(q)\\\\\n&\\equiv K(p,q) + V(q)\n\\end{aligned}\n$$\nå…¶ä¸­$K(p,q)$è¢«ç§°ä¸ºåŠ¨èƒ½ï¼Œ$V(q)$è¢«ç§°ä¸ºåŠ¿èƒ½ã€‚\n\næˆ‘ä»¬åˆ©ç”¨æ±‰å¯†å°”é¡¿æ–¹ç¨‹æ¥ç”Ÿæˆå‘é‡åœºï¼š\n$$\n\\begin{aligned}\n\\frac{dq}{dt} &= + \\frac{\\partial H}{\\partial p} = \\frac{\\partial K}{\\partial p}\\\\\n\\frac{dp}{dt} &= -\\frac{\\partial H}{\\partial q} = -\\frac{\\partial K}{\\partial q} - \\frac{\\partial V}{\\partial q}\n\\end{aligned}\n$$\næ‰€ä»¥æ±‰å¯†å°”é¡¿æ–¹ç¨‹æ˜¯ä¸éšæ—¶é—´å‘ç”Ÿæ”¹å˜çš„ï¼Œå› ä¸ºï¼š\n$$\n\\begin{aligned}\n\\frac{dH}{dt} &= \\frac{\\partial H}{\\partial p}\\frac{d p}{dt} + \\frac{\\partial H}{\\partial q}\\frac{d q}{dt}\\\\\n&= -\\frac{\\partial H}{\\partial p}\\frac{\\partial H}{\\partial q} + \\frac{\\partial H}{\\partial q}\\frac{\\partial H}{\\partial p}\\\\\n&=0\n\\end{aligned}\n$$\n\n#### ç†æƒ³æ¡ä»¶ä¸‹çš„æ±‰å¯†å°”é¡¿è½¬ç§»\n\nç†æƒ³æ¡ä»¶ä¸‹çš„HMCå¯ä»¥åˆ†ä¸º3ä¸ªæ­¥éª¤ï¼š\n\n1. ä»åˆå§‹ä½ç½®äº§ç”Ÿåˆå§‹åŠ¨é‡\n2. ä»¥æ­¤ç±»æ¨äº§ç”Ÿè½¨è¿¹\n3. ä»ç›¸ç©ºé—´æŠ•å½±åˆ°å‚æ•°ç©ºé—´\n\n\n\n### é«˜æ•ˆçš„HMC\n\n#### ç›¸ç©ºé—´çš„å‡ ä½•å½¢çŠ¶\n\næ±‰å¯†å°”é¡¿å…¬å¼çš„æ€§è´¨ä½¿æ±‰å¯†å°”é¡¿æ–¹ç¨‹çš„å€¼å§‹ç»ˆä¿æŒä¸å˜ã€‚è¯å¥è¯è¯´ï¼Œæ¯ä¸€ä¸ªæ±‰å¯†å°”é¡¿è½¨è¿¹éƒ½ä½¿ä¸€ä¸ªèƒ½çº§ï¼š\n$$\nH^{-1}(E) = \\{q,p\\mid H(q,p)=E\\}\n$$\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç›¸ç©ºé—´å¯ä»¥è¢«åˆ†è§£ç»´æ±‰å¯†å°”é¡¿èƒ½çº§ã€‚\n\n![](http://static01.imgkr.com/temp/028f6ae9a0074f3cb6047d241f6e3945.jpg)\n\næ‰€ä»¥æˆ‘ä»¬çš„é‡‡æ ·è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼Œä¸€ä¸ªæ˜¯åœ¨ç›¸åŒçš„èƒ½çº§ä¸Šè¿›è¡Œé‡‡æ ·ï¼Œä¸€ä¸ªæ˜¯åœ¨ä¸åŒçš„èƒ½çº§ä¸Šè¿›è¡Œè·ƒè¿ï¼Œå¦‚ä¸‹å›¾ï¼š\n\n![](http://static01.imgkr.com/temp/72b6558918b7415589144699fd37eb61.jpg)\n\n> æ·±çº¢è‰²è¡¨ç¤ºåœ¨ç›¸åŒçš„èƒ½çº§ä¸Šè¿›è¡Œé‡‡æ ·ï¼Œæµ…çº¢è‰²çš„è¡¨ç¤ºåœ¨ä¸åŒèƒ½çº§ä¸Šè¿›è¡Œè·ƒè¿ã€‚\n\n#### å¯¹åŠ¨èƒ½çš„ä¼˜åŒ–\n\næ¬§å‡ é‡Œå¾—-é«˜æ–¯åŠ¨èƒ½ï¼š\n$$\n\\begin{aligned}\n\\Delta(q,q^\\prime) &= (q-q^\\prime)^\\top\\cdot M\\cdot(q-q^\\prime)\\\\\n\\Delta(p,p^\\prime) &= (p-p^\\prime)^\\top\\cdot M^{-1}\\cdot(p-p^\\prime)\n\\end{aligned}\n$$\næˆ‘ä»¬ä¸€èˆ¬å®šä¹‰æ¡ä»¶åˆ†å¸ƒä¸ºï¼š\n$$\n\\pi(p\\mid q) = \\mathcal{N}(p\\mid 0,M)\n$$\n\n\nè¿™ç§ç‰¹æ®Šé€‰æ‹©å®šä¹‰äº†æ¬§å‡ é‡Œå¾—-é«˜æ–¯åŠ¨èƒ½ï¼š\n$$\nK(q,p) = \\frac{1}{2}P^\\top \\cdot M^{-1}\\cdot p + \\frac{1}{2}\\log|M|+\\text{const}\n$$\n\n\né»æ›¼-é«˜æ–¯åŠ¨èƒ½å‡½æ•°ï¼šä¸æ¬§å‡ é‡Œå¾—-é«˜æ–¯åŠ¨èƒ½å‡½æ•°ä¸åŒä¹‹å¤„ä¸ºåæ–¹å·®ä¸ä½ç½®æœ‰å…³ï¼š\n$$\n\\pi(p\\mid q) = \\mathcal{N}(p\\mid 0,\\Sigma(q))\n$$\nå®šä¹‰äº†é»æ›¼-é«˜æ–¯åŠ¨èƒ½ï¼š\n$$\nK(q,p) = \\frac{1}{2}p^\\top\\cdot\\Sigma^{-1}(q)\\cdot p+\\frac{1}{2}\\log|\\Sigma(q)| + \\text{const}\n$$\n\n\n#### å¯¹ç§¯åˆ†æ—¶é—´çš„ä¼˜åŒ–\n\nè¿™é‡Œçš„ç§¯åˆ†æ—¶é—´æŒ‡çš„æ˜¯åœ¨æŸä¸ªç‰¹å®šèƒ½çº§ä¸Šçš„æ¢ç´¢æ—¶é—´(æ­¥æ•°)ã€‚éšç€ç§¯åˆ†æ—¶é—´çš„å¢åŠ ï¼Œæ—¶é—´æœŸæœ›ä¼šæ”¶æ•›åˆ°ç©ºé—´æœŸæœ›ã€‚\n\n![](http://static01.imgkr.com/temp/cca5d76d452f47f695f3a308dfe6602f.jpg)\n\n> å›¾(a)ï¼šæ—¶é—´æœŸæœ›ä¸ç©ºé—´æœŸæœ›çš„å·®å€¼çš„ç»å¯¹å€¼éšç€ç§¯åˆ†æ—¶é—´çš„å˜åŒ–ï¼Œå¯ä»¥çœ‹åˆ°åˆ°ç§¯åˆ†æ—¶é—´åˆ°è¾¾ä¸€å®šçš„ç¨‹åº¦åï¼Œå¢åŠ ç§¯åˆ†æ—¶é—´å¯¹ç»“æœäº§ç”Ÿçš„å½±å“å¹¶ä¸å¤§ï¼›å›¾(b)ï¼šæœ‰æ•ˆæ ·æœ¬æ•°éšç€ç§¯åˆ†æ—¶é—´çš„å˜åŒ–ï¼Œä¸å›¾(a)å˜åŒ–ç±»ä¼¼ï¼›å›¾(c)ï¼šæœ‰æ•ˆæ ·æœ¬æ•°/ç§¯åˆ†æ—¶é—´éšç€ç§¯åˆ†æ—¶é—´çš„å˜åŒ–ï¼Œå…ˆå¢åŠ åå‡å°ï¼Œå­˜åœ¨æœ€å¤§å€¼ã€‚\n\nå½“ç›®æ ‡æ¦‚ç‡å¯†åº¦ä¸ºï¼š\n$$\n\\pi_\\beta(q)\\propto \\exp(-|q|^\\beta)\n$$\nåŠ¨èƒ½å‡½æ•°ä¸ºæ¬§å‡ é‡Œå¾—åŠ¨èƒ½ï¼š\n$$\n\\pi(p\\mid q) = \\mathcal{N}(0,1)\n$$\næœ€ä¼˜ç§¯åˆ†æ—¶é—´ä¸åŒ…å«è½¨è¿¹çš„èƒ½çº§çš„èƒ½é‡æˆæ¯”ä¾‹ï¼š\n$$\nT_{\\text{optimal}}(q,p)\\propto (H(q,p))^{\\frac{2-\\beta}{2\\beta}}\n$$\n\n### åœ¨å®è·µä¸­å®ç°HMC\n\nç”±äºåœ¨ç»å¤§æ•°æƒ…å†µä¸‹æˆ‘ä»¬ä¸èƒ½å‡†ç¡®åœ°æ±‚è§£å“ˆå¯†é¡¿æ–¹ç¨‹ï¼Œå¿…é¡»é‡‡ç”¨æ•°å€¼æ±‚è§£çš„æ–¹æ³•ï¼Œä½†æ˜¯æ•°å€¼æ±‚è§£çš„è¿‡ç¨‹ä¼šç´¯ç§¯è¯¯å·®ï¼Œå¯¹æˆ‘ä»¬çš„ç»“æœäº§ç”Ÿå½±å“ã€‚\n\n#### Symplectic Integrators\n\nSymplectic Integrators(è¾›ç§¯åˆ†å™¨)æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç§¯åˆ†å™¨ï¼Œå®ƒäº§ç”Ÿçš„æ•°å€¼è½¨è¿¹ä¸ä¼šåç¦»ç²¾ç¡®çš„èƒ½çº§ï¼Œè€Œæ˜¯åœ¨å…¶é™„è¿‘éœ‡è¡ï¼Œå³ä½¿åœ¨å¾ˆé•¿çš„ç§¯åˆ†æ—¶é—´å†…ä¹Ÿæ˜¯å¦‚æ­¤ã€‚\n$$\n\\begin{aligned}\n&q_{0} \\leftarrow q, p_{0} \\leftarrow p \\\\\n&\\text {for } 0 \\leq n<\\llcorner T / \\epsilon\\lrcorner \\text { do } \\\\\n&\\quad p_{n+\\frac{1}{2}}  \\leftarrow p_{n}-\\frac{\\epsilon}{2} \\frac{\\partial V}{\\partial q}\\left(q_{n}\\right) \\\\\n&\\quad q_{n+1}  \\leftarrow q_{n}+\\epsilon p_{n+\\frac{1}{2}} \\\\\n&\\quad p_{n+1} \\leftarrow p_{n+\\frac{1}{2}}-\\frac{\\epsilon}{2} \\frac{\\partial V}{\\partial q}\\left(q_{n+1}\\right)\\\\\n&\\text {end for. }\n\\end{aligned}\n$$\n\n#### çº æ­£è¾›ç§¯åˆ†å™¨\n\næˆ‘ä»¬åœ¨æ¯ä¸ªèƒ½çº§ä¸Šè¿è¡Œ$L$æ­¥ï¼Œå–æœ€åä¸€ä¸ªæ ·æœ¬$(q_L,p_L)$ï¼Œä¹‹åè¿›è¡Œèƒ½çº§è·ƒè¿ã€‚å› ä¸ºæˆ‘ä»¬æ˜¯ä½¿ç”¨æ•°å€¼çš„æ–¹æ³•ï¼Œå› æ­¤åœ¨åŒä¸€ä¸ªèƒ½çº§ä¸Šé‡‡æ ·ä¸Šå¯èƒ½ä¸èƒ½ä¿æŒèƒ½é‡ä¸å˜ã€‚å› æ­¤æˆ‘ä»¬å€Ÿç”¨M-Hé‡‡æ ·çš„æ€æƒ³æ¥å¯¹æ ·æœ¬è¿›è¡Œè¿›è¡Œæ¥å—-æ‹’ç»ï¼Œå› ä¸ºåœ¨åŒä¸€ä¸ªèƒ½çº§ä¸Šé‡‡æ ·å½“ç¡®å®šåˆå§‹ç‚¹æ—¶é‡‡åˆ°çš„æ ·æœ¬æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ï¼š\n$$\n\\mathbb{Q}(q_0,p_0\\mid q_L,p_L) = \\mathbb{Q}(q_L,p_L\\mid q_0,p_0)=1\n$$\nå…¶æ¥å—æ¦‚ç‡ä¸ºï¼š\n$$\n\\begin{aligned}\na\\left(q_{L},p_{L} \\mid q_{0}, p_{0}\\right) &=\\min \\left(1, \\frac{\\mathbb{Q}\\left(q_{0}, p_{0} \\mid q_{L},p_{L}\\right) \\pi\\left(q_{L},p_{L}\\right)}{\\mathbb{Q}\\left(q_{L},p_{L} \\mid q_{0}, p_{0}\\right) \\pi\\left(q_{0}, p_{0}\\right)}\\right) \\\\\n\n&=\\min \\left(1, \\frac{\\pi\\left(q_{L},p_{L}\\right)}{\\pi\\left(q_{0}, p_{0}\\right)}\\right) \\\\\n&=\\min \\left(1, \\frac{\\exp \\left(-H\\left(q_{L},p_{L}\\right)\\right)}{\\exp \\left(-H\\left(q_{0}, p_{0}\\right)\\right)}\\right) \\\\\n&=\\min \\left(1, \\exp \\left(-H\\left(q_{L},p_{L}\\right)+H\\left(q_{0}, p_{0}\\right)\\right)\\right)\n\\end{aligned}\n$$\n\n\n\n\n","tags":["ç®—æ³•"],"categories":["æ–‡çŒ®é˜…è¯»"]},{"title":"åªäº‰æœå¤•ï¼Œä¸è´ŸéŸ¶å","url":"/2021/07/13/index/","content":"\n<h1 align=\"center\">\n    å‡¡æ˜¯è¿‡å¾€çš†ä¸ºåºç« ï¼Œæ‰€æœ‰å°†æ¥çš†å¯ç›¼ã€‚\n</h1>\n<p align=\"center\">\n    <img src=\"https://raw.githubusercontent.com/HFC666/image/master/img/head.jpg\" style=\"zoom: 100%;\" />\n</p>\n\n\n\n\n\n\n"}]